STK.register("historyM",function(d){if(typeof $CONFIG=="undefined"||$CONFIG.bigpipe!="true"){return}var g=d.core.util.browser,p=d.core.util.hideContainer;var o,r=true,a=!!history.pushState,c=("onhashchange" in window)&&((typeof document.documentMode==="undefined")||document.documentMode==8);var k,m,s;if(!c&&(g.IE6||g.IE7)){(k=d.C("iframe")).style.display="none";p.appendChild(k);k=k.contentWindow;m=function(u){u=encodeURIComponent(u);k.document.open("text/html");k.document.write("<html><head></head><body onload=\"parent.STK&&parent.STK.historyM&&parent.STK.historyM.hashFrameChangeHash&&parent.STK.historyM.hashFrameChangeHash('"+u+"');\"></body></html>");k.document.close()};s=function(u){u=decodeURIComponent(u);if(!s.first){s.first=1;return}window.location.hash=u;if(u!="#!"+o){h(o=u.substr(2),true)}}}var h=function(u,v){m&&(!v)&&m("#!"+u);d.custEvent.fire(e,"popstate",[u,r]);r=true};var t=function(){return decodeURIComponent(window.location.toString())};var j=function(v){var u=d.parseURL(v||t());return{host:u.host,path:"/"+u.path,query:u.query&&("?"+u.query),hash:u.hash&&("#"+u.hash)}};var i=function(){var u=d.parseURL(t());if(/^!/.test(u.hash)){return d.parseURL("http://"+u.host+u.hash.substr(1))}return u};var l=function(u,w){if(!/^\//.test(u)){d.log("地址:("+u+") 不为正确的路径,请使用绝对路径; 例：/directory/page.php?params#hash");return}w=d.parseParam({callChange:true,callChangeOnSame:true},w);r=w.callChange;if(a){u=u.replace(/#.*$/,"");if(o==u){if(!w.callChangeOnSame){return}}else{history.pushState(null,null,o=u)}h(u);return}var v="#!"+u;u=u.replace(/#.*$/,"");if(o==u){if(w.callChangeOnSame){h(u)}}else{window.location.hash=v}};var n=function(y,v){if(!y){return}v=v||false;var u=i();var x=d.queryToJson(u.query);for(var w in y){if(y[w]===null){delete x[w]}else{x[w]=y[w]}}u.query=d.jsonToQuery(x);result=["/",u.path,(u.query=="")?"":"?",u.query,(u.hash=="")?"":"#",u.hash].join("");l(result,{callChange:v})};var q=function(u,x){if(typeof u=="string"&&!/^!/.test(u)){var y=d.parseURL(window.location.toString()).hash,w,v=window.location.toString().replace(/#.*$/,"");if(/^!/.test(y)){y=y.replace(/#.*$/,"");w="#"+y+"#"+u}else{w="#"+u}if(x){window.location.hash=w}else{window.location.replace(v+w)}}return e};var b=function(u){d.custEvent.add(e,"popstate",function(x,v,w){u(v,w)});return e};o=t().replace(/^http:\/\/.*?\//,"/").replace(/#.*$/,"");if(a){d.addEvent(window,"popstate",function(){setTimeout(function(){var u=j(),v=u.path+u.query;if(o!=v){h(o=v)}})})}else{var f=function(){var v,u=j();if(/^#!/.test(u.hash)){v=u.hash.substr(2).replace(/#.*$/,"")}else{v=u.path+u.query}if(o!=v){h(o=v)}};if(c){d.addEvent(window,"hashchange",function(){f()})}else{setInterval(function(){f()},200)}}m&&m("#!"+o);var e={parseURL:i,getURL:j,pushState:l,setQuery:n,setPlainHash:q,onpopstate:b,hashFrameChangeHash:s};d.custEvent.define(e,"popstate");return e});STK.register("bigpipeM",function(e){var i;if(typeof $CONFIG=="undefined"||$CONFIG.bigpipe!="true"){return}var j=e.core.util.browser.OS=="macintosh",k=/img|span/,f,h,c;if(typeof $CONFIG!="undefined"){c=$CONFIG.bpType}var b=function(){b.timer=setTimeout(function(){e.core.util.hideContainer.removeChild(h);document.body.style.cursor="";if(f){f.style.cursor=""}b.timer=h=null;e.custEvent.fire(i,"pipeLoadEnd",h&&h.src)})};var g=function(l){l=l.replace(/#.*$/,"");if(l.indexOf("?")!=-1){l=l+"&ajaxpagelet=1"}else{l=l+"?ajaxpagelet=1"}l+="&_t="+new Date().getTime();if(h){b.timer&&clearTimeout(b.timer);e.removeEvent(h,"load",b);e.core.util.hideContainer.removeChild(h);e.custEvent.fire(i,"pipeLoadAbort",h.src)}h=e.C("iframe");h.src=l;h.style.display="none";e.core.util.hideContainer.appendChild(h);document.body.style.cursor="progress";f&&(f.style.cursor="progress");e.addEvent(h,"load",b);e.custEvent.fire(i,"pipeLoadStart",l)};var d=function(){e.core.evt.addEvent(document,"click",function(q){q=e.fixEvent(q);var r=q.target,n=r.tagName.toLowerCase(),l=(n=="a");if(!l&&k.test(n)){for(var p=0;p<2;p++){if(!(r=r.parentNode)){return}if((n=r.tagName.toLowerCase())=="a"){l=true;break}}}if(l){if(r.getAttribute("bpfilter")&&r.getAttribute("bpfilter")==c&&!q.ctrlKey&&!q.shiftKey&&q.button==0&&!(j&&q.metaKey)){e.log("bigpipeM: 点击行为拦截成功，使用Bigpipe模式加载");var m=r.href;var o=e.historyM.getURL();var s=e.historyM.getURL(m);if(s.host!=o.host){return}f&&(f.style.cursor="");f=r;e.historyM.pushState(s.path+s.query+s.hash)}else{if(!/^#/.test(r.href)){return}}e.preventDefault(q)}})};var a=function(n,l,m){if(m){e.pageletM.clear();e.scrollTo(document.body,{step:10});g(l)}};e.custEvent.add(e.historyM,"popstate",a);d();i={ajaxpipeLoader:g,destroy:function(){e.custEvent.remove(e.historyM,"popstate",a)}};e.custEvent.define(i,["pipeLoadStart","pipeLoadAbort","pipeLoadEnd"]);return i});STK.register("pageletView",function(E){var K={},g=false;var T="http://js.t.sinajs.cn/t4/",P="http://img.t.sinajs.cn/t4/",I,f,k;if(typeof $CONFIG!="undefined"){T=$CONFIG.jsPath||T;P=$CONFIG.cssPath||P;I=$CONFIG.mJsPath;f=$CONFIG.mCssPath;I.MODN=I[2]-I[1]+2;f.MODN=f[2]-f[1]+2}var l={},m=function(ad,Z){Z=Z.replace(/\?.*$/,"");var aa=0,w=0,ab,ac;while(ab=Z.charCodeAt(aa++)){w+=ab}return ad[0].replace("{n}",(w%I.MODN)||"")},x=function(w){return I?(l[w]||(l[w]=m(I,w))):T},d=function(w){return P};var V=E.core.arr.indexOf;var b={},t={},G={};var v=0;E.historyM.onpopstate(function(){v++});var O=function(w){return new RegExp("^.*?\\/("+w+"\\/.*?)(_[a-z\\d]{16})?\\.js\\??.*$")};var e,A;if(E.IE){e={};A=function(){var Z,aa,w;for(Z in e){if(e[Z].length<31){w=E.E(Z);break}}if(!w){Z="style_"+E.core.util.getUniqueKey();w=document.createElement("style");w.setAttribute("type","text/css");w.setAttribute("id",Z);document.getElementsByTagName("head")[0].appendChild(w);e[Z]=[]}return{styleID:Z,styleSheet:w.styleSheet||w.sheet}}}var i=function(ac,aa,ab){t[ac]={cssURL:ab};if(E.IE){var Z=A();Z.styleSheet.addImport(aa);e[Z.styleID].push(ac);t[ac].styleID=Z.styleID}else{var w=E.C("link");w.setAttribute("rel","Stylesheet");w.setAttribute("type","text/css");w.setAttribute("charset","utf-8");w.setAttribute("href",aa);w.setAttribute("id",ac);document.getElementsByTagName("head")[0].appendChild(w)}};var R={};var c=function(w,Z){var aa=E.E(w);if(aa){R[w]&&delete R[w];Z(aa)}else{R[w]=Z}};var C=function(){for(var w in R){c(w,R[w])}};var D=function(ac){if(E.IE){var Z=t[ac].styleID,aa;var ab=e[Z];var w=E.E(Z);if((aa=V(ac,ab))>-1){(w.styleSheet||w.sheet).removeImport(aa);ab.splice(aa,1)}}else{E.core.dom.removeNode(E.E(ac))}delete b[t[ac].cssURL];delete t[ac]};var Q=function(Z,ac,ab){for(var aa in G){if(!E.E(aa)){delete G[aa]}}G[Z]={js:{},css:{}};if(ab){for(var aa=0,w=ab.length;aa<w;++aa){G[Z].css[ab[aa]]=1}}};var r=function(){for(var ab in t){var Z=false,aa=t[ab].cssURL;for(var w in G){if(G[w].css[aa]){Z=true;break}}if(!Z){D(ab)}}j()};var u=function(aa,Z){if(h(aa)){Z(aa);return false}var w=b[aa]||(b[aa]={loaded:false,list:[]});if(w.loaded){Z(aa);return false}w.list.push(Z);if(w.list.length>1){return false}return true};var S=function(Z){var w;if(b[Z]&&(w=b[Z].list)){for(var aa=0;aa<w.length;aa++){w[aa](Z)}b[Z].loaded=true;delete b[Z].list}};var s=function(ah){var ab=ah.url,af=ah.load_ID,ad=ah.complete,ae=ah.pid,Z=ab,w="css_"+E.core.util.getUniqueKey();if(!u(ab,ad)){return}if(!/^http\:\/\//.test(ab.toLowerCase())){Z=d(ab)+ab}i(w,Z,ab);var aa=E.C("div");aa.id=af;E.core.util.hideContainer.appendChild(aa);var ag=3000;var ac=function(){if(parseInt(E.core.dom.getStyle(aa,"height"))==42){E.core.util.hideContainer.removeChild(aa);S(ab);return}if(--ag>0){setTimeout(ac,10)}else{E.log(ab+"timeout!");E.core.util.hideContainer.removeChild(aa);S(ab);D(w);i(w,Z,ab)}};setTimeout(ac,50)};var z=function(aa,Z){if(!u(aa,Z)){return}var w=aa;if(!/^http\:\/\//.test(aa.toLowerCase())){w=x(aa)+aa}E.core.io.scriptLoader({url:w,onComplete:function(){S(aa)},onTimeout:function(){E.log(aa+"timeout!");delete b[aa]}})};var Y,q=[];K.onload=function(w){if(Y){w()}else{q.push(w)}};E.addEvent(window,"load",function(){E.core.evt.removeEvent(window,"load",arguments.callee);Y=true;for(var w=0;w<q.length;++w){q[w]()}q=undefined});var N=window,o=N.requestAnimationFrame||N.webkitRequestAnimationFrame||N.mozRequestAnimationFrame||N.oRequestAnimationFrame||N.msRequestAnimationFrame,L=function(w){return setTimeout(w,2)};if(o){o(function(){L=o})}var H=(function(){var Z=[],w;var aa=function(){if(Z.length>0){w=true;Z.shift()();L(aa)}else{w=false}};return function(ab){if(v){ab()}else{Z.push(ab);if(!w){aa()}}}})();var F=false;K.originalPagePlRendReady=function(){return F};var X=0,y=0,W=false,M=false;var n=function(){X=y=0;clearTimeout(B);W=false;M=true};var B;var U=function(){clearTimeout(B);if(g&&!M&&!W){if(X===y&&X){B=setTimeout(function(){if(!W){B=undefined;F=true;W=true;E.custEvent.fire(K,"allPlRendReady")}},300)}else{B=setTimeout(U,100)}}};E.custEvent.add(E.bigpipeM,"pipeLoadStart",n);E.custEvent.add(E.bigpipeM,"pipeLoadEnd",function(){L(function(){M=false;U()})});var a=function(w){var Z=1,aj,ag,af,ad,aa,ah,al,ac,ab;ag=w.pid;af=w.html;aa=w.js?[].concat(w.js):[];ad=w.css?[].concat(w.css):[];Q(ag,aa,ad);var ai=function(){ac();v&&r();C();U()};ah=function(){y++;c(ag,function(am){if(af!=undefined){H(function(){am.innerHTML=af;L(ai)})}else{ai()}})};al=function(){if(--Z>0){return}if(typeof ab!="undefined"){clearTimeout(ab);ah()}};ac=function(an){if(aa.length>0){z(aa.shift(),ac)}var ao,am;if(an&&((am=an.match(O("pl")))||(am=an.match(O("trustPagelet"))))){ao=am[1].replace(/\//g,".");E.pageletM.clear(ao);E.pageletM.start(ao)}};if(ad.length>0){Z+=ad.length;for(var ae=0,ak;(ak=ad[ae]);ae++){s({url:ak,load_ID:"js_"+ak.replace(/^\/?(.*)\.css\??.*$/i,"$1").replace(/\//g,"_"),complete:al,pid:ag})}}ab=setTimeout(function(){ab=undefined;ah()},5000);al()};var J={};var h=function(w){for(var Z in J){if(J[Z]["includes"][w]){return true}}};var p=function(){var Z=document.getElementsByTagName("link"),ad,ac;for(var ab=0;ab<Z.length;++ab){if(ad=Z[ab].getAttribute("includes")){ac=E.core.dom.uniqueID(Z[ab]);ad=ad.split("|");var w={};for(var aa=0;aa<ad.length;++aa){w[ad[aa]]=1}J[ac]={element:Z[ab],includes:w}}}};var j=function(){var ad={},aa,ac;for(var Z in J){aa=J[Z]["includes"];for(var ab in aa){ac=false;for(var w in G){if(G[w].css[ab]){ac=true;break}}if(ac){ad[Z]=true;break}}}for(var Z in J){if(!ad[Z]){E.core.dom.removeNode(J[Z]["element"]);delete J[Z]}}};p();E.pageletM.view=function(w){if(!w||!w.pid){E.log("pagelet view pid is undefined");return}if(X++==0){a(w);return}L(function(){a(w)})};E.custEvent.define(K,["allPlRendReady"]);E.core.dom.ready(function(){E.addEvent(window,"unload",function(){E.removeEvent(window,"unload",arguments.callee);b=t=G=e=A=R=J=undefined});L(function(){g=true})});return K});STK.register("kit.extra.require",function(f){var c=window.$CONFIG||{};var g="loaded",o="waiting",q="loading";var a={},h={},p=[],m=[],j=false;var k={maxLine:4,maxRetryTimes:1,baseURL:c.jsPath,projectName:"enterprise",version:c.version,timeout:30000,urlRule:null};var n=function(v){var w={},y;for(var x=v.length;x--;){y=v[x];if(w[y]){return false}w[y]=1}return true};var e=function(v){var w=/^http[s]?:\/\//ig;return w.test(v)};var d=function(w){var v=f.core.arr.indexOf(w,m);if(v!==-1){return m.splice(v,1)}return false};var t=function(v){if(typeof k.urlRule==="function"){return k.urlRule(k.baseURL,v,k.version)}else{v=v.replace(/\./ig,"/");return k.baseURL+k.projectName+"/js/"+v+".js?version="+k.version}};var l=function(v){m.push(v);h[v].state=q;var w=function(){var C=h[v].depeKeys,B,A,y;d(v);h[v].state=g;j&&r();for(var z=C.length;z--;){A=C[z];B=a[A];B.unReadyNum-=1;if(B.unReadyNum){return}while(a[A].bindFuns.length){y=B.bindFuns.shift();y.func.apply({},[].concat(y.data))}}};var x=function(){var y=h[v],D,C,B,A;d(v);y.state=o;if(y.retry<k.maxRetryTimes){y.retry+=1;return l(v)}j&&r();C=y.depeKeys;for(var z=C.length;z--;){B=C[z];D=a[B];while(D.timeoutFuns.length){A=D.timeoutFuns.shift();A.call({},B)}}};f.core.io.scriptLoader({url:e(v)?v:t(v),timeout:k.timeout,onComplete:w,onTimeout:x})};var i=function(w,y,z,v){var A=a[w];if(!A){f.log("[STK.kit.extra.require]: The depend "+w+" is undefined!")}if(!A.unReadyNum){f.log("依赖关系已加载完成："+w);return y.apply({},[].concat(z))}A.bindFuns.push({func:y,data:z});if(v&&typeof v.onTimeout==="function"){A.timeoutFuns.push(v.onTimeout)}for(var x=A.urlList.length;x--;){aUrl=A.urlList[x];if(h[aUrl].state===o){h[aUrl].retry=0;l(aUrl)}}};var b=function(x,v,w){if(a[x]!==undefined){f.log("[STK.kit.extra.require]: "+x+" has been registered!")}if(!n(v)){f.log("[STK.kit.extra.require]: The depend URLs is not unique! The depes is ["+v+"]")}var z,A=0;w=f.parseParam({activeLoad:false},w||{});for(var y=v.length;y--;){z=v[y];if(!h[z]){h[z]={depeKeys:[x],state:o,retry:0};w.activeLoad&&p.push(z)}else{h[z].depeKeys.push(x);if(h[z].state===g){A+=1}}}a[x]={urlList:v,bindFuns:[],timeoutFuns:[],unReadyNum:v.length-A};return a[x]};var r=function(){if(!p.length){j=false;return}j=true;var w=k.maxLine-1-m.length,v;while(w>0&&p.length){v=p.shift();if(h[v].state===o){l(v);w-=1}}};var s=function(v){k=f.core.json.merge(k,v)};var u=function(w,x,v){if(typeof x!=="function"){throw'[STK.kit.extra.require]: The "func" musts be a Function!'}return function(y){i(w,x,[].slice.call(arguments),v)}};i.bind=u;i.config=s;i.register=b;i.activeLoad=r;return i});STK.register("comp.content.pageSuda",function(a){return function(){var d=document,c=d.createElement("script"),b=d.getElementsByTagName("script")[0];c.type="text/javascript";c.charset="utf-8";c.async=true;c.src="http://js.t.sinajs.cn/open/analytics/js/suda.js?version=185c218ab61a6a7f";b.parentNode.insertBefore(c,b)}});