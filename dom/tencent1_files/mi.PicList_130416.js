/*revision:102481*/
(function(){MI.PicList=function(a,b){var c=this,e,d;if(UI.isString(a))e=UI.G(a);else{e=a;d=UI.A(a,"id");if(!d){d="piclist"+UI.random(1E4);UI.A(a,"id",d)}a=d}if(!e)throw Error("No container found for PicList: "+a);if(MI.PicList.instanceIds[a])throw Error("PicList: "+a+" has already been initialized.");MI.PicList.instanceIds[a]=true;this.config=this._preprocCfg(b||{});this._lists=(d=this.config.list)?UI.isString(d)?UI.GC(e,d)[0]:d:e;if(!this._lists)throw Error("No lists found for PicList");this.id=
a;this.container=e;this.hasMore=true;this.page=1;this.tmplData={};this.content=this.active=null;this._prepareTip();this._addEvents();this.oriBodyZindex=UI.GC(UI.G("mainWrapper"),".main")[0].style.zIndex;this.config.hasTools=b&&typeof b.hasTools!=="undefined"?b.hasTools:true;if(this.config.doMore){if(e=UI.isString(this.config.moreBtn)?UI.G(this.config.moreBtn):this.config.moreBtn){if(this._more=UI.GC(e,"a")[0]){this._more.onmouseover=MI.hideFocus;this._more.onclick=function(g){c.more();UI.E(g).prevent()}}setTimeout(function(){c.cacheLast()},
0);this.config.autoMore&&this.autoMore()}}else this.noMore=true;if(MI.PicList.IE_VER===6)try{document.execCommand("BackgroundImageCache",false,true)}catch(f){}if(!this.config.merge)MI.user.fun.mergePic=0;this.items().length?this.autoRun():this.showEmpty()};MI.PicList.instanceIds={};MI.PicList.IE_VER=UI.B.ie&&parseInt(navigator.userAgent.match(/MSIE (\d+)/)[1],10);MI.PicList.UA=function(){var a=UI.B,b=navigator.userAgent;a=a.chrome?b.match(/Chrome\/\d+/)[0]:a.firefox?b.match(/Firefox\/\d+/)[0]:a.ie?
"MSIE/"+MI.PicList.IE_VER:a.ipad?"iPad/"+b.match(/Version\/(\d+)/)[1]:a.opera?"Opera/"+b.match(/Version\/(\d+)/)[1]:a.safari?"Safari/"+b.match(/Version\/(\d+)/)[1]:b;return encodeURIComponent(a)}();MI.PicList.bind=function(a,b){return function(){a.apply(b,Array.prototype.slice.call(arguments))}};MI.PicList.contains=function(){return document.documentElement.compareDocumentPosition?function(a,b,c){if(!a||!b||!b.tagName)return false;return c&&a===b||!!(b.compareDocumentPosition(a)&16)}:document.documentElement.contains?
function(a,b,c){if(!a||!b||!b.tagName)return false;if(a.nodeType===3){a=a.parentNode;c=true}return c&&a===b||b.contains(a)}:function(){}}();MI.PicList.breakWord=function(a){if(!a||a.nodeType!==1)return false;else if(a.currentStyle&&typeof a.currentStyle.wordBreak==="string"){MI.PicList.breakWord=function(b){b.runtimeStyle.wordBreak="break-all";return true};return MI.PicList.breakWord(a)}else if(document.createTreeWalker){MI.PicList.breakWord=function(b){b=document.createTreeWalker(b,NodeFilter.SHOW_TEXT,
null,false);for(var c,e,d=String.fromCharCode("8203");b.nextNode();){c=b.currentNode;e=c.nodeValue.replace(/^\s\s*|\s*\s$/g,"").split("").join(d);c.nodeValue=e}return true};return MI.PicList.breakWord(a)}else return false};MI.PicList.getWindowXY=function(){var a=window.innerHeight,b=window.innerWidth,c=document.compatMode;if(c||UI.B.ie)if(c==="CSS1Compat"){a=UI.B.opera?a:document.documentElement.clientHeight;b=document.documentElement.clientWidth}else{a=UI.B.opera?a:document.body.clientHeight;b=document.body.clientWidth}return[b,
a]};MI.PicList.getDocumentXY=function(){var a,b,c;if(document.compatMode!=="CSS1Compat"||UI.B.webkit){a=document.body.scrollWidth;b=document.body.scrollHeight}else{a=document.documentElement.scrollWidth;b=document.documentElement.scrollHeight}c=MI.PicList.getWindowXY();return[Math.max(a,c[0]),Math.max(b,c[1])]};MI.PicList.getTpJsFromPhp=function(a){return{1:null,2:1,3:3,4:2,5:2,6:null,7:4}[a]};MI.PicList.adjustAutoLoadIndex=function(a,b){var c=this.autoLoadIndex;if(!(c<=0)){if(a===1)if(b<700)c+=2;
else if(b>=700&&b<1E3)c-=1;else if(b>=1E3&&b<2E3)c-=2;else if(b>=2E3)c=Math.ceil(c/2)-1;else c-=1;else if(a===2)if(b>1E3)c-=1;c=Math.min(c,45);if(c<=0)this.doAutoLoad=false;this.autoLoadIndex=c}};MI.PicList.getImageTweet=function(a){return a.source&&a.source.img&&a.source.img.length?a.source:a.img&&a.img.length?a:0};MI.PicList.getTidFromId=function(a){return(a=a.match(/([0-9]{5,})($|\D)/))&&a[1]||null};MI.PicList.addImgProperty=function(a){var b=function(c){if((!c.img||!c.img.length)&&c.image&&c.image.length){c.img=
[];c.imageInfo=c.imageInfo||[];UI.each(c.image,function(e,d){c.img[d]=c.imageInfo[d]||{};c.img[d].url=e})}};UI.each(a,function(c){b(c);c.source&&b(c.source)})};MI.PicList.copyMultiPic=function(a){var b=[],c=function(e){var d,f;if(e===null||typeof e!=="object")return e;d=new e.constructor;for(f in e)if(e.hasOwnProperty(f))d[f]=c(e[f]);return d};UI.each(a,function(e){var d=e.img,f=false;if(e.source&&e.source.img&&e.source.img.length){d=e.source.img;f=true}d&&d.length>1?UI.each(d,function(g,h){var i=
c(e),j;g._id=String(h);j=f?i.source:i;j.img=[g];j.imageInfo=j.img;j.image=[g.url];b.push(i)}):b.push(c(e))});return b};MI.PicList.genRelayList=function(a){a=a||"";var b="_relayList"+a,c="_relayListLoad"+a,e="_relayListCont"+a;a="_relayListPic"+a;var d;this[b]=UI.html('<div class="imgModWhite"><div class="relayList"><div style="height:5px;line-height:5px;font-size:0;"></div><div class="loading">'+_("正在加载")+'...</div><div class="cont"></div></div><div class="moreImgs"></div></div>')[0];this[c]=UI.GC(this[b],
".loading")[0];this[e]=UI.GC(this[b],".cont")[0];this[a]=UI.GC(this[b],".moreImgs")[0];d=this[e];if(UI.B.ie){d.onmousedown=function(){d.onselectstart=null};d.onmouseup=function(){d.onselectstart=function(){return false}}}};MI.PicList.hideRelayList=function(a){if((a=this["_relayList"+a]||this._relayList)&&a.display){UI.remove(a);a.display=0}};MI.PicList.CLICK_REG=/clk-([a-z0-9\-]+)(?:\s+|$)/;MI.PicList.MO_REG=/clk-mo-([a-z0-9]+)(?:\s+|$)/;MI.PicList.MAX_UNEXPD_HEIGHT=350;MI.PicList.MIN_WIDTH=420;MI.PicList.MAX_WIDTH=
460;MI.PicList.MODAL_WIDTH=800;MI.PicList.PAGE_WIDTH=MI.PicList.getDocumentXY()[0];MI.PicList.ARROW_SIZE=49;MI.PicList.doAutoLoad=true;MI.PicList.autoLoadIndex=8;MI.PicList.prototype._mapClick={1:function(a){a=a.parentNode.id;var b=this.config;MI.Bos("btnPicListClk1");if(!b.onclick)return true;this.activeDlg!==a&&b.onclick&&b.onclick.call(this,a)},2:function(){var a=this.config;if(!a.onclick)return true;if(this.active&&this.activeDlg!==this.active){a.onclick&&a.onclick.call(this,this.active);MI.Bos("btnPicListClk2")}else if(a.pptMode){this.showNextDlg();
MI.Bos("btnPicNextPic")}},3:function(){MI.Bos("btnPicListTopMore");return true},"mo-more":function(a){this._mapMo.more.call(this,a)},report:function(){var a=this._get2IdAHide();MI.report(a[1])},del:function(){this._delPic("show")},delcancel:function(){this._delPic("hide")},deldelete:function(){this._delPic("send")},detail:function(){MI.Bos("btnPicFunDet");this._get2IdAHide();return true},reply:function(){var a,b;b=this._get2IdAHide();a=UI.G(b[0]);a=UI.GC(a,"strong a")[0].innerHTML;this.activeDlg?
this._showTalkBox(false,a):MI.App.reply(b[1],a);MI.Bos("btnPicReply")},relay:function(){var a;if(this.activeDlg)this._showTalkBox(true);else{a=this._get2IdAHide();MI.TalkBox.showBox(a[1],1,{tweetDom:UI.G(a[0]),hasOrigin:true})}MI.Bos("btnPicRelay")},relay2:function(){this._showTalkBox(true);MI.Bos("btnPicRelay")},comment:function(){var a;if(this.activeDlg)this._showTalkBox(false);else{a=this._get2IdAHide();MI.TalkBox.showBox(a[1],4,{tweetDom:UI.G(a[0]),hasOrigin:true})}MI.Bos("btnPicComment")},share:function(){var a=
this._get2IdAHide();MI.app({TalkListShare:function(){MI.TalkList.shareCollection.show(a[1])}});MI.Bos("btnPicShare")},qq:function(){var a=this._get2IdAHide();MI.PicList.shareQQ(a[1]);MI.Bos("btnPicShare")},expd:function(){this.expand();MI.Bos("btnPicListExpd");return true},fav:function(a){this._toggle(UI.hasClass(a,"light")?2:1,{url:MI.url.talkFavor,btnClass:"fav",chName:"收藏"});MI.Bos("btnPicFav")},rc:function(){if(!this.config.pptMode)return true;this.showModalDlg(this.content)},arrl:function(){this.showPrevDlg();
MI.Bos("btnPicPrevArr")},arrr:function(){this.showNextDlg();MI.Bos("btnPicNextArr")},pptcls:function(){this.hideModalDlg()},rotateimg:function(a){var b=UI.GC(a.parentNode.parentNode,".large")[0];MI.TalkList.rotateImg(false,b);this._adjImgCtnHeight(true);a.blur();MI.Bos("btnPicRotateAnti")},rotateimgcke:function(a){var b=UI.GC(a.parentNode.parentNode,".large")[0];MI.TalkList.rotateImg(true,b);this._adjImgCtnHeight(true);a.blur();MI.Bos("btnPicRotateClock")},uptop:function(a){this._toggle(UI.hasClass(a,
"light")?2:1,{url:MI.url.talkUpTop,btnClass:"uptop",chName:"置顶",noticeErr:true})}};MI.PicList.prototype._delPic=function(a){var b,c,e,d=this;if((b=this._modalDlg)&&b._cont&&b._cont.firstChild){b=UI.GC(b._cont.firstChild,".picBox.big")[0];e=false}else{b=this._tipContainer;e=true}c=UI.GC(b,".delChose")[0];if(a==="show")if(c)UI.show(c);else{UI.append(UI.html('<div class="delChose"><span>确定删除这条广播？</span><br><label class="gb_btn gb_btn1"><input type="button" value="确定" class="t clk-deldelete"></label><label class="gb_btn gb_btn5"><input type="button" value="取消" class="t clk-delcancel"></label></div>')[0],
b);c=UI.GC(b,".delChose")[0];c.style.cssText="right:1px;bottom:0px;";if(e){c.style.right="5px";c.style.bottom="25px"}}else if(a==="hide")UI.hide(c);else a==="send"&&this._toggle(0,{url:MI.url.talkDel,callback:function(f,g){UI.remove(UI.G(g.id));if(e){d._hide();UI.hide(c)}else d.hideModalDlg();if(UI.GC("."+d.config.itemClass+"[id]").length<1){location.hash="";location.reload()}}})};MI.PicList.prototype._mapMo={more:function(a){var b=this;clearTimeout(this._hideMoreId);this._showMoreId=setTimeout(function(){b._showMoreOp(a.parentNode)},
150)},morectn:function(){clearTimeout(this._hideMoreId)}};MI.PicList.prototype._mapMout={more:function(a,b,c){clearTimeout(this._showMoreId);MI.PicList.contains(c,a.parentNode)||this._hideMoreOp(a.parentNode)},morectn:function(a,b,c){var e=this;a=a.parentNode;if(!MI.PicList.contains(c,a))this._hideMoreId=setTimeout(function(){clearTimeout(e._showMoreId);e._hideMoreOp(a)},100)}};MI.PicList.prototype._get2IdAHide=function(){var a,b;if(this.activeDlg){a=this.activeDlg;b=MI.PicList.getTidFromId(a);this._hideMoreOp(UI.GC(this._modalDlg._cont,
".mFun")[0])}else{a=this.content;b=this.activeTweet;this._hide()}return[a,b]};MI.PicList.prototype._showMoreOp=function(a){UI.addClass(a,"mFunDis");this._enableExpand(false)};MI.PicList.prototype._hideMoreOp=function(a){a=a||UI.GC(this._tipContainer,".mFun")[0];UI.removeClass(a,"mFunDis");this._enableExpand(true)};MI.PicList.prototype._preprocCfg=function(a){var b={},c=function(e,d){var f;if(typeof d==="number"){f=a[e];b[e]=parseInt(f,10)===f?f:d||0}else if(typeof d==="boolean"){d=!!d;f=!d;b[e]=a[e]===
f?f:d}else b[e]=a[e]||d};c("direction",0);c("arrPos",0);c("headHeight",0);c("searchPage",0);c("fitWidth",120);c("fitHeight",120);c("doMore",true);c("autoMore",true);c("merge",false);c("autoScroll",true);c("isGuest",false);c("pptMode",true);c("showHot",true);c("oldModal",true);c("noTip",false);c("moreBtn","moreList");c("itemClass","imgView");c("idPrefix","");c("autorunId","");c("moreCall");c("list");c("owner",b.isGuest?MI.guest.user:"");c("onclick",b.pptMode?function(e){this.showModalDlg(e)}:null);
return b};MI.PicList.prototype.autoResize=function(a){var b=this;UI.each(a,function(c){var e={};if(c=MI.PicList.getImageTweet(c))e=c.img[0];c._imgInfo=b._calcImgSize({h:e.height,w:e.width},{h:b.config.fitHeight,w:b.config.fitWidth})})};MI.PicList.prototype._calcImgSize=function(a,b){return a.h&&a.w?MI.calcImgInfo(b,a,{max:{w:999,h:2E3}}):{id:160,resizeto:"fitfill,"+b.w+"x"+b.h+";max,999x2000;"}};MI.PicList.prototype._addEvents=function(){var a=document.body,b=this.container;this.events={mo:MI.PicList.bind(this._hlMouseOver,
this),mout:MI.PicList.bind(this._hlMouseOut,this),click:MI.PicList.bind(this._hlClick,this),kd:MI.PicList.bind(this._hlKeyDown,this),sr:MI.PicList.bind(this._hlScrResize,this)};UI.EA(b,"mouseover",this.events.mo);UI.EA(b,"mouseout",this.events.mout);UI.EA(a,"click",this.events.click);UI.EA(document,"keydown",this.events.kd);UI.EA(window,"resize",this.events.sr);UI.B.ie6&&UI.EA(window,"scroll",this.events.sr);MI.Crs.onLoadResize&&UI.each(UI.GC(b,".clk-1 img"),function(c){UI.EA(c,"load",MI.Crs.onLoadResize);
MI.Crs.onLoadResize(c)})};MI.PicList.prototype._addModalEvents=function(){var a=this._modalDlg._cont;this.events.modalMout=MI.PicList.bind(this._hlMdMout,this);UI.EA(a,"mouseover",this.events.mo);UI.EA(a,"mouseout",this.events.modalMout)};MI.PicList.prototype._hlMouseOver=function(a){var b,c,e,d;a=UI.E(a);b=a.target;c=3;for(d=this._mapMo;c-- >0&&b&&b.tagName;){if(b.className)e=(e=b.className.match(MI.PicList.MO_REG))&&e[1];if(e){d[e]&&d[e].apply(this,[b,a]);break}else if(b.className===this.config.itemClass&&
b.id){UI.B.ipad||this._delayShowTip(b.id);break}b=b.parentNode}a.stop()};MI.PicList.prototype._hlMouseOut=function(a){var b,c,e,d,f,g;e=UI.E(a);b=e.target;c=3;a=a.relatedTarget||a.toElement;f=this._mapMout;if(a===this._tipContainer||MI.PicList.contains(a,this._tipContainer))for(;c-- >0&&b&&b.tagName;){if(b.className)g=(g=b.className.match(MI.PicList.MO_REG))&&g[1];if(g){f[g]&&f[g].apply(this,[b,e,a]);break}b=b.parentNode}else{if(b===this._tipContainer||MI.PicList.contains(b,this._tipContainer)){if(!MI.PicList.contains(a,
this._tipContainer)&&!MI.PicList.contains(a,this._lists))d=true}else for(;c-- >0&&b&&b.tagName;){if(b.className===this.config.itemClass&&b.id){if(a!==b&&!MI.PicList.contains(a,b))d=true;break}b=b.parentNode}if(d){UI.hide(UI.GC(this._tipContainer,".delChose")[0]);this._hide()}}};MI.PicList.prototype._hlMdMout=function(a){var b,c,e,d,f,g;e=UI.E(a);b=e.target;c=3;a=a.relatedTarget||a.toElement;d=this._mapMout;g=this._modalDlg._cont;if(a===g||MI.PicList.contains(a,g))for(;c-- >0&&b&&b.tagName;){if(b.className)f=
(f=b.className.match(MI.PicList.MO_REG))&&f[1];if(f){d[f]&&d[f].apply(this,[b,e,a]);break}b=b.parentNode}};MI.PicList.prototype._hlClick=function(a){var b,c,e=3,d,f,g;g=UI.E(a);b=g.target;d=MI.PicList.CLICK_REG;f=this._mapClick;if(this._modalDlg&&b===this._modalDlg._cont.firstChild)this.hideModalDlg();else if(MI.PicList.contains(b,this.container)||MI.PicList.modalInstance===this&&MI.PicList.contains(b,this._modalDlg._body))for(;e-- >0&&b;){c=(c=b.className&&b.className.match(d))&&c[1];if(f[c]){if(f[c].apply(this,
[b,a])!==true){g.stop();g.prevent()}break}b=b.parentNode}};MI.PicList.prototype._hlKeyDown=function(a){a=UI.E(a);var b=a.target.tagName;if(this.activeDlg&&b!=="TEXTAREA"&&b!=="INPUT")switch(a.key){case 37:this.showPrevDlg();a.prevent();MI.Bos("btnPicPrevKey");break;case 39:this.showNextDlg();a.prevent();MI.Bos("btnPicNextKey");break;case 27:this.hideModalDlg()}};MI.PicList.prototype._hlScrResize=function(){this.activeDlg&&this.rePosDlg()};MI.PicList.prototype._changeDir=function(){var a=this.direction===
"T"?"B":"T";UI.removeClass(this._tipContainer,"card"+this.direction);this.direction=a;UI.addClass(this._tipContainer,"card"+a)};MI.PicList.prototype._delayShowTip=function(a){var b=this;if(this.active!==a){if(this._showTipId){clearTimeout(this._showTipId);this._showTipId=null}this._showTipId=setTimeout(function(){b._showTip(a)},200)}};MI.PicList.prototype.arrTop=function(){this.direction==="B"&&this._changeDir()};MI.PicList.prototype.arrBottom=function(){this.direction==="T"&&this._changeDir()};MI.PicList.prototype._imgReady=
function(){var a=[],b=null,c,e=function(){var d;for(d=0;d<a.length;d++)if(a[d].end)a.splice(d--,1);else a[d]();if(!a.length){clearInterval(b);b=null}};return{start:function(d,f,g,h){var i,j,p,k,n;c=new Image;c.src=d;if(c.complete){f.call(c);g&&g.call(c)}else{j=c.width;p=c.height;c.onerror=function(){h&&h.call(c);i.end=true;c=c.onload=c.onerror=null};i=function(){if(c){k=c.width;n=c.height;if(k!==j||n!==p||k*n>1024){f.call(c);i.end=true}}};i();c.onload=function(){i.end||i();g&&g.call(c);c=c.onload=
c.onerror=null};if(!i.end){a.push(i);if(b===null)b=setInterval(e,40)}}},stop:function(){if(c)c.onload=c.onerror=null;c=null;a=[];clearInterval(b);b=null}}}();MI.PicList.prototype._showTip=function(a){var b,c,e,d,f,g,h,i,j,p,k,n;if(!(this.active===a||this.config.noTip)){e=this;g=e.config.isGuest;setTimeout(function(){MI.Bos(g?"btnPicShow":"btnPicShowHome",MI.PicList.getWindowXY()[1]+MI.PicList.UA)},0);if(j=UI.G("mainWrapper")){f=UI.GC(j,".main")[0];if(this.oriBodyZindex===f.style.zIndex)f.style.zIndex=
10;j.style.zIndex=3}if(this.content===a){this._hideMoreOp();this.active=a;UI.show(this._tipContainer)}else{UI.hide(this._tipContainer);f=this._tipContainer.firstChild;this.content=null;f.innerHTML="";if(UI.B.ie===6)f.style.cssText="_font-size:0";this.active=a;d=UI.G(a);this.content=a;this.activeTweet=f=MI.PicList.getTidFromId(a);if(UI.B.ie===6)this._tipContainer.firstChild.cssText="";b=UI.GC(d,".imgModMore")[0];this._tipContainer.firstChild.innerHTML=b.innerHTML;this._enableExpand(false);this.config.hasTools&&
UI.GC(this._tipContainer.firstChild,".pubInfo")[0].appendChild(this._getFunbox(f));p=UI.GT(d,"img")[0];if(p.src.match(/\/460$/)||p.src.match(/\/2000$/))k=true;UI.each(this._tipContainer.firstChild.getElementsByTagName("img"),function(l){if(l.className==="srs"){l.title=_(e.config.pptMode?e.config.hasTools?"进入幻灯模式查看":"点击进入微群":"点击查看详情");if(k)c=l.src=p.src;else{l.style.padding="20px 0";l.src="http://mat1.gtimg.com/www/mb/images/loading.gif";c=UI.A(l,l.className);l.style.width="16px"}h=l}else if(l.className===
"crs"){l.src=UI.A(l,l.className);l.className=""}});this.containerY=UI.getY(this.container);if(k)if(p.naturalWidth)this._show(true,d,{w:p.naturalWidth,h:p.naturalHeight});else{n=new Image;n.onload=function(){e._show(true,d,{w:n.width,h:n.height});n=n.onload=null};n.src=p.src}else{this._showLoadId=setTimeout(function(){e&&e._show(true,d,{w:16,h:16})},500);i=new Date;if(this._readyImgObj){UI.remove(this._readyImgObj);this._readyImgObj=null}this._imgReady.stop();this._imgReady.start(c,function(){var l=
this.width,q=this.height,m=UI.DC("img"),s=UI.GT(d,"img")[0];h.style.width=l+"px";h.style.height=q+"px";h.style.padding="0";h.style.zIndex=0;h.style.position="absolute";h.style.top="0px";h.style.left=l<MI.PicList.MIN_WIDTH?(MI.PicList.MIN_WIDTH-l)/2+"px":"0px";m.style.height=q+"px";m.style.width=l+"px";m.style.position="relative";m.style.zIndex=-1;m.src=s.src;e._readyImgObj=m;UI.prepend(m,e._tipContainer.firstChild.getElementsByTagName("a")[0]);h.src=s.src;h.src=c;if(e._showLoadId){clearTimeout(e._showLoadId);
e._showLoadId=null}e._show(true,d,{w:l,h:q})},function(){MI.PicList.adjustAutoLoadIndex(2,new Date-i);if(e&&e.active===a){UI.remove(e._readyImgObj);e._readyImgObj=null;h.src=c;h.style.width="auto";h.style.height="auto";h.style.padding="0";h.style.position="static"}},function(){h.src=c;h.style.width="auto";h.style.height="auto";h.style.padding="0";h.style.position="static";MI.picError(h);h=d=b=e=null;e._readyImgObj=null})}}}};MI.PicList.prototype._hide=function(){var a;if(this._showLoadId){clearTimeout(this._showLoadId);
this._showLoadId=null}if(this._showTipId){clearTimeout(this._showTipId);this._showTipId=null}this.active=null;UI.hide(this._tipContainer);if(UI.G("mainWrapper")){UI.G("mainWrapper").style.zIndex=1;a=UI.GC(UI.G("mainWrapper"),".main")[0];if(this.oriBodyZindex!==a.style.zIndex)a.style.zIndex=this.oriBodyZindex}};MI.PicList.prototype._setPos=function(a,b,c){if(c<12)c=12;this._tipContainer.style.left=a+"px";this._tipContainer.style.top=b+"px";this._arrow.style.left=c+"px"};MI.PicList.prototype._show=
function(a,b,c){var e,d,f,g,h,i,j,p,k,n,l;f=b.getElementsByTagName("img")[0];k=this.containerY;i=MI.PicList.MAX_UNEXPD_HEIGHT;g=this._tipContainer.firstChild.getElementsByTagName("div");if(!g||!g[0])this._hide();else{g=g[0];h=g.getElementsByTagName("img");if(!h||!h[0])this._hide();else{MI.PicList.breakWord(UI.GC(this._tipContainer,".msgCnt")[0]);h=h[0];d=c?c.h:parseInt(h.height,10);c=c?c.w:parseInt(h.width,10);if(c>MI.PicList.MAX_WIDTH){d=d/c*MI.PicList.MAX_WIDTH;c=MI.PicList.MAX_WIDTH;h.style.width=
c+"px";h.style.height=d+"px"}this._imgH=d;if(d>i){g.style.height=i+"px";g.style.overflow="hidden";this._expanded=false}else g.style.height="auto";this._enableExpand(true);if(c<MI.PicList.MIN_WIDTH){c=MI.PicList.MIN_WIDTH;h.style.width="auto"}g.style.width=c+"px";this._tipContainer.style.width=c+12+"px";UI.show(this._tipContainer);this._tipContainer.style.visibility="hidden";l=this._tipContainer.offsetHeight;g=UI.getY(f);d=parseFloat(UI.C(f,"top"),10);isNaN(d)||(g-=d);h=UI.scrollY();i=MI.PicList.getWindowXY();
d=i[0];i=i[1];p=MI.PicList.getDocumentXY()[1];j=this.config.direction;n=Math.min(f.offsetHeight,f.parentNode.parentNode.offsetHeight);n=this.config.arrPos===0?n/2:Math.min(n,this.config.arrPos);if(j===0)j=(j=b.offsetTop<=350)||g+n+l-h-i<=0||g-l<h&&g+n+l+k<p?1:2;UI.scrollX();if(j===1){this.arrTop();e=g+n-k;k=g+n+l-h-i;if(k>0)this._scroll2(h+k+30);else g+f.offsetHeight/2<h&&this._scroll2(g+f.offsetHeight/2-10)}else if(j===2){this.arrBottom();e=g-l-k+n;k=g+n-l-h;if(k<0)this._scroll2(h+k);else g+f.offsetHeight/
2>h+i&&this._scroll2(g+f.offsetHeight/2-i+10)}b=b.offsetLeft+(b.offsetWidth-c)/2;f=(MI.PicList.PAGE_WIDTH<d?MI.PicList.PAGE_WIDTH-d:0)/2+12;if(b<f){f=(c+12)/2-f+b;b=(MI.PicList.PAGE_WIDTH<d?MI.PicList.PAGE_WIDTH-d:0)/2+12}else f=(c+12)/2;this._setPos(b,e,f);if(a)this._tipContainer.style.visibility="visible"}}};MI.PicList.prototype._scroll2=function(a){if(this.config.autoScroll){var b=this,c=UI.scrollY(),e=UI.scrollX(),d=a>c?20:-20,f=Math.ceil(Math.abs((a-c)/d)),g=f*20,h=0,i;i=function(){if(h++<f){c=
h===f?a:c+d;window.scrollTo(e,c);b._scrollId=setTimeout(i,g/f)}};this._scrollId&&clearTimeout(this._scrollId);if(!(Math.abs(d)<0.1))this._scrollId=setTimeout(i,g/f)}};MI.PicList.prototype.more=function(a,b,c){if(MI.Base){var e,d,f,g,h,i,j=this;if(j.last){h={r:MI.random(),time:j.last.time,id:j.last.id,page:j.page+1};i=UI.A(j._more,"rel");if(this.config.searchPage)h.p=this.config.searchPage;if(this.config.owner)h.u=this.config.owner;if(!j._more.sending){UI.addClass(j._more,"loading");if(i){e=+new Date;
MI.ajax({url:i,type:"get",data:h,timeout:3E4,fail:function(){d=+new Date-e;MI.PicList.adjustAutoLoadIndex(1,d);UI.removeClass(j._more,"loading");j._more.sending=0},success:function(p){d=+new Date-e;MI.PicList.adjustAutoLoadIndex(1,d);j.page+=1;j.addMore(p);b&&j._showArrow();j.config.searchPage&&j.config.searchPage++;f=+new Date-e;setTimeout(function(){g=+new Date-e;MI.Speed("t_asyn_more",0.0050,d,f,g)},0);c&&c(p)}});MI.Bos(a?"btnPicMoreAuto":"btnPicMore")}}j._more.sending=1}}};MI.PicList.prototype.addMore=
function(a,b){var c,e,d,f,g,h=UI.isString(a);f=this.items(this._lists);if((c=h?MI.json(a):a)&&c.result===0){if(!this.config.owner&&c.info.user!==MI.user.account){document.location.reload();return}c.info.guest=this.guest;c.info.fav=this.last&&this.last.fav?1:0;c.info.iconPic=this.iconPic;MI.PicList.addImgProperty(c.info.talk);c.info.talk=MI.PicList.copyMultiPic(c.info.talk);c.info.talk=this.removeRepeat(c.info);this.autoResize(c.info.talk);c.info.showHot=this.config.showHot;e=document.createDocumentFragment();
c.info.fitWidth=this.config.fitWidth;c.info.fitHeight=this.config.fitHeight;c.info.idPrefix=this.config.idPrefix;d=UI.html((new UI.tmplString(this.tmpl.replace(/\$\{itemClass\}/g,this.config.itemClass)))(c.info));if(c.info.talk.length){f=0;for(g=d.length;f<g;f++)UI.append(d[f],e);UI.append(e,this._lists);UI.B.ie||MI.GoTop.position();MI.dialog&&MI.dialog.display&&MI.dialog.resizeBg();this.activeDlg&&this._modalDlg.resizeBg();b||MI.PV(MI.api.type===5?"mb/qzone/more":"more");h&&UI.isNumber(MI.ajaxTimes)&&
MI.ajaxTimes++;this.hideEmpty();this.autoRun()}else f.length===0&&this.showEmpty();if(c.info.hasNext===0||!this.hasMore||c.info.talk.length===0){this._more&&UI.addClass(this._more.parentNode,"hide");this.more=function(){};this.noMore=true}else this.cacheLast();this.moreTimes++;this.moreCall&&this.moreCall()}UI.removeClass(this._more,"loading");if(this._more)this._more.sending=0};MI.PicList.prototype.removeRepeat=function(a){function b(i){return(i=i.match(RegExp("([a-z0-9A-Z]){20}","g")))&&i.length?
i[0]:""}var c=this,e=a.talk,d,f,g,h;if(!this.config.searchPage){this.hasMore=e.length;return e}if(!this.totalNum)this.totalNum=a.total;this.hasMore=e.length;if(this.config.searchPage*15>this.totalNum)this.hasMore=false;a=[];if(!UI.isArray(e))return a;if(!this.mapCache){this.mapCache={};UI.each(this.items(),function(i){var j;if(i.id){j=UI.children(i,"clk-1");if(j.length>=1){j=UI.GC(j[0],"img")[0].src;c.mapCache[b(j)]=i.id}}})}for(d=0;d<e.length;d++){f=e[d];g=true;h=(h=MI.PicList.getImageTweet(f))&&
b(h.img[0].url);if(!h||c.mapCache[h])g=false;if(g){a[a.length]=f;c.mapCache[h]=f.id}}return a};MI.PicList.prototype.autoMore=function(){var a,b,c,e=this;b=function(){clearTimeout(a);a=setTimeout(c,200)};c=function(){if(MI.PicList.doAutoLoad&&UI.pageHeight()-UI.scrollY()-UI.windowHeight()<900)e.more(1);else MI.PicList.doAutoLoad||UI.ER(window,"scroll",b)};this.moreTimes=0;this.events.am=b;UI.EA(window,"scroll",b)};MI.PicList.prototype.cacheLast=function(){for(var a=this.items(),b=a[a.length-1];b&&
!UI.hasClass(b,this.config.itemClass);)b=UI.prev(b);if(b){a=UI.A(b,"rel");b=MI.PicList.getTidFromId(b.id);this.last={id:b,time:a}}};MI.PicList.prototype.bottom=function(){var a,b,c,e,d=this._lists;if(d){a=UI.GC(".main .imgMod");b=UI.parents(d,"main")[0];e=0;if(b)c=b.parentNode;a.length||(a=UI.GC(".imgMod"));if((a=a[a.length-1])&&UI.height(d)){UI.C(a,"marginBottom",0);if(b)e=UI.height(b)-UI.height(c);else if(c=UI.G("mainWrapper")){UI.each(c.childNodes,function(f){if(f.nodeType===1)e+=UI.height(f)});
e-=UI.height(c)}UI.C(a,"marginBottom",e<-1?-e+"px":"")}}MI.bottom&&MI.bottom()};MI.PicList.prototype.expand=function(){var a=this._tipContainer.firstChild.getElementsByTagName("div")[0],b=this,c=MI.PicList.IE_VER===6||MI.PicList.IE_VER===7?80:20,e=this._imgH,d=MI.PicList.MAX_UNEXPD_HEIGHT,f=Math.ceil(Math.abs((e-d)/c)),g=f*15,h=0,i;i=function(){if(h++<f){d=h===f?e:d+c;UI.C(a,"height",d+"px");b._expaId=setTimeout(i,g/f)}};this._expaId&&clearTimeout(this._expaId);if(!(Math.abs(c)<0.1)){this._enableExpand(false);
this._expanded=true;this._expaId=setTimeout(i,g/f)}};MI.PicList.prototype._enableExpand=function(a){var b=this._tipContainer.childNodes[1],c=MI.PicList.MAX_UNEXPD_HEIGHT;if(a=a&&this._imgH>c+40&&!this._expanded){UI.C(b,"top",c-36+"px");UI.C(b,"visibility","visible")}else UI.C(b,"visibility","hidden")};MI.PicList.prototype._toggle=function(a,b,c){var e,d,f,g,h,i=this,j=b.url,p=b.callback;if(this.activeDlg){d=this.activeDlg;f=MI.PicList.getTidFromId(d);h=this._modalDlg._cont}else{d=this.content;f=this.activeTweet;
h=this._tipContainer}g={id:f,r:MI.random()};if(c)g.veriCode=c;e=UI.G(d);h=UI.GC(h,".clk-"+b.btnClass)[0];if(a)g.op=a<2?1:2;if(!e.sending){MI.ajax({url:j,data:g,success:function(k){e.sending=0;k=MI.json(k);if(k.result===0){if(a===1){UI.addClass(h,"light");h.innerHTML=_("取消"+b.chName);if(b.btnClass==="uptop"){i._hide();var n=_("我刚置顶了一条微博，大家来看看吧~")+"http://t.qq.com/"+MI.user.account+"?preview";MI.talk(_('置顶成功，把我的置顶告诉大家:&nbsp;&nbsp;<span style="color:#999">[最多置顶3条微博]</span>'),n,"50")}}else if(a===2){UI.removeClass(h,
"light");h.innerHTML=_(b.chName)}k.id=f;p&&p(a,k)}else if(MI.code.check(k.result))MI.code.show({msg:k.msg,code:k.info,call:function(l){i._toggle(a,b,l)}});else k.msg&&b.noticeErr&&MI.alert(k.msg)}});e.sending=1}};MI.PicList.prototype._showArrow=function(){var a,b,c=false;this._modalDlg.arrAdded||this._addArrowCls();b=(a=UI.G(this.activeDlg))&&this.prev(a)?"":"hidden";UI.C(this._elArrLeft,"visibility",b);if(a&&this.next(a))b="";else{c=true;b="hidden"}a=this._elArrRight;this.rePosDlg();UI.C(a,"visibility",
b);return c};MI.PicList.prototype._addArrowCls=function(){var a,b,c=this._modalDlg;a=UI.DC("div");a.className="imgModArr";a.innerHTML='<a class="clk-arrl" href="javascript:void(0)" title="'+_("上一张(用键盘←键也可翻页)")+'" hideFocus><b></b></a><a class="clk-arrr" href="javascript:void(0)" title="'+_("下一张(用键盘→键也可翻页)")+'" hideFocus><b></b></a>';this._elArrLeft=b=a.firstChild;this._elArrRight=b.nextSibling;c._cont.firstChild.appendChild(a);b=UI.DC("a");b.className="imgModPptCls clk-pptcls";b.href="javascript:void(0)";
b.title=_("点击ESC也可以退出");UI.after(b,a);this._elClose=b;c.arrAdded=true};MI.PicList.prototype.rePosDlg=function(a){var b,c,e,d,f,g=MI.PicList.getWindowXY();a=this._modalDlg._wrap;c=UI.GC(a.parentNode,".clk-arrl")[0];b=UI.GC(a,".imgModTips")[0];if(c){e=c.nextSibling;f=parseInt(b.firstChild.offsetHeight,10);d=(g[1]-MI.PicList.ARROW_SIZE)/2;c.style.paddingTop=e.style.paddingTop=d+"px";d=f-MI.PicList.ARROW_SIZE-d;c.style.paddingBottom=e.style.paddingBottom=(d>=0?d:0)+"px";d=UI.scrollY();a.style.top=d+"px";
a.style.left=(g[0]-MI.PicList.MODAL_WIDTH)/2+"px";c.style.left=(g[0]-MI.PicList.MODAL_WIDTH-16)/2+"px";e.style.left=(g[0]+MI.PicList.MODAL_WIDTH-16)/2-109+"px";this._elClose.style.right="auto";this._elClose.style.left=(g[0]+MI.PicList.MODAL_WIDTH-18)/2+"px";b.style.height=UI.windowHeight()-15+"px";if(MI.PicList.IE_VER===6){document.body.style.overflow="hidden";b.style.position="absolute";b.style.width=UI.windowWidth()+"px";b.style.top=0;b.style.left=(MI.PicList.MODAL_WIDTH-g[0])/2+"px"}this._modalDlg.resizeBg()}};
MI.PicList.prototype._showTalkBox=function(a,b){var c,e,d,f;this._hideMoreOp(UI.GC(this._modalDlg._cont,".mFun")[0]);f=this;e=UI.GC(this._modalDlg._cont,".relayThumb")[0];UI.hide(e);e=e.firstChild;if(e.appended){d=this.talkBox;UI.show(this.nextSibling)}else{c=UI.html(MI.tmpl.reply.replace("talkWrap","zfWrap").replace('<div class="left"></div>','<div class="left" style="display:none;width:135px;"><label for="replayListCheckbox"><input id="replayListCheckbox" type="checkbox"'+(a?" checked":"")+' class="check1">'+
_("同时转播给你的听众")+"</label></div>").replace("talkSuc",""))[0];UI.GC(this._modalDlg._cont,".relayThumb");d=new MI.TalkBox(c);d.countTxt();d.addList=0;d.iconPic=0;d.autoHeight=30;d._relayCheck=UI.GC(d._body,".check1")[0];d.successStart=function(){MI.tip(d.type==1?_("转播成功！"):d.type===2?_("发送成功"):_("评论成功！"))};UI.after(c,e.parentNode);d._body.ondblclick=function(h){UI.E(h).stop()};if(!UI.B.ie)d._body.onmousedown=function(h){UI.E(h).stop()};d._relayCheck.onclick=function(){d.type=this.checked?1:4;d._tip.innerHTML=
"";d.countTxt();d.addList=0;MI.Bos("btnRelayistCheckbox")};e.appended=1;if(!this.relayListMulti)this.talkBox=d}if(b){d._txt.value="";try{d._txt.focus();MI.selectTxt(d._txt,0,0,0);d.countTxt()}catch(g){}}else setTimeout(function(){var h=UI.GC(f._modalDlg._cont,".msgWrap")[0];h.id=f.id+"-dlg-"+f.activeDlg;MI.TalkList.getRelayOld(h,undefined,d)},100);d.txtTipSend=a?_("转播中"):b?_("发送中"):_("评论中");d.type=a?1:b?2:4;c=this.activeDlg;c=MI.PicList.getTidFromId(c);d.talkId=c;c=d._relayCheck.parentNode.parentNode;
if(a){c.style.display="none";d._body.className="zfWrap"}else if(b){d.talkTo=b;c.style.display="none";d._body.className="talkWrap";d._body.style.cssText="background:transparent;padding-top:8px"}else{d._relayCheck.checked=false;c.style.display="block";d._body.className="zfWrap comtWrap"}MI.app({TalkBoxRich:function(){!a&&b?UI.hide(d._rtPicWrap):UI.show(d._rtPicWrap)}})};MI.PicList.prototype._genRelayCombo=function(a,b){var c,e,d,f,g=this,h,i=this._modalDlg._cont.firstChild,j=function(){},p=function(k){k=
MI.json(k);if(k.result!==0){k.msg&&MI.alert(k.msg);MI.PicList.relayListHide()}else{UI.hide(e);d.innerHTML=k.info;if(k.pic){f.innerHTML=k.pic;if(UI.B.ie6){var n=UI.GC(f,".imgBox")[0];n.onmouseover=function(){UI.each(UI.GC(n,"a"),function(t){t.style.filter="none"})};n.onmouseout=function(){UI.each(UI.GC(n,"a"),function(t){t.style.filter="alpha(opacity=60)"})}}}UI.show(d);UI.show(f);var l=UI.GC(d,".tabStyle1");if(l&&l[0])l[0].style.display="none";UI.evalScript(k.info);UI.hide(UI.GC(d,".nfunTips")[0]);
k=UI.GC(d,".pages a,.tabStyle1 a");UI.each(k,function(t){if(!UI.A(t,"target"))t.onclick=j});k=UI.GC(d,"ul.clear li");k.length&&MI.PicList.type!==1&&MI.PicList.type!==2&&UI.addClass(k[k.length-1],"nobor");try{var q=UI.GC(c,".num")[0],m,s=UI.GC(void 0,".relayNum")[0];UI.GC(c,".num2");UI.GC(i,".relayNum");if(q){m=q.innerHTML;if(m==="0"&&UI.GC(c,"ul.clear li").length===0){UI.hide(UI.GC(c,"ul.clear")[0]);UI.hide(UI.GC(c,".pages")[0])}if(m>parseInt(s.innerHTML,10))s.innerHTML=m}}catch(o){}if(q=UI.GC(d,
".relayThumb")[0])q.className="relayThumb clk-relay2";d.onclick=function(){MI.DisableDblClickSelect(this)};MI.PV("relay")}};if(!c){MI.PicList.genRelayList("");c=MI.PicList._relayList;e=MI.PicList._relayListLoad;d=MI.PicList._relayListCont;f=MI.PicList._relayListPic}MI.PicList.xhrRelay&&MI.PicList.xhrRelay.abort();UI.hide(d);UI.show(e);UI.after(c,i.firstChild);h=UI.GC(i,".clk-2")[0].href;h=MI.hostType===3?h.match(/#id=(\d+)/)[1]:h.match(/p\/t\/(\d+)/)[1];h="id="+h+"&viewModel=2&r="+MI.random();if(MI.api.type)h+=
"&apiType="+MI.api.type;MI.PicList.xhrRelay=MI.ajax({url:MI.url.relayList,type:"get",data:h,success:function(k){p(k);g&&g.rePosDlg&&g.rePosDlg();b&&g&&g._showTalkBox(true)}})};MI.PicList.prototype.hideModalDlg=function(){this._modalDlg.hide()};MI.PicList.prototype.showModalDlg=function(a,b,c){var e,d,f,g,h,i,j,p,k,n,l,q,m,s,o=this,t,u;if(this.config.oldModal)if(MI.Base){if(!(MI.PicList.modalInstance&&MI.PicList.modalInstance!==this)){this.active&&this._hide();t=function(){document.body.parentNode.style.overflow=
"";document.body.parentNode.style.marginRight="0";if(UI.B.firefox)document.documentElement.scrollTop=o.oldScrollTop;o._modalDlg._cont.innerHTML="";o._modalDlg.arrAdded=false;o.activeDlg=null;MI.PicList.modalInstance=null};this.activeDlg&&!b&&t();MI.PicList.modalInstance=this;this.activeDlg=a;i=UI.G(a);f=UI.GC(i,".imgModMore")[0];if(!this._modalDlg){this._modalDlg=new MI.Dialog;this._modalDlg.create();this._addModalEvents();UI.C(this._modalDlg._bg,"opacity",0.8);this._modalDlg._wrap.style.padding=
"0";UI.GC(this._modalDlg._body,".DWrap")[0].style.padding="0"}e=this._modalDlg;j=UI.DC("div");p=UI.DC("div");p.className="mediaWrap";j.innerHTML=f.innerHTML;k=UI.GC(j,"."+this.config.itemClass)[0];p.innerHTML='<div class="picBox big" onmouseover="this.firstChild.style.visibility=\'visible\'" onmouseout="this.firstChild.style.visibility=\'\'"><div class="tools"><a href="javascript:void(0)" class="btnBack clk-rotateimg"><em></em>'+_("向左转")+'</a><span>|</span><a href="javascript:void(0)" class="btnPrev clk-rotateimgcke"><em></em>'+
_("向右转")+'</a><a class="btnOriginal" href="javascript:void(0)" target="_blank">'+_("查看原图")+'</a><span class="mask"></span></div>'+k.innerHTML+"</div>";n=UI.GC(j,".msgCnt");UI.after(p,n[1]||n[0]);UI.remove(k);if(b){e._cont.firstChild.firstChild.innerHTML=UI.GC(j,".msgWrap")[0].innerHTML;UI.remove(UI.GC(e._cont,".imgModWhite")[0]);u=this._showArrow()}else{e.show({html:'<div class="imgModTips LC" style="border:0;"></div>',width:UI.windowWidth(),top:UI.scrollY(),start:function(){if(UI.B.firefox)o.oldScrollTop=
UI.scrollY();if(/webkit/i.exec(navigator.userAgent))UI.GC(".D")[0].style.height="auto";document.body.parentNode.style.overflow="hidden";document.body.parentNode.style.marginRight="15px";e._cont.parentNode.style.border="0";e._cont.firstChild.appendChild(UI.GC(j,".msgWrap")[0]);e._cont.firstChild.style.height=UI.windowHeight()+"px";u=o._showArrow();try{UI.GC(e._cont,".clk-arrr")[0].focus()}catch(r){}},end:t,noReserve:true,close:false});if(MI.PicList.IE_VER)e._wrap.firstChild.style.border="0"}UI.each(e._cont.firstChild.getElementsByTagName("img"),
function(r){var v;if(r.className==="srs"){d=r.src||UI.A(r,"srs");r.src="http://mat1.gtimg.com/www/mb/images/loading-black2.gif";r.style.cssText="width:16px;padding:10px 0;";r.className="large";g=r}else if(v=UI.A(r,"crs")){r.className="";r.src=v}});this._adjImgCtnHeight();g.style.marginRight=g.style.marginLeft="auto";UI.GC(e._wrap,".btnOriginal")[0].href=d.substr(0,d.length-3)+"2000";UI.hide(UI.GC(e._cont,".zfNum")[0]);h=new Date;this._imgReady.stop();this._imgReady.start(d,function(){var r,v,w,x;
x=UI.GC(e._con,".picBox.big")[0];w=UI.GT(UI.G(a),"img")[0];r=this.width;v=this.height;UI.GC(o._modalDlg._cont,".tools")[0].style.display="none";l=UI.DC("img");g.style.cssText="display:inline!important;";l.style.cssText="display:block!important;";l.style.position="absolute";l.style.zIndex="-100";l.style.width=g.style.width=r+"px";l.style.height=g.style.height=v+"px";l.src=w.src;g.src=w.src;g.src=d;UI.after(l,g);q=UI.GC(o._modalDlg._cont,".msgBox")[0];m=UI.GC(o._modalDlg._cont,".msgWrap")[0];s=parseInt(UI.C(g,
"marginTop"),10);s=UI.height(q)-2*(isNaN(s)?0:s);if(s>450){m.style.height="auto";l.style.top="0px";g.style.margin="0 auto"}else{l.style.top=(450-s)/2+"px";g.style.margin=(450-s)/2+"px auto";m.style.height="450px"}g.style.padding="0";l.style.left=(UI.width(x)-r)/2+"px"},function(){var r,v;UI.remove(l);MI.PicList.adjustAutoLoadIndex(2,new Date-h);UI.GC(o._modalDlg._cont,".tools")[0].style.display="block";if(o&&o.activeDlg===a){r=MI.PicList.getTidFromId(a);g.src=d;g.style.cssText="height:"+this.height+
"px;width:"+this.width+"px;display:inline!important;";o._adjImgCtnHeight();o.config.hasTools&&UI.GC(e._cont.firstChild,".pubInfo")[0].appendChild(o._getFunbox(r));g.r=0;if(!UI.B.ie){v=r+"C";r=UI.html('<canvas style="display:none" id="'+v+'"></canvas>')[0];UI.after(r,g);MI.canvas[v]=r.getContext("2d");UI.A(r,"width",g.width);UI.A(r,"height",g.height)}setTimeout(function(){o&&o.rePosDlg()},0)}i=f=g=e=null},function(){UI.GC(o._modalDlg._cont,".tools")[0].style.display="block";i=f=g=e=null});this._genRelayCombo(MI.PicList.getTidFromId(a),
c);if(u)this.noMore||this.more(true,true)}}else MI.app({Base:function(){o.showModalDlg(a,b,c)}});else this.showNewModal(a,b,c)};MI.PicList.prototype._adjImgCtnHeight=function(a){var b=UI.GC(this._modalDlg._cont,".msgBox")[0],c=UI.GC(this._modalDlg._cont,".msgWrap")[0],e;e=UI.B.ie||!a?UI.GC(b,".picBox img")[0]:UI.GC(b,".picBox canvas")[0];a=parseInt(UI.C(e,"marginTop"),10);a=UI.height(b)-2*(isNaN(a)?0:a);if(a>450){c.style.height="auto";e.style.margin="0"}else{e.style.margin=(450-a)/2+"px 0";c.style.height=
"450px"}};MI.PicList.prototype.next=function(a){a=UI.next(a);if(UI.hasClass(a,this.config.itemClass)&&a.id)return a};MI.PicList.prototype.prev=function(a){a=UI.prev(a);if(UI.hasClass(a,this.config.itemClass)&&a.id)return a};MI.PicList.prototype.showNextDlg=function(){var a;if(a=UI.G(this.activeDlg))(a=this.next(a))&&this.showModalDlg(a.id,true)};MI.PicList.prototype.showPrevDlg=function(){var a;if(a=UI.G(this.activeDlg))(a=this.prev(a))&&this.showModalDlg(a.id,true)};MI.PicList.prototype.showEmpty=
function(){var a=this._lists,b=this,c=10,e=UI.GC(a,".noPubs")[0],d;if(!e){e=UI.html('<div class="noPubs">'+_("暂时没有图片可以看哦")+"</div>")[0];a.appendChild(e)}this.toidEmpty=d=setInterval(function(){b.bottom();c--<1&&clearInterval(d)},1E3);UI.show(e);UI.addClass(this.config.moreBtn,"undis")};MI.PicList.prototype.hideEmpty=function(){var a=UI.GC(this._lists,".noPubs")[0];clearInterval(this.toidEmpty);a&&UI.hide(a);UI.removeClass(this.config.moreBtn,"undis")};MI.PicList.prototype._isMbAuthor=function(){var a;
a=UI.G(this.content||this.activeDlg);a=UI.GC(a,"strong a")[0];a=MI.string.account(a.title||UI.A(a,"rel"));if(a===MI.user.account)return true;return false};MI.PicList.prototype._getFunbox=function(){var a,b,c,e,d,f,g,h="",i,j;if(MI.guest&&MI.guest.user===MI.user.account)g=true;if(MI.Group&&MI.Group.qid)h="/1";a='<div class="funBox"><a href="#" class="clk-relay">'+_("转播")+"</a><span>|</span>";b='<span>|</span><div class="mFun"><a href="#" class="clk-mo-more">'+_("更多")+'<em class="btn_ldrop"></em></a><div class="mFunDrop clk-mo-morectn"><b></b><b class="mask"></b><p>';
c='</p><p><a href="#" class="clk-fav">'+_("收藏")+'</a></p><div class="shareBtn"><p><a href="#" class="clk-share">'+_("分享")+"</a></p></div>";e=(g?'<p><a href="#" class="clk-uptop">'+_("置顶")+"</a></p>":"")+'<p><a href="#" class="clk-report">'+_("举报")+"</a></p></div></div></div></div>";d='<a href="#" class="clk-reply">'+_("对话")+"</a>";i='<a href="#" class="clk-del">'+_("删除")+"</a>";f='" class="clk-comment">'+_("评论")+"</a>";j='" class="clk-detail" target="'+(MI.hostType===3?"_self":"_blank")+'">'+_("详情")+
"</a></p>";return function(p){var k=MI.getInternalUrl(1,p,h);p='<a href="'+k+f;k='<p><a href="'+k+j;return MI.user.fun.apolloStyle?UI.html(a+p+b+(g||this._isMbAuthor()?i:"")+c+k+e)[0]:UI.html(MI.user.fun.btnStyle===1?a+(g||this._isMbAuthor()?i:d)+b+p+c+k+e:a+p+b+(g||this._isMbAuthor()?i:d)+c+k+e)[0]}}();MI.PicList.prototype._prepareTip=function(){var a;if(!this._tipContainer){this._tipContainer=UI.html('<div class="imgModTips cardT" style="display:none;z-index:1000;"><div></div><div class="imgExpd clk-expd"></div><div class="uloadBox"><em class="loading"></em>'+
_("加载中")+'</div><div class="SA"><em>◆</em><span>◆</span><b>◆</b></div></div>')[0];a=this.container;a.insertBefore(this._tipContainer,a.firstChild);this._arrow=UI.GC(this._tipContainer,".SA")[0];this.direction="T";a.style.position="relative"}};MI.PicList.prototype.reset=function(){this._lists.innerHTML="";this._tipContainer=null;this._prepareTip()};MI.PicList.prototype.items=function(){var a=[];UI.each(UI.GC(this._lists,"."+this.config.itemClass),function(b){b.id&&a.push(b)});return a};MI.PicList.prototype.showFirstModal=
function(){var a=this.items();a&&a[0]&&this.showModalDlg(a[0].id)};MI.PicList.prototype.showNewModal=function(){var a,b;b=function(c,e){var d;MI.PicList.addImgProperty(c);d=MI.PicList.copyMultiPic(c);UI.each(d,function(f,g){e&&e(f,g);if(f&&f.source){f.source._sonId=f.id;d[g]=f.source}d[g].videos=undefined});return d};a=function(c,e,d){d=d||function(){};MI.ajax({url:MI.url.getMsg,data:{ids:c.join(","),_r:MI.random()},success:function(f){if(f)f=MI.json(f);f&&f.result===0&&f.info&&f.info.talk&&e(f.info.talk)},
fail:d})};return function(c){var e=UI.G(c),d=[],f=this,g=MI.PicList.getTidFromId(c),h,i,j,p,k,n,l;if(e){n=function(q,m,s){for(var o=0,t=[];o++<m&&q;)if(q=f[s?"prev":"next"](q))t[s?"unshift":"push"](q);return t};p=function(){var q,m=false,s,o=0;if(j&&MI.PicList.cPlayer){if(c.match(/([0-9]{5,})-([0-9])$/))m=RegExp.$2;s=b(j,function(t,u){if(t.id===g)if(m===false)q=u;else{if(o-m===0)q=u;o++}});MI.PicList.cPlayer.play(s,q)}};k=function(){var q={};return function(m){var s=[],o,t;m=!!m;if(!q[m]){q[m]=true;
t=function(){var u=m?"left":"right";s.length?a(s,function(r){j=j.concat(r);r=b(r);q[m]=false;MI.PicList.cPlayer.player.addUnlimitedData(r,u)},function(){q[m]=false}):MI.PicList.cPlayer.player.addUnlimitedData([],u)};o=n(UI.G(m?h:i),16,m);UI.each(o,function(u,r){var v;if(u)if(v=MI.PicList.getTidFromId(u.id)){s.push(v);if(m&&r===0)h=u.id;else if(!m)i=u.id}});if(!f.noMore&&!m)if(o.length===16){t();o=n(o[15],16,m);o.length<16&&f.more(true,false)}else{q[m]=false;f.more(true,false,function(){k(m)})}else t()}}}();
l=function(q,m){MI.ajax({url:"http://api.t.qq.com/read/getReadRelayMessage.php",type:"post",data:{rootId:q,page:1,pageSize:20,ctype:0,filter:0,_r:MI.random()},success:function(s){if(s)if((s=MI.json(s))&&s.result===0){var o;UI.each(j,function(t){if(t.id===m&&t.source)o=[t]});if(o)UI.each(s.info.talk,function(t){t.id!==g&&o.push(t)});else o=s.info.talk;MI.PicList.cPlayer.comment.commentDataHandler(o)}else MI.PicList.cPlayer.comment.commentDataHandler([])},fail:function(){MI.PicList.cPlayer.comment.commentDataHandler([])}})};
UI.each(n(e,8,true).concat([e]).concat(n(e,8)),function(q){var m;if(q)if(m=MI.PicList.getTidFromId(q.id)){d.push(m);if(!h)h=q.id;i=q.id}});j=null;MI.app({"c/player/mi.cSlide.player":function(){MI.PicList.cPlayer&&MI.PicList.cPlayer.destroy();MI.PicList.cPlayer=new MI.CSlidePlayer;MI.PicList.cPlayer.config({comment:{opened:0,customMode:true},unlimited:true});MI.PicList.cPlayer.create();MI.PicList.cPlayer.player.events_hub.listen("on_end_left",function(){k(true)});MI.PicList.cPlayer.player.events_hub.listen("on_end_right",
function(){k()});MI.PicList.cPlayer.comment.events_hub.listen("on_update_comment",function(q,m){l(m.source?m.source.id:m.id,m._sonId||m.id)});p()}});a(d,function(q){j=q;p()})}}}();MI.PicList.prototype.autoRun=function(){var a,b=this.config.autorunId,c;if(b){c=this.items();a=c[0].id;UI.each(c,function(e){if(MI.PicList.getTidFromId(e.id)===b){a=e.id;return true}});this.showModalDlg(a,false,true);this.config.autorunId=""}};MI.PicList.prototype.destroy=function(){var a=this.events;UI.ER(this.container,
"mouseover",a.mo);UI.ER(this.container,"mouseout",a.mout);UI.ER(document.body,"click",a.click);UI.ER(document,"keydown",a.kd);UI.ER(window,"resize",a.sr);UI.B.ie6&&UI.ER(window,"scroll",a.sr);a.am&&UI.ER(window,"scroll",a.am);if(a.modalMout){UI.ER(this._modalDlg._cont,"mouseover",this.events.mo);UI.ER(this._modalDlg._cont,"mouseout",this.events.modalMout)}this.events=null;this._lists.innerHTML="";this._lists=null;UI.remove(this._tipContainer);this._elClose=this._elArrRight=this._elArrLeft=this._more=
this._arrow=this._tipContainer=this._modalDlg=null;delete MI.PicList.instanceIds[this.id]};MI.app({Base:function(){MI.PicList.prototype.tmpl='<% var o,i,n,dt,imgo,nick,hotstyle,zfcnt,urlsuffix;      for (i=0,n=talk.length;i<n;i++){      o=talk[i];nick=o.bkname||o.nick;urlsuffix=o.qinfo&&o.qinfo.wqid?"/1":"";      imgo=(o.source&&o.source.img&&o.source.img.length)?o.source:(!o.source&&o.img&&o.img.length?o:0);      if (o && imgo) {        if (imgo.count >= 200 && showHot) {          hotstyle = " style=\\"border-color:#ff9934;\\"";          zfcnt = "zfcnt-hot";        } else {          hotstyle = "";          zfcnt = "zfcnt";        }        dt=UI.formatDate(UI.zoneDate(o.timestamp+"000",8),"'+
_("yyyy年M月d日 hh:mm")+'");%>    <div class="${itemClass}" id="<%=idPrefix+o.id+(imgo.img[0]._id?"-"+imgo.img[0]._id:"")%>" rel="<%=o.timestamp%>"<%=hotstyle%>>      <div class="<%=zfcnt%>"><%=imgo.count%></div>      <a href="<%=MI.getInternalUrl(1, o.id, urlsuffix)%>" target="<%=MI.hostType==3?"_self":"_blank"%>" class="clk-1">      <% if(imgo._imgInfo && imgo._imgInfo["resizeto"]) {%>        <img src="<%=imgo.img[0].url%>/<%=imgo._imgInfo.id%>" resizeto="<%=imgo._imgInfo["resizeto"]%>"'+(MI.Crs.onLoadResize?
' onload="MI.Crs.onLoadResize(this)"':"")+' />      <% } else { %>        <img src="<%=imgo.img[0].url%>/<%=imgo._imgInfo.id%>" style="position:relative;width:<%=imgo._imgInfo.w%>px;height:<%=imgo._imgInfo.h%>px;left:<%=imgo._imgInfo.l%>px;top:<%=imgo._imgInfo.t%>px"/>      <% } %>      </a>      <div class="imgModMore" style="display:none;">        <div class="${itemClass}"><a href="<%=MI.getInternalUrl(1, imgo.id, urlsuffix)%>" target="<%=MI.hostType==3?"_self":"_blank"%>" class="clk-2"><img alt="" class="srs" srs="<%=imgo.img[0].url%>/460" width="100%"></a></div>        <div class="msgWrap clear"><div class="userPic"><a title="" href="<%=MI.getInternalUrl(0, o.name)%>" rel="<%=nick%>(@<%=o.name%>)"><img src="<%=o.pic%>" card="1" ctype="1" title=""></a></div>          <div class="msgBox"><div rel="<%=o.name%>" class="userName"><strong><a title="<%=nick%>(@<%=o.name%>)" href="<%=MI.getInternalUrl(0, o.name)%>" card="1" ctype="2" rel="<%=nick%>(@<%=o.name%>"><%=nick%></a><%=o.icon%>'+
MIIcon("o.flag")+':</strong></div><div class="msgCnt"><%=o.content%></div><% if(o.type===2) {%>      <div class="replyBox" style="clear:both"><div class="msgBox" rel="<%=o.source.name%>"><div class="msgCnt"><strong><em>'+_("[原文]")+'</em>\n<a rel="<%=o.source.name%>" ctype="2" card="1" href="<%=MI.getInternalUrl(0, o.source.name)%>" title="<%=o.source.bkname||o.source.nick%>(@<%=o.source.name%>)"><%=o.source.bkname||o.source.nick%></a><%=o.source.icon%>'+MIIcon("o.source.flag")+':</strong><%=o.source.content%></div></div></div><% } %>          <div class="pubInfo"><span class="left"><a from="3" href="<%=MI.getInternalUrl(1, o.id, urlsuffix)%>" target="<%=MI.hostType==3?"_self":"_blank"%>" class="time" rel="<%=o.timestamp%>" title="<%=dt%>"><%=o.time%></a><% if (imgo.count>0) { %><a class="zfNum clk-rc" target="<%=MI.hostType==3?"_self":"_blank"%>" href="<%=MI.getInternalUrl(1, imgo.id, urlsuffix)%>">'+
_("查看全部转播和评论")+'(<b class="relayNum"><%=imgo.count%></b>)</a><% } %> </span></div></div>        </div>      </div>      </div>      <% }} %>'}});if(!window.mb_quick_reg)window.mb_quick_reg=function(){}})();
/*  |xGv00|f335051665243f40f8856c15c1a1819c */