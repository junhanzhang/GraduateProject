MI.List={listMaxNum:20,listMaxUserNum:200,validate:null,xhr:{},call:null,addCall:function(a){document.location.href="http://list.t.qq.com/list_user.php?lid="+a.createId},editCall:function(){document.location.reload()},delCall:null,url:{add:MI.url.listAdd,edit:MI.url.listEdit,del:MI.url.listDel,follow:MI.url.listFollow,list:MI.url.list,join:MI.url.listJoin,joins:MI.url.listJoins,exit:MI.url.listExit,cnt:MI.url.listCnt},listhost:"http://list.t.qq.com",defaultList:{"名人":0,"有趣用户":0,"好友":0,"同事":0,"同学":0,"家人亲戚":0,"悄悄收听":0},build:function(){var a=this;UI.css(".tbAddList .inputTxt{width:170px; border:1px solid #86A1B4;}\t.tbAddList .inputNum,.tbAddList .tb_tag .inputTxt{width:375px}\t.tbAddList .inputArea{width:375px; height:75px;border:1px solid #86A1B4;}\t.tbAddList{padding:15px 0 10px;line-height:21px}.tbAddList td span{margin-left:5px;vertical-align:top}\t.tbAddList .btn2{margin-right:12px;}\t.tbAddList .tbAddList th{padding:0}\t.tbAddList .viewRight label{cursor:default;position:relative;padding:0 15px 0 0;*top:-2px;_top:0;font-family:Tahoma,Arial;line-height:1.75;color:#333}");a._form=UI.html('<form action="'+a.url.add+'" method="post" id="listForm" onsubmit="return false" style="display:none"><div class="tbAddList"><table border="0" cellspacing="0" cellpadding="0">\t<tbody><tr><th>'+_("名称：")+'</th><td><input type="text" name="name" id="name" class="inputTxt"><p class="cNote">'+_("{0}个中文、字母、数字、下划线或减号","1-13")+"</p></td></tr>\t<tr><th>"+_("描述：")+'</th><td><textarea class="inputArea" name="descrip" id="descrip"></textarea><p class="cNote">'+_("{0}字以内",100)+"</p></td></tr>\t<tr><th>"+_("标签：")+'</th><td class="tb_tag"><input type="text" class="inputTxt" name="listTags" id="listTags"><p class="cNote">'+_("每个标签{0}个字以内，以空格间隔，最多填写{1}个",8,10)+"</p></td></tr>\t<tr><th>"+_("名单权限：")+'</th><td class="viewRight"><p><label for="priv"><input type="radio" checked name="priv" id="priv" value="0" class="check1"><b></b>'+_('公开<span class="cNote">（所有人可见，可订阅）</span>')+'</label></p><p><label for="privB"><input type="radio" name="priv" id="privB" value="1" class="check1"><b></b>'+_('隐私<span class="cNote">（只有我可见，不通知被收录者）</span>')+'</label></p></td></tr>\t<tr><th></th><td><button type="submit" class="btn2">'+_("确定")+'</button><button type="button" class="btn2">'+_("取消")+'</button></td></tr></tbody></table></div><input type="hidden" id="lid" name="lid" /><b></b></form>')[0];a._btn=$$(a._form,"button");a._confirm=a._btn[0];a._cancel=a._btn[1];UI.append(a._form,document.body);a._name=$("name");a._privA=$("priv");a._privB=$("privB");a._descrip=$("descrip");a._tags=$("listTags");a._lid=$("lid");a._cancel.onclick=function(){MI.dialog.hide()};MI.app({Validate:function(){a.validate=new MI.Validate({id:"listForm",inputs:{name:{rule:function(a){var a=UI.trim(a),c=a.length;a.split("");if(0==c)return _("这里一定要填");if(a.match(/[^\u4e00-\u9fa5\w-]/g))return _("仅支持中文、字母、数字、下划线或减号");if(1>c||13<c)return _("仅支持{0}个中文、字母、数字、下划线或减号","1-13")},noIco:!0},descrip:{rule:function(a){if(100<a.length)return _("{0}字以内",100)},noIco:!0},listTags:{rule:function(a){a=UI.trim(a);a.split("");if(a.match(/[^\u4e00-\u9fa5\w\s]/g))return _("仅支持中文、字母、数字")},noIco:!0},lid:{noIco:!0},priv:{noIco:!0}},messages:function(a){return UI.next(a)},success:function(b){a.call&&a.call(b)}})}});a.build=null},listCache:{},listTarget:null,listAccount:null,listDisplay:null,list:function(a,b){var c=this,e,g,d,h;c.listTarget!=a&&c.listHide();c.listTarget=a;c.listAccount=b;if(!c._list){var f='<div class="listFun"><ul></ul><div class="newList"><a href="#">'+_("创建名单")+"</a></div></div>";MI.user.fun.wideStyle&&(f='<div class="w_drop w_drop2">                    <div class="w_drop_b">                        <ul class="lst_drop">                        </ul>                        <div class="more newList"><a href="#">创建名单</a></div>                    </div>                </div>');c._list=UI.html(f)[0];c._listCont=$$(c._list,"ul")[0];c._listNew=$$(c._list,".newList a")[0];c._listNew.onclick=function(){c.listHide();c.add();c.call=function(a){MI.dialog.hide();for(var b in c.listCache){var d={};d[a.createId]={name:c._name.value,inlist:!1};for(var e in c.listCache[b].info)d[e]=c.listCache[b].info[e];c.listCache[b].info=d}c.listShow();a=$$(c._listCont,"input")[0];a.checked=!0;a.onclick()};MI.Bos("btnListAddInList");return!1};c._list.onclick=function(a){UI.E(a).stop()}}UI.hasClass(a,"open")?c.listHide():c.listCache[b]?c.listShow(c.listCache[b]):(e=+new Date,MI.ajax({url:c.url.list,type:"get",data:"account="+b+"&r="+MI.random(),success:function(a){g=+new Date-e;a=MI.json(a);0==a.result&&(c.listCache[b]=a,c.listShow(a));d=+new Date-e;setTimeout(function(){h=+new Date-e;MI.Speed("t_asyn_listbtn",1,g,d,h)},0)}}))},listFollowCss:0,listFollowReset:function(){this.listFollowCss||(UI.css(".foedSets{width:"+("en_US"==window.MILang?"400px":"360px")+";padding:20px 10px 8px}.foedSets .foset{width:70px;overflow:hidden;position:relative;margin-top:-44px;float:right}.tbSendMsg .foedSets table{clear:both;}.tbSendMsg .foedSets th{padding-right:3px}.foedSets td{line-height:19px}.foedSets .inputTxt{width:180px}.foedSets .DcreateList .inputTxt{width:218px}.foedSets .funBox{padding-top:10px;text-align:right}.D .foedSets label{position:static;padding:0;color:#333;white-space:nowrap}.Dlist{position:relative;float:left;margin-right:5px}.Dlist .citySel{width:161px;border-color:#ADB6C5}.DmyList{display:none;clear:both;position:absolute;top:20px;left:0;width:190px;padding:5px 0;border:1px solid #ADB6C5;border-top:0;background:#fff}.D .cityDropDis .DmyList{display:block}.D .DmyList label{display:block;width:180px;margin:0 auto;overflow:hidden}.DcreateList{clear:both;width:"+("en_US"==window.MILang?"290px":"250px")+";overflow:hidden;margin-top:10px;padding:8px 10px;border:1px solid #F4E4B4;background:#FFFFE9}.DcreateList label{margin-right:15px}.DcreateList p{padding:2px 0;white-space:nowrap}.DcreateList .btn1{margin:0 10px 0 5em}"),UI.EA(document.body,"click",function(){var a=$$(".foedSets .Dlist")[0];a&&UI.removeClass(a,"cityDropDis")}),this.listFollowCss=1);this.listFollowCreateAuto=0},listFollow:function(a,b){var c=this,b=b||{};c.listFollowReset();MI.ajax({url:c.url.list,type:"get",data:"position=follow&account="+a+"&r="+MI.random(),success:function(e){e=MI.json(e);if(0==e.result){var g=[],d=0,h=[],f;for(f in e.info)g.push('<label for="list_'+f+'" title="'+e.info[f].name+'"><input type="checkbox" id="list_'+f+'" class="check1" value="'+f+'"'+(e.info[f].inlist?' checked inlist="1"':"")+(!e.info[f].inlist&&e.info[f].userNum>=c.listMaxUserNum?' disabled title="'+_("成员数超过上限")+'"':"")+">"+e.info[f].name+(e.info[f].locked?'<em class="ico_slock"></em>':"")+"</label>"),h[e.info[f].name]=1,d++,null!=c.defaultList[e.info[f].name]&&(c.defaultList[e.info[f].name]=1);if(10>=d)for(f in c.defaultList)h[f]||(h[f]=1,g.push('<label for="'+f+'" title="'+f+'"><input type="checkbox" defaultlist="1" id="'+f+'" class="check1" value="'+f+'">'+f+'<em class="ico_slock"></em></label>'));$("foedSets")&&UI.remove($("foedSets"));MI.dialog.show({title:'<h1 class="DmainTit">'+(b.title||_("收听 {0} 成功",e.nick||a))+"</h1>",width:450,start:function(){c.listFollowListTxt()},closeEnd:function(){if(MI.isS&&!b.bkname){var a=parseInt(MI.S("option_iUserCloseCnt_"+MI.user.account));isNaN(a)?a=1:3<a?a=1:a++;MI.S("option_iUserCloseCnt_"+MI.user.account,a)}MI.guest&&(MI.guest.user&&MI.user.fun.wideStyle)&&MI.app({Wide:function(){MI.sidePanel.callPlugin.apply(null,["listenAll"])}})},end:function(){MI.Bos("btnListFollowClose","",0.01);UI.remove($("foedSets"));if(MI.isS&&!b.bkname){var a=parseInt(MI.S("option_iUserCloseCnt_"+MI.user.account));if(!isNaN(a)&&3==a)return MI.S("option_iUserCloseCnt_"+MI.user.account,0),MI.confirm({title:_("以后不再提示设置备注和名单分组？"),confirm:function(){MI.ajax({url:MI.url.otherSave,type:"post",data:{ft:0}});MI.dialog.hide();MI.guest&&(MI.guest.user&&MI.user.fun.wideStyle)&&MI.app({Wide:function(){MI.sidePanel.callPlugin.apply(null,["listenAll"])}})}}),!1}MI.guest&&(MI.guest.user&&MI.user.fun.wideStyle)&&MI.app({Wide:function(){MI.sidePanel.callPlugin.apply(null,["listenAll"])}})},html:'<div class="foedSets" id="foedSets">'+(b.foset||'<div class="foset">[<a href="http://p.t.qq.com/setting/others#co" target="_blank" onclick="MI.Bos(\'btnListFollowSet\')">'+_("收听设置")+"</a>]</div>")+'<table border="0" cellspacing="0" cellpadding="0"><tbody>'+(b.bkname||"<tr><th>"+_("填写备注姓名：")+'</th><td><form action="/404'+c.url.joins+'" method="post" id="listFollowSaveForm" onsubmit="return false">\t<span><input type="text" class="inputTxt" value="" name="bkName" id="bkName"><br><span></span></span></form>\t</td></tr>')+"<tr><th>"+_("选择名单分组：")+'</th><td><div class="Dlist">\t<a href="#" class="citySel"><span></span></a>\t<div class="DmyList">'+g.join("")+"</div></div>"+(d<c.listMaxNum?'<a href="#" onclick="MI.List.listFollowCreate();return false">'+_("新建名单")+"</a>":"")+'<div class="DcreateList" style="display:none">\t<form action="'+c.url.add+'" method="post" id="listFollowForm" onsubmit="return false"><p><span><input type="text" id="name" name="name" class="inputTxt"></span><br><span></span></p><p>'+_("浏览权限：")+'<label><input type="radio" class="check1" id="priv" name="priv" value="0" checked>'+_("所有人可见")+'</label><label><input type="radio" class="check1" name="priv" id="privB" value="1">'+_("仅自己可见")+'</label><span></span></p><p><button class="btn1" type="submit">'+_("创建")+'</button><a href="#" onclick="MI.List.listFollowCreateCancel();return false">'+_("取消")+'</a></p>\t</form></div>\t</td></tr>\t<tr><th></th><td class="funBox">'+(b.bkname||'<div class="left" style="position: relative; left: -87px; top: 3px;"><label><input type="checkbox" id="idUserCanelFunBox" class="check1" onclick="MI.Bos(\'btnListCancelTips\')">'+_("不再弹出")+"</label></div>")+'<button class="btn1" onclick="'+(b.bkname||"if(MI.isS){if($('idUserCanelFunBox').checked){MI.ajax({url:MI.url.otherSave,type:'post',data:{ft:0}});}MI.S('option_iUserCloseCnt_' + MI.user.account, 0);}")+"MI.List.listFollowSave('"+a+"')\">"+_("完成")+"</button></td></tr></tbody></table></div>"});$$(".foedSets .Dlist a")[0].onclick=function(a){UI.toggleClass(this.parentNode,"cityDropDis");UI.E(a).stop();return!1};$$(".foedSets .DmyList")[0].onclick=function(a){c.listFollowListTxt();UI.E(a).stop()};MI.app({Validate:function(){c.followValidate=new MI.Validate({id:"listFollowForm",inputs:{name:{rule:function(a){var a=UI.trim(a),b=a.split(",");if(b.length>c.defaultList.length)return _("仅支持中文、字母、数字、下划线或减号");for(var d in b){var a=b[d],e=MI.string.length(a);a.split("");if(a.match(/[^\u4e00-\u9fa5\w-\s]/g))return _("仅支持中文、字母、数字、下划线或减号");if(1>e||26<e)return _("仅支持{0}个中文、字母、数字、下划线或减号","1-13")}},noIco:!0},priv:{noIco:!0}},messages:function(a){return a.parentNode.parentNode.lastChild},success:function(b){b.locked=$("priv").checked?0:1;c.listFollowCreateSave(b);c.listFollowListTxt();c.listFollowCreateAuto&&c.listFollowSave(a)}});new MI.Validate({id:"listFollowSaveForm",inputs:{bkName:{rule:function(a){var b=a.length;a.split("");if(a.match(/[^\u4e00-\u9fa5\w-]/g))return _("仅支持中文、字母、数字、下划线或减号");if(12<b)return _("仅支持{0}个中文、字母、数字、下划线或减号","1-12")},noIco:!0}},messages:function(a){return a.parentNode.lastChild},success:function(){}})}});MI.Bos("btnListFollowShow","",0.01)}}})},listFollowListTxt:function(){var a=[],b=$$(".foedSets .DmyList input");UI.each(b,function(b){b.checked&&a.push("<em>"+UI.text(b.parentNode)+"</em>")});$$(".foedSets .Dlist a")[0].innerHTML=(a.length?a.join(","):"")+"<span></span>"},listFollowSaveCall:null,listFollowSave:function(a){var b=this,c=$("foedSets"),e=$$(c,".DmyList label input"),g=[],d=[],h="";$("bkName")&&(h=$("bkName").value);var f=[],i;for(i in e)e[i].checked&&0==b.defaultList[e[i].value]&&f.push(e[i].value);0<f.length?(e=f.join(","),$("name").value=e,$("priv").checked=!1,$("privB").checked=!0,b.listFollowCreateAuto=1,$$(c,".DcreateList button")[0].click()):"none"!=$$(c,".DcreateList")[0].style.display?(b.listFollowCreateAuto=1,$$(c,".DcreateList button")[0].click()):(UI.each(e,function(a){a.checked?g.push(a.value):UI.A(a,"inlist")&&d.push(a.value)}),g.length||d.length||h?(MI.ajax({url:b.url.joins,data:{lids:g.join(","),exits:d.join(","),bkName:h,account:a},success:function(){b.listFollowSaveCall&&b.listFollowSaveCall(a);MI.tip(_("保存成功"))}}),b.listCache[b.listAccount]&&(b.listCache[b.listAccount].info[id].inlist=!0)):MI.dialog.hide(),MI.Bos("btnListFollowSave","",0.01))},listFollowCreate:function(){var a=$("foedSets"),b=UI.prev($$(a,".DcreateList")[0]);$$(a,".DcreateList input");UI.show(UI.next(b));MI.Bos("btnListFollowCreate")},listFollowCreateAuto:0,listFollowCreateCancel:function(){var a=$("foedSets"),b=$$(a,".DcreateList a")[0],a=$$(a,".DcreateList .error")[0],c=$("priv");UI.hide(b.parentNode.parentNode.parentNode);a&&(a.innerHTML="");c&&c.click();MI.Bos("btnListFollowCreateCancel")},listFollowCreateSave:function(a){var b=$("foedSets"),c=$$(b,".DcreateList a")[0],e=$("priv"),c=c.parentNode.parentNode.parentNode,g=$$(b,".DmyList")[0],d=$("name").value;if(g)if($("name").value="","object"==typeof a.createId){var h=d.split(","),f;for(f in h)if(d=h[f],null!=this.defaultList[d])for(f in labelArr=$$(b,".DmyList label"),labelArr){if(labelArr[f].title==d){labelArr[f].innerHTML='<input type="checkbox" id="list_'+a.createId[d]+'" class="check1" checked value="'+a.createId[d]+'">'+d+(a.locked?'<em class="ico_slock"></em>':"");UI.A(labelArr[f],"for","list_"+a.createId[d]);this.defaultList[d]=1;break}}else UI.prepend(UI.html('<label for="list_'+a.createId[d]+'" title="'+d+'"><input type="checkbox" id="list_'+a.createId[d]+'" class="check1" checked value="'+a.createId[d]+'">'+d+(a.locked?'<em class="ico_slock"></em>':"")+"</label>")[0],g)}else if(null!=this.defaultList[d])for(f in labelArr=$$(b,".DmyList label"),labelArr){if(labelArr[f].title==d){labelArr[f].innerHTML='<input type="checkbox" id="list_'+a.createId+'" class="check1" checked value="'+a.createId+'">'+d+(a.locked?'<em class="ico_slock"></em>':"");UI.A(labelArr[f],"for","list_"+a.createId);this.defaultList[d]=1;break}}else UI.prepend(UI.html('<label for="list_'+a.createId+'" title="'+d+'"><input type="checkbox" id="list_'+a.createId+'" class="check1" checked value="'+a.createId+'">'+d+(a.locked?'<em class="ico_slock"></em>':"")+"</label>")[0],g);UI.hide(c);g.childNodes.length>=this.listMaxNum&&UI.hide($$(b,".DcreateList a")[0]);e&&e.click();MI.Bos("btnListFollowCreateSave")},listJoin:function(a,b,c,e){MI.ajax({url:this.url.join,data:{lid:a,accounts:b},success:c});this.listCache[this.listAccount]&&this.listCache[this.listAccount].info[a]?this.listCache[this.listAccount].info[a].inlist=!0:e&&(this.listCache[this.listAccount].info[a]={inlist:!0,locked:1,name:e,userNum:"1"});MI.Bos("btnListJoin")},listExit:function(a,b,c){MI.ajax({url:this.url.exit,data:{lid:a,accounts:b},success:c});this.listCache[this.listAccount]&&this.listCache[this.listAccount].info[a]&&(this.listCache[this.listAccount].info[a].inlist=!1);MI.Bos("btnListExit")},listExitHis:function(a,b){var c=this,a=a?MI.string.cut(a,6):"";MI.confirm({type:"error",title:_("确定要退出“{0}”名单吗？",a),content:_("退出后将减少你被他人发现和收听的几率哦"),confirm:function(){c.listExit(b,MI.user.account,function(a){a=MI.json(a);0==a.result?(MI.Bos("btnListSelfExit"),MI.tip(_("退出成功"),function(){document.location.reload()})):a.msg&&MI.alert(a.msg)})}})},listShow:function(a){var b=this,a=a||b.listCache[b.listAccount],c=[],e=0,g=0,d=[],h;for(h in a.info)c.push('<li><label for="list_'+h+'" title="'+a.info[h].name+'"><input type="checkbox"'+(a.info[h].inlist?" checked":"")+' name="inputlist" id="list_'+h+'" class="check1" value="'+h+'">'+MI.string.cut(a.info[h].name,14)+(a.info[h].locked?'<em class="ico_slock"></em>':"")+"</label></li>"),d[a.info[h].name]=1,e++;g=e;10>=e&&(UI.each(b.defaultList,function(a,b){d[b]||(d[b]=1,c.push('<li><label for="'+g+'" title="'+b+'"><input type="checkbox"  name="inputlist" id="'+g+'" class="check1 noid" value="'+g+'">'+MI.string.cut(b,14)+'<em class="ico_slock"></em></label></li>'),g++)}),e=g);b._listCont.innerHTML=c.join("");b._listCont.style.cssText=11<e?"white-space:nowrap;overflow:auto;overflow-x:hidden;height:250px":"";UI.each($$(b._listCont,"input"),function(a){a.onclick=function(){function a(c){c=MI.json(c);h=1;UI.removeClass(g.parentNode,"loading");if(c.result!=0){MI.alert(c.msg);b.listCache[b.listAccount].info[e].inlist=!b.listCache[b.listAccount].info[e].inlist}}var c=this,d=c.parentNode,e=this.value,f=b.listAccount,g,h;UI.addClass(d,"loading");setTimeout(function(){h&&UI.removeClass(d,"loading")},400);this.checked?UI.hasClass(c,"noid")?MI.ajax({url:b.url.add,data:{name:d.title,priv:1},success:function(g){data_create=MI.json(g);if(data_create.result==0){c.value=data_create.createId;e=c.value;UI.removeClass(c,"noid");b.listJoin(e,f,a,d.title)}}}):b.listJoin(e,f,a):b.listExit(e,f,a);g=c}});e>=b.listMaxNum?UI.hide(b._listNew.parentNode):UI.show(b._listNew.parentNode);UI.toggleClass(b.listTarget,"open");UI.toggleClass(b.listTarget.parentNode,"open");UI.after(b._list,b.listTarget);b.listDisplay=1;MI.Bos("btnListButton")},listHide:function(){this.listDisplay&&(UI.removeClass(this.listTarget,"open"),UI.removeClass(this.listTarget.parentNode,"open"),UI.remove(this._list),this.listDisplay=0)},tmpl:{addrss:'<a href="#" isdel="0" onclick="MI.List.follow(\'<%=lid%>\',this);return false" class="gb_btn gb_btn3 btn_add_rss"><i class="icon icon_fo2"></i><span class="t">立即订阅</span></a>',delrss:'<span class="gb_foed gb_fo1 foed_cancel_rss"><i class="icon icon_sfo"></i><span class="t">已订阅,<a href="#" isdel="1" onclick="MI.List.follow(\'<%=lid%>\',this);return false">取消</a></span></span>'},follow:function(a,b,c,e){var g=this;if(!b.sending){var d,h,f;UI.A(b,"isdel")?(d=UI.A(b,"isdel"),h=1==d?"2":"1",f=!1):(h=(d=UI.hasClass(b,"btn_delRss"))?"2":"1",f=!0);MI.ajax({url:g.url.follow,data:{lid:a,type:h,r:MI.random()},success:function(h){h=MI.json(h);if(h.result==0){if(f){b.className=d?"btn_addRss":"btn_delRss";b.value=d?_("订阅名单"):_("取消订阅")}else if(d==1){var j=UI.parent(UI.parent(b));if(c)UI.animate(j,"opacity",0,function(){UI.remove(j.parentNode.parentNode.parentNode)});else{UI.after(UI.html((new UI.tmplString(g.tmpl.addrss))({lid:a}))[0],j);UI.remove(j)}}else{UI.after(UI.html((new UI.tmplString(g.tmpl.delrss))({lid:a}))[0],b);UI.remove(b)}MI.countNum($("listListenNum_"+a),d==1?-1:1);e&&e(!d)}else try{parent.MI&&parent.MI.alert?parent.MI.alert(h.msg):MI.alert(h.msg)}catch(k){}b.sending=0}})}b.sending=1;MI.Bos("btnListFollow")},share:function(a,b,c,e){var g=1===c?parent.MI:MI,c=function(){g.ajax({url:g.url.listCnt,type:"post",data:{lid:a},success:function(){}})};1==(e&&UI.A(e,"nomember"))?MI.alert("名单还没有成员，暂时不支持分享。"):(g.talk(_("分享这个名单"),_("#分享名单#刚刚发现一个叫“"+b+"”的名单，里面有很多有趣的人和他们发的广播，推荐给大家看看"+this.listhost+"/list/"+a),80,{},c),g.talk.reply.talkBox.data={listid:a},g.Bos("btnShareList"))},memberItemSelect:null,member:function(a,b){var c=this;if(!c._memberForm){c._memberForm=UI.html('<div class="pop_chs_wrap"><h3 class="pop_chs_top">'+_("选择要添加到该名单的用户")+'<span class="cNote">（'+_("一次最多添加{0}人",20)+'）</span></h3><div class="gb_chsuser"></div><div class="pop_cont_bottom">\t<span class="text_error"></span>\t<a class="gb_btn gb_btn2" href="#"><span class="t">'+_("完成")+'</span></a>\t<a class="gb_btn gb_btn6" href="#"><span class="t">'+_("取消")+"</span></a></div>\t</div>")[0];var e=$$(c._memberForm,".gb_chsuser")[0],g=$$(c._memberForm,".text_error")[0],d=$$(c._memberForm,".gb_btn2")[0],h=$$(c._memberForm,".gb_btn6")[0],f;d.onclick=function(){if(f){var b=f.memeberResult();0==b.result&&b.info&&c.listJoin(a,b.info.member.join(","),function(){MI.tip(_("添加成功！"));document.location.reload()})}return!1};h.onclick=function(){MI.dialog.hide();f&&f.memberReset();return!1};MI.app({ItemSelect:function(){f=new MI.ItemSelectMember({target:e,type:1,tips:g});c.memberItemSelect=f}})}MI.dialog.show({title:'<h1 class="DmainTit">'+b+"</h1>",html:c._memberForm,width:500,end:function(){c.memberItemSelect&&c.memberItemSelect.memberReset()}})},add:function(){var a=this;a.build&&a.build();a._name.value=a._descrip.value=a._tags.value=a._lid.value="";a._confirm.innerHTML=_("确定");a._privA.checked=!0;UI.A(a._form,"action",a.url.add);a.validate&&a.validate.clearMessage();a.call=a.addCall;MI.dialog.show({title:'<h1 class="DmainTit">'+_("创建名单")+"</h1>",html:a._form,width:500});setTimeout(function(){a._name.focus()},0);MI.Bos("btnListAdd")},edit:function(a,b,c,e,g){var d=this;d.build&&d.build();d._name.value=b;d._descrip.value=c;d._tags.value=g||"";d._lid.value=a;d._confirm.innerHTML=_("确定");UI.A(d._form,"action",d.url.edit);d.validate&&d.validate.clearMessage();d.call=d.editCall;MI.dialog.show({title:'<h1 class="DmainTit">'+_("编辑名单")+"</h1>",html:d._form,width:500});1==e?d._privB.checked=!0:d._privA.checked=!0;setTimeout(function(){MI.focus(d._name)},0);MI.Bos("btnListEdit")},del:function(a){var b=this,c=$(a);MI.confirm({type:"error",title:_("确定要删除吗？"),content:_("删除名单后将不可恢复"),confirmTxt:_("确定"),confirm:function(){MI.ajax({url:b.url.del,data:{lid:a,r:MI.random()},success:function(a){a=MI.json(a);0==a.result&&(MI.dialog.hide(),c&&UI.animate(c,"opacity",0,function(){UI.remove(c);$("pageNav")&&MI.bottom("pageNav")}),b.delCall&&b.delCall())}})},cancelTxt:_("取消"),cancel:function(){}});MI.Bos("btnListDel")}};/*  |xGv00|40a36897f7ac16ac95d342a118c7c64e */