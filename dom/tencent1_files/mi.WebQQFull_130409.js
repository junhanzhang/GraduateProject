(function(){"undefined"==typeof webq&&(webq={});var g=webq.framework={},f=g.dom={},o=g.string={},m=g.event={},k=g.func={},o=g.string={};g.model={};g.view={};g.controller={};g.collection={};f.id=function(c){return document.getElementById(c)};f.hasClass=function(c,a){return RegExp("(^|\\s)"+a+"(\\s|$)").test(c.className)};f.addClass=function(c,a){f.hasClass(c,a)||(c.className=c.className+" "+a)};f.removeClass=function(c,a){c.className=c.className.replace(RegExp("(^|\\s)"+a+"(?:\\s|$)"),"$1")};f.getElementsByClassName=function(c,a,b){if(3!=arguments.length)alert("Be careful with it...");else{for(var h=c.getElementsByTagName(a),i=[],d=0,e=h.length;d<e;d++)f.hasClass(h[d],b)&&i.push(h[d]);return i}};var n=function(){return"CSS1Compat"===document.compatMode?document.documentElement:document.body};f.getClientWidth=function(c){c=c||n();return c.getClientWidth};_findPapa=function(c,a){var b=4,h=a.substr(1),i;i={"#":function(a,b){return a.id==b},".":function(a,b){return f.hasClass(a,b)}}[a.charAt(0)];return function(){return i(c,h)?c:0<b?(b--,c.parentNode?c=c.parentNode:b=0,arguments.callee()):null}};f.superFindPapa=_findPapa;f.findPapa=function(){var c=4;return function(a,b){return f.hasClass(a,b)?a:0<c?(c--,arguments.callee(a.parentNode,b)):null}};f.node=function(c,a,b){var h,i=(b||window).document.createElement(c);for(h in a)if(c={"class":function(){i.className=a[h]},style:function(){i.style.cssText=a[h]}},c[h])c[h]();else i.setAttribute(h,a[h]);return i};f.hide=function(c){"string"==typeof c?f.id(c).style.display="none":c.style.display="none"};f.show=function(c){"string"==typeof c?f.id(c).style.display="block":c.style.display="block"};var j,n=function(){return j?j:j="CSS1Compat"===document.compatMode?document.documentElement:document.body};f.getClientHeight=function(c){c=c||n();return c.clientHeight};f.getClientWidth=function(c){c=c||n();return c.clientWidth};f.getOffsetHeight=function(c){c=c||n();return c.offsetHeight};f.getOffsetWidth=function(c){c=c||n();return c.offsetWidth};f.getClientXY=function(c){var a=0,b=0;if(c)if(document.documentElement.getBoundingClientRect&&c.getBoundingClientRect){b={left:0,top:0,right:0,bottom:0};try{b=c.getBoundingClientRect()}catch(h){return[0,0]}var c=c.ownerDocument,a=b.top-0,i;i=c?c.scrollTop:Math.max(document.documentElement.scrollTop,document.body.scrollTop);a+=i||0;b=b.left-0;c=c?c.scrollLeft:Math.max(document.documentElement.scrollLeft,document.body.scrollLeft);b+=c||0}else for(;c.offsetParent;)a+=c.offsetTop,b+=c.offsetLeft,c=c.offsetParent;return[b,a]};webq.framework.cookie={set:function(c,a,b,h,i){if(i){var d=new Date;d.setTime((new Date).getTime()+36E5*i)}window.document.cookie=c+"="+a+"; "+(i?"expires="+d.toGMTString()+"; ":"")+(h?"path="+h+"; ":"path=/; ")+(b?"domain="+b+";":"domain="+domainPrefix+";");return!0},get:function(c){c=window.document.cookie.match(RegExp("(?:^|;+|\\s+)"+c+"=([^;]*)"));return!c?"":c[1]},remove:function(c,a,b){window.document.cookie=c+"=; expires=Mon, 26 Jul 1997 05:00:00 GMT; "+(b?"path="+b+"; ":"path=/; ")+(a?"domain="+a+";":"domain="+domainPrefix+";")}};o.encodeHtmlSimple=function(c){c=c.replace(/&/g,"&amp;");c=c.replace(/>/g,"&gt;");c=c.replace(/</g,"&lt;");c=c.replace(/"/g,"&quot;");return c=c.replace(/'/g,"&#39;")};o.obj2queryString=function(c){var a=[],b,h;for(h in c)b=c[h],a.push(encodeURIComponent(String(h))+"="+encodeURIComponent(String(b)));return a.join("&")};var e={};"use strict";(function(){function c(a){h.lastIndex=0;return h.test(a)?'"'+a.replace(h,function(a){var b=f[a];return"string"===typeof b?b:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'}function a(b,h){var e,f,q,u,v=i,j,l=h[b];l&&("object"===typeof l&&"function"===typeof l.toJSON)&&(l=l.toJSON(b));"function"===typeof g&&(l=g.call(h,b,l));switch(typeof l){case "string":return c(l);case "number":return isFinite(l)?String(l):"null";case "boolean":case "null":return String(l);case "object":if(!l)return"null";i+=d;j=[];if("[object Array]"===Object.prototype.toString.apply(l)){u=l.length;for(e=0;e<u;e+=1)j[e]=a(e,l)||"null";q=0===j.length?"[]":i?"[\n"+i+j.join(",\n"+i)+"\n"+v+"]":"["+j.join(",")+"]";i=v;return q}if(g&&"object"===typeof g){u=g.length;for(e=0;e<u;e+=1)f=g[e],"string"===typeof f&&(q=a(f,l))&&j.push(c(f)+(i?": ":":")+q)}else for(f in l)Object.hasOwnProperty.call(l,f)&&(q=a(f,l))&&j.push(c(f)+(i?": ":":")+q);q=0===j.length?"{}":i?"{\n"+i+j.join(",\n"+i)+"\n"+v+"}":"{"+j.join(",")+"}";i=v;return q}}var b=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,h=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,i,d,f={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},g;"function"!==typeof e.stringify&&(e.stringify=function(b,c,h){var e;d=i="";if("number"===typeof h)for(e=0;e<h;e+=1)d+=" ";else"string"===typeof h&&(d=h);if((g=c)&&"function"!==typeof c&&("object"!==typeof c||"number"!==typeof c.length))throw Error("JSON.stringify");return a("",{"":b})});"function"!==typeof e.parse&&(e.parse=function(a,c){function h(a,b){var i,d,e=a[b];if(e&&typeof e==="object")for(i in e)if(Object.hasOwnProperty.call(e,i)){d=h(e,i);d!==void 0?e[i]=d:delete e[i]}return c.call(a,b,e)}var i;b.lastIndex=0;b.test(a)&&(a=a.replace(b,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)}));if(/^[\],:{}\s]*$/.test(a.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){i=eval("("+a+")");return typeof c==="function"?h({"":i},""):i}throw new SyntaxError("JSON.parse");})})();g.json=e;k.toggle=function(c,a,b){var h=0,i=function(){h?a():c();h=!h};i.reset=b?function(){a();h=0}:function(){h=0};return i};k.each=function(c,a){var b,h;for(h in c)if(c.hasOwnProperty(h)&&(b=a(h,c[h],c)))return b};fx=function(c,a,b){this.time=c=Math.floor(1E3/c);this.func=a;fx._intervals[c]?fx._funcs[c].push(a):(fx._funcs[c]=[],fx._funcs[c].push(a),fx._intervals[c]=setInterval(this._run(c),c));b&&(fx._ids[b]=fx._ids[b]||[],fx._ids[b].push([c,a]))};fx._ids={};fx._intervals={};fx._funcs={};fx.prototype={_run:function(c){return function(){for(var a=fx._funcs[c],b=a.length-1;0<=b;b--)a[b]()}},_addFunc:function(c,a){fx._funcs[c]=fx._funcs[c]||[];fx._funcs[c].push(a)},_removeFunc:function(c,a){for(var b=fx._funcs[c],h=b.length-1;0<=h;h--)if(b[h]==a){b.splice(h,1);break}0==b.length&&(clearInterval(fx._intervals[c]),delete fx._intervals[c]);a.reset&&a.reset()},stop:function(c){if(c){if(fx._ids[c]){for(var a=0;a<fx._ids[c].length;a++)this._removeFunc(fx._ids[c][a][0],fx._ids[c][a][1]);delete fx._ids[c]}}else this._removeFunc(this.time,this.func)}};k.fx=fx;k.arrayIndexOf=function(c,a,b){var h=c.length,b=Number(b)||0,b=0>b?Math.ceil(b):Math.floor(b);for(0>b&&(b+=h);b<h;b++)if(b in c&&c[b]===a)return b;return-1};if(document.addEventListener)var l=function(c,a,b){var h=!1;c||J.out("targetModel undefined:"+a+b);c._eventTypes||(c._eventTypes={});c._eventTypes[a]||(c._eventTypes[a]=[]);c.addEventListener(a,b,!1);c=c._eventTypes[a];for(a=0;a<c.length;a++)c[a]==b&&(h=!0);h||c.push(b)},s=function(c,a,b){if(a)if(b){if(c.removeEventListener(a,b,!1),c._eventTypes&&c._eventTypes[a])for(var h=c._eventTypes[a],i=0;i<h.length;i++)if(h[i]===b){h[i]=null;h.splice(i,1);break}}else{if(c._eventTypes&&c._eventTypes[a]){h=c._eventTypes[a];for(i=0;i<h.length;i++)c.removeEventListener(a,h[i],!1);c._eventTypes[a]=[]}}else if(c._eventTypes){var a=c._eventTypes,d;for(d in a){h=c._eventTypes[d];for(i=0;i<h.length;i++)c.removeEventListener(d,h[i],!1)}}};else document.attachEvent&&(l=function(c,a,b){if(-1==m._find(arguments)){var h=function(a){a||(a=window.event);a={_event:a,type:a.type,target:a.srcElement,currentTarget:c,relatedTarget:a.fromElement?a.fromElement:a.toElement,eventPhase:a.srcElement==c?2:3,clientX:a.clientX,clientY:a.clientY,screenX:a.screenX,screenY:a.screenY,layerX:a.offsetX,layerY:a.offsetY,pageX:a.clientX+document.body.scrollLeft,pageY:a.clientY+document.body.scrollTop,altKey:a.altKey,ctrlKey:a.ctrlKey,shiftKey:a.shiftKey,charCode:a.keyCode,keyCode:a.keyCode,stopPropagation:function(){this._event.cancelBubble=true},preventDefault:function(){this._event.returnValue=false}};Function.prototype.call?b.call(c,a):(c._currentHandler=b,c._currentHandler(a),c._currentHandler=null)};c.attachEvent("on"+a,h);var h={element:c,eventType:a,handler:b,wrappedEvent:h},i=(c.document||c).parentWindow,d=m._uid();i._allHandlers||(i._allHandlers={});i._allHandlers[d]=h;c._handlers||(c._handlers=[]);c._handlers.push(d);i._onunloadEventRegistered||(i._onunloadEventRegistered=!0,i.attachEvent("onunload",m._removeAllEvents))}},s=function(c,a,b){var h=m._find(arguments);if(-1!=h){for(var i=(c.document||c).parentWindow,d=0;d<h.length;d++){var e=h[d],f=c._handlers[e],g=i._allHandlers[f];c.detachEvent("on"+g.eventType,g.wrappedEvent);c._handlers[e]=null;c._handlers.splice(e,1);delete i._allHandlers[f]}c._handlers&&0==c._handlers.length&&(c._handlers=null)}},m._find=function(c){var a=c[0],b=c[1],h=c[2],i=a._handlers;if(!i)return-1;var a=(a.document||a).parentWindow,d=[];if(3===c.length)for(c=i.length-1;0<=c;c--){var e=i[c],e=a._allHandlers[e];if(e.eventType==b&&e.handler==h)return d.push(c),d}else if(2===c.length){for(c=i.length-1;0<=c;c--)e=i[c],e=a._allHandlers[e],e.eventType==b&&d.push(c);if(0<d.length)return d}else if(1===c.length){for(c=i.length-1;0<=c;c--)d.push(c);if(0<d.length)return d}return-1},m._removeAllEvents=function(){for(var c in this._allHandlers){var a=this._allHandlers[c];a.element.detachEvent("on"+a.eventType,a.wrappedEvent);a.element._handlers=null;delete this._allHandlers[c]}},m._counter=0,m._uid=function(){return"h"+m._counter++});m.off=s;m.on=l;var p={};o.template=function a(b,h){var i=!/\W/.test(b)?p[b]=p[b]||a(document.getElementById(b).innerHTML):new Function("obj","var p=[],print=function(){p.push.apply(p,arguments);};with(obj){p.push('"+b.replace(/[\r\t\n]/g," ").split("<%").join("\t").replace(/((^|%>)[^\t]*)'/g,"$1\r").replace(/\t=(.*?)%>/g,"',$1,'").split("\t").join("');").split("%>").join("p.push('").split("\r").join("\\'")+"');}return p.join('');");return h?i(h):i};var d=function(){};d.prototype={bind:function(a,b){this._events=this._events||{};this._events[a]=this._events[a]||[];this._events[a].push(b)},unbind:function(a,b){this._events=this._events||{};!1!==a in this._events&&this._events[a].splice(k.arrayIndexOf(this._events[a],b),1)},trigger:function(a){this._events=this._events||{};if(!1!==a in this._events)for(var b=0;b<this._events[a].length;b++)this._events[a][b].apply(this,Array.prototype.slice.call(arguments,1))}};d.mixin=function(a){for(var b=["bind","unbind","trigger"],h=0;h<b.length;h++)a.prototype[b[h]]=d.prototype[b[h]]};g.view=function(a){this.init(a)};g.model=function(a){this.init(a)};g.collection=function(a){this.init(a)};g.controller=function(a){this.init(a)};g.view.eventParser=function(){this.init()};g.view.eventParser.prototype={init:function(){var a=this;this.op=[{"!":function(b,h,i){for(var b=b.split(","),d=b.length-1;0<=d;d--)if(a.match(b[d],h,i))return!1;return!0}},{".":function(a,h,i){return i.target.className==a},"#":function(a,h,i){return i.target.id==a},".~":function(a,h,i){return f.hasClass(i.target,a)},"..#":function(a,h,i){return _findPapa(i.target,"#"+a)()},"...":function(a,h,i){return _findPapa(i.target,"."+a)()}},{">":function(b,h,i,d){var e;e=b.split(">");b=e[0];e=e[1];return("*"==e||a.match(e,h,i))&&(d=_findPapa(i.target,b)())?[!0,{target:d,stopPropagation:function(){i.stopPropagation()}}]:!1}}];this.op2Level=["!",[".","#",".~","...","..#"],">"]},match:function(a,b,h){var i;if(-1<a.indexOf(this.op2Level[2]))return this.op[2][this.op2Level[2]](a,b,h,i);for(var d=3;0<d;){if((i=this.op[1][a.substr(0,d)])&&i(a.substr(d),b,h))return!0;d--}return!1},router:function(a,b,h,d){if(d=this.op[0][a.charAt(0)]){if(d(a.substr(1),b,h))return!0}else for(var e=a.split(","),d=e.length-1;0<=d;d--)if(a=this.match(e[d],b,h))return a;return!1},parse:function(a,b,h){a=this.router(a,b,h);2==a.length?b(a[1]):a&&b(h)}};g.view.eventParser=new g.view.eventParser;g.view.prototype={init:function(a,b){b&&this.initOption(b);a&&(this._data=a)},initOption:function(a){this.beforeRender=a.beforeRender||this.beforeRender},afterInit:function(){},render:function(){this.target&&"string"==typeof this.target&&(this.target=f.id(this.target));if((this.template||this.html)&&this.target){if(this.template)var a=o.template(this.template,this._data);else this.html&&(a=this.html);if(this.container){this.container;var b=this.container.pop();"function"!=typeof b&&(this.container.push(b),b=null);this.el=f.node.apply(null,this.container);b&&(b(this.el,this),this.container.push(b));this.el.innerHTML=a;this.beforeRender(this.el);this.target.appendChild(this.el)}else this.el=this.target,this.beforeRender(this.el),this.el.innerHTML=a;this.events&&this.initEvents();this.incrId()}else this.target&&this.events&&(this.el=this.target,this.initEvents())},beforeRender:function(){},afterRender:function(){},update:function(a){this._data=a;this.removeEvents();if(this.template&&this.target){a=o.template(this.template,this._data);if(this.container){this.container;var b=this.container.pop();"function"!=typeof b&&(this.container.push(b),b=null);b&&(b(this.el,this),this.container.push(b))}else this.el=this.target;this.beforeRender(this.el);this.el.innerHTML=a;this.events&&this.initEvents()}},hash:{"#":"id",".":"className","@":"el","!":"!"},eventsNotBubble:{"@click":1,blur:1,focus:1,change:1},initEvents:function(){var a={},b=this,h=this.hash,d=this.eventsNotBubble;k.each(this.events,function(h,d){"string"==typeof d&&(d=b.observers[d]);var i=d,d=function(a){Array.prototype.push.call(arguments,b);i.apply(this,arguments)},e=h.split(" "),f=e[0],e=e[1];a[e]=a[e]||[];a[e].push([f,d]);this._events=a});k.each(a,function(a,e){if(d[a])for(var l=e.length-1;0<=l;l--)for(var j=e[l][0].split(","),p=j.length-1;0<=p;p--){var k=h[j[p].charAt(0)];if("id"==k)m.on(f.id(j[p].substr(1)),a,e[l][1]);else if("el"==k)m.on(b.el,a.substr(1),e[l][1])}else m.on(b.el,a,function(a){for(var b=e.length-1;0<=b;b--)g.view.eventParser.parse(e[b][0],e[b][1],a)})})},removeEvents:function(){var a=this,b=this.hash,h=this.eventsNotBubble;k.each(this.events,function(d,e){if(h[d])for(var g=e.length-1;0<=g;g--)for(var l=e[g][0].split(","),j=l.length-1;0<=j;j--)type=b[l[j].split("")[0]],"id"==type?m.off(f.id(l[j].substr(1))):"el"==type&&m.off(a.el)});m.off(a.el)},id:function(a){this._domsCache=this._domsCache||{};return this._domsCache[a]?this._domsCache[a]:this._domsCache[a]=f.id(a)},destory:function(){delete this._domsCache;this.removeEvents();this.el.parentNode.removeChild(this.el)},_id:0,incrId:function(){},getCount:function(){},setId:function(a){this.__id=a},getId:function(){return this.__id},show:function(){this.isShow=!0;f.show(this.el)},hide:function(){this.isShow=!1;f.hide(this.el)}};g.controller.prototype={init:function(){if(this.collection){var a=this;this._hash={};this.collection=new this.collection;this.key=this.collection.key;this.collection.bind("add",function(b,h){a.add(b,h)});this.collection.bind("update",function(b,h){a.update(b,h)});this.collection.bind("remove",function(b){a.remove(b)})}},feed:function(a,b){this.collection.init(a,b)},bite:function(a,b){this.collection.add(a,b)},puke:function(a){this.collection.remove(a)},find:function(a){return this._hash[a]},add:function(a,b){var h=this,d=new this.view(a,b);d.setId(a[this.key]);this._hash[d.getId()]=d;k.each(this.viewObserver,function(a,b){var e=b;d.bind(a,function(){Array.prototype.push.call(arguments,h);e.apply(this,arguments)})});d.afterInit(b);d.render();d.afterRender(b)},update:function(a,b){this.find(a[this.key]).update(a,b)},remove:function(a){this.find(a).destory();delete this._hash[a]}};g.collection.prototype={init:function(a,b){if(a){var h=this;k.each(a,function(a,d){h.add(d,b)})}else this._hash={},this._queue=[]},key:"id",find:function(a){return this._hash[a]},add:function(a,b){if(this._hash[a[this.key]])this.update(a,b);else{var h=new this.model(a),d=h[this.key];this._hash[d]=h;this._queue.push(d);this.trigger("add",h,b)}},update:function(a,b){var d=this.find(a[this.key]);k.each(a,function(a,b){d.setter(a,b)});this.trigger("update",d,b)},getFirst:function(){return this.find(this._queue[0])[this.key]},getLast:function(){return this.find(this._queue[this._queue.length-1])[this.key]},getLength:function(){return this._queue.length},insertBefore:function(a){var b=k.arrayIndexOf(this._queue,a);-1<b&&(this._queue.splice(b,1),this._queue.unshift(a))},remove:function(a){delete this._hash[a];var b=k.arrayIndexOf(this._queue,a);-1<b&&this._queue.splice(b,1);this.trigger("remove",a)},filter:function(a){var b=[];k.each(this._hash,function(d,e){var f=!1;k.each(a,function(a,b){b=b.toLowerCase();-1!=String(e[a]).toLowerCase().indexOf(b)&&(f=!0);return f});f&&b.push(e)});return b},map:function(a){k.each(this._hash,function(b,d){a(b,d)})}};g.model.prototype={init:function(a){var b=this;a&&k.each(a,function(a,d){b.setter(a,d)})},setter:function(a,b){this[a]=this.map(a,b,this);var d=this.xss[a];d&&(this[d]=o.encodeHtmlSimple(b));return this},getter:function(a){return this[a]},xss:{},map:function(a,b){return b},toString:function(){var a={};k.each(this,function(b,d){a[b]=d});return g.json.stringify(a)}};d.mixin(g.view);d.mixin(g.controller);d.mixin(g.collection);d.mixin(g.model);g.controller.extend=g.collection.extend=g.model.extend=g.view.extend=function(a){var b=function(){arguments[0]&&this.init.apply(this,[].slice.call(arguments))},d;d=b.prototype=new this;for(var e in a)if(a.hasOwnProperty(e))if("init"==e){var f=a.init,g=d.init;delete d.init;d.init=function(a){g.call(this,a);f.call(this,a)}}else d[e]=a[e];return d.constructor=b}})();(function(){var g=webq.framework,f=g.dom,o=g.view,m=g.model,k=g.collection,n=g.controller,j=g.func,e=g.event,g=[];webq.module={};webq.CONST={msg_id:0,MAIN_DOMAIN:"qq.com",CLIENTID:String(Math.round(100*Math.random())+(new Date).getTime()%1E6),CONN_SERVER_DOMAIN:"http://t.web2.qq.com/",CONN_PROXY_URL:"http://t.web2.qq.com/proxy.html?v=20110331001",SYSTEM_FACE_URL:"http://mat1.gtimg.com/www/mb/images/face/",DEFAULT_FACE_URL:"http://mat1.gtimg.com/www/mb/css/webqq/images/default_30.jpg",MAX_LOGIN_AMOUNT:1,MAX_FAIL_AMOUNT:2,Z_INDEX_BASE:3E3,LOAD_AVATAR_AMOUNT:50,TRANSFER_TABLE:[14,1,2,3,4,5,6,7,8,9,10,11,12,13,0,50,51,96,53,54,73,74,75,76,77,78,55,56,57,58,79,80,81,82,83,84,85,86,87,88,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,32,113,114,115,63,64,59,33,34,116,36,37,38,91,92,93,29,117,72,45,42,39,62,46,47,71,95,118,119,120,121,122,123,124,27,21,23,25,26,125,126,127,128,129,130,131,132,133,134,52,24,22,20,60,61,89,90,31,94,65,35,66,67,68,69,70,15,16,17,18,19,28,30,40,41,43,44,48,49],T_TRANSFER_TABLE:{14:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,10:10,11:11,12:12,13:13,"0":14,50:15,51:16,96:17,53:18,54:19,73:20,74:21,75:22,76:23,77:24,78:25,55:26,56:27,57:28,58:29,79:30,80:31,81:32,82:33,83:34,84:35,85:36,86:37,87:38,88:39,97:40,98:41,99:42,100:43,101:44,102:45,103:46,104:47,105:48,106:49,107:50,108:51,109:52,110:53,111:54,112:55,32:56,113:57,114:58,115:59,63:60,64:61,59:62,33:63,34:64,116:65,36:66,37:67,38:68,91:69,92:70,93:71,29:72,117:73,72:74,45:75,42:76,39:77,62:78,46:79,47:80,71:81,95:82,118:83,119:84,120:85,121:86,122:87,123:88,124:89,27:90,21:91,23:92,25:93,26:94,125:95,126:96,127:97,128:98,129:99,130:100,131:101,132:102,133:103,134:104,52:105,24:106,22:107,20:108,60:109,61:110,89:111,90:112,31:113,94:114,65:115,35:116,66:117,67:118,68:119,69:120,70:121,15:122,16:123,17:124,18:125,19:126,28:127,30:128,40:129,41:130,43:131,44:132,48:133,49:134},FACE_2_SHORTCUT:"/微笑 /撇嘴 /色 /发呆 /得意 /流泪 /害羞 /闭嘴 /睡 /大哭 /尴尬 /发怒 /调皮 /呲牙 /惊讶 /难过 /酷 /冷汗 /抓狂 /吐 /偷笑 /可爱 /白眼 /傲慢 /饥饿 /困 /惊恐 /流汗 /憨笑 /大兵 /奋斗 /咒骂 /疑问 /嘘... /晕 /折磨 /衰 /骷髅 /敲打 /再见 /擦汗 /抠鼻 /鼓掌 /糗大了 /坏笑 /左哼哼 /右哼哼 /哈欠 /鄙视 /委屈 /快哭了 /阴险 /亲亲 /吓 /可怜 /菜刀 /西瓜 /啤酒 /篮球 /乒乓 /咖啡 /饭 /猪头 /玫瑰 /凋谢 /示爱 /爱心 /心碎 /蛋糕 /闪电 /炸弹 /刀 /足球 /瓢虫 /便便 /月亮 /太阳 /礼物 /拥抱 /强 /弱 /握手 /胜利 /抱拳 /勾引 /拳头 /差劲 /爱你 /NO /OK /爱情 /飞吻 /跳跳 /发抖 /怄火 /转圈 /磕头 /回头 /跳绳 /挥手 /激动 /街舞 /献吻 /左太极 /右太极".split(" "),SHORTCUT_2_FACE:{"/微":{"/微笑":14},"/撇":{"/撇嘴":1},"/色":{"/色":2},"/发":{"/发呆":3,"/发怒":11,"/发抖":41},"/得":{"/得意":4},"/流":{"/流泪":5,"/流汗":27,"/流淚":5},"/害":{"/害羞":6},"/闭":{"/闭嘴":7},"/睡":{"/睡":8},"/大":{"/大哭":9,"/大兵":29},"/尴":{"/尴尬":10},"/调":{"/调皮":12},"/呲":{"/呲牙":13},"/惊":{"/惊讶":0,"/惊恐":26},"/难":{"/难过":15},"/酷":{"/酷":16},"/冷":{"/冷汗":96},"/抓":{"/抓狂":18},"/吐":{"/吐":19},"/偷":{"/偷笑":20},"/可":{"/可爱":21,"/可怜":111,"/可愛":21,"/可憐":111},"/白":{"/白眼":22},"/傲":{"/傲慢":23},"/饥":{"/饥饿":24},"/困":{"/困":25},"/憨":{"/憨笑":28},"/奋":{"/奋斗":30},"/咒":{"/咒骂":31,"/咒罵":31},"/疑":{"/疑问":32,"/疑問":32},"/嘘":{"/嘘...":33},"/晕":{"/晕":34},"/折":{"/折磨":35},"/衰":{"/衰":36},"/骷":{"/骷髅":37,"/骷髏":37},"/敲":{"/敲打":38},"/再":{"/再见":39,"/再見":39},"/擦":{"/擦汗":97},"/抠":{"/抠鼻":98},"/鼓":{"/鼓掌":99},"/糗":{"/糗大了":100},"/坏":{"/坏笑":101},"/左":{"/左哼哼":102,"/左太极":133,"/左太極":133},"/右":{"/右哼哼":103,"/右太极":134,"/右太極":134},"/哈":{"/哈欠":104},"/鄙":{"/鄙视":105,"/鄙視":105},"/委":{"/委屈":106},"/快":{"/快哭了":107},"/阴":{"/阴险":108},"/亲":{"/亲亲":109},"/吓":{"/吓":110},"/菜":{"/菜刀":112},"/西":{"/西瓜":89},"/啤":{"/啤酒":113},"/篮":{"/篮球":114},"/乒":{"/乒乓":115},"/咖":{"/咖啡":60},"/饭":{"/饭":61},"/猪":{"/猪头":46},"/玫":{"/玫瑰":63},"/凋":{"/凋谢":64},"/示":{"/示爱":116,"/示愛":116},"/爱":{"/爱心":66,"/爱你":122,"/爱情":42},"/心":{"/心碎":67},"/蛋":{"/蛋糕":53},"/闪":{"/闪电":54},"/炸":{"/炸弹":55,"/炸彈":55},"/刀":{"/刀":56},"/足":{"/足球":57},"/瓢":{"/瓢虫":117,"/瓢蟲":117},"/便":{"/便便":59},"/月":{"/月亮":75},"/太":{"/太阳":74,"/太陽":74},"/礼":{"/礼物":69},"/拥":{"/拥抱":49},"/强":{"/强":76},"/弱":{"/弱":77},"/握":{"/握手":78},"/胜":{"/胜利":79},"/抱":{"/抱拳":118},"/勾":{"/勾引":119},"/拳":{"/拳头":120,"/拳頭":120},"/差":{"/差劲":121,"/差勁":121},"/N":{"/NO":123},"/O":{"/OK":124},"/飞":{"/飞吻":85},"/跳":{"/跳跳":43,"/跳绳":128,"/跳繩":128},"/怄":{"/怄火":86},"/转":{"/转圈":125},"/磕":{"/磕头":126,"/磕頭":126},"/回":{"/回头":127,"/回頭":127},"/挥":{"/挥手":129},"/激":{"/激动":130,"/激動":130},"/街":{"/街舞":131},"/献":{"/献吻":132},"/發":{"/發呆":3,"/發怒":11,"/發抖":41},"/閉":{"/閉嘴":7},"/尷":{"/尷尬":10},"/調":{"/調皮":12},"/驚":{"/驚訝":0,"/驚恐":26},"/難":{"/難過":15},"/饑":{"/饑餓":24},"/奮":{"/奮鬥":30},"/噓":{"/噓...":33},"/暈":{"/暈":34},"/摳":{"/摳鼻":98},"/壞":{"/壞笑":101},"/陰":{"/陰險":108},"/親":{"/親親":109},"/嚇":{"/嚇":110},"/籃":{"/籃球":114},"/飯":{"/飯":61},"/豬":{"/豬頭":46},"/雕":{"/雕謝":64},"/愛":{"/愛心":66,"/愛你":122,"/愛情":42},"/閃":{"/閃電":54},"/禮":{"/禮物":69},"/擁":{"/擁抱":49},"/強":{"/強":76},"/勝":{"/勝利":79},"/飛":{"/飛吻":85},"/慪":{"/慪火":86},"/轉":{"/轉圈":125},"/揮":{"/揮手":129},"/獻":{"/獻吻":132}}};"undefined"!=typeof MILang&&"zh_TW"==MILang&&(webq.CONST.FACE_2_SHORTCUT="/微笑 /撇嘴 /色 /發呆 /得意 /流淚 /害羞 /閉嘴 /睡 /大哭 /尷尬 /發怒 /調皮 /呲牙 /驚訝 /難過 /酷 /冷汗 /抓狂 /吐 /偷笑 /可愛 /白眼 /傲慢 /饑餓 /困 /驚恐 /流汗 /憨笑 /大兵 /奮鬥 /咒罵 /疑問 /噓... /暈 /折磨 /衰 /骷髏 /敲打 /再見 /擦汗 /摳鼻 /鼓掌 /糗大了 /壞笑 /左哼哼 /右哼哼 /哈欠 /鄙視 /委屈 /快哭了 /陰險 /親親 /嚇 /可憐 /菜刀 /西瓜 /啤酒 /籃球 /乒乓 /咖啡 /飯 /豬頭 /玫瑰 /雕謝 /示愛 /愛心 /心碎 /蛋糕 /閃電 /炸彈 /刀 /足球 /瓢蟲 /便便 /月亮 /太陽 /禮物 /擁抱 /強 /弱 /握手 /勝利 /抱拳 /勾引 /拳頭 /差勁 /愛你 /NO /OK /愛情 /飛吻 /跳跳 /發抖 /慪火 /轉圈 /磕頭 /回頭 /跳繩 /揮手 /激動 /街舞 /獻吻 /左太極 /右太極".split(" "));for(var l=0;105>l;l++)g.push('<div class="EQQ_qqfaces" title="'+webq.CONST.FACE_2_SHORTCUT[l]+'" id="EQQ_qqface_'+l+'" ></div>');var g=g.join(""),g='            <div style="display:none;" class="EQQ_faceSelection" id="EQQ_FaceSelection" style="display:none">                '+g+'            </div>            <div id="EQQ_MainPanel" class="EQQ_mainPanel">                <div class="EQQ_title">                    <div style="display:none;" id="EQQ_CloseButton" class="EQQ_CloseButton" title="'+_("隐藏好友列表")+'">'+_("最小化")+'</div>                    <a href="#"><div id="EQQ_MinButton" class="EQQ_MinButton" title="'+_("最小化")+'">'+_("最小化")+'</div></a>                    <a class="EQQ_FeedbackButton2" href="http://support.qq.com/portal/discuss_pdt/420_1.html" target="_blank">'+_("反馈")+'</a>                    <ul id="EQQ_SettingPanel" class="EQQ_SettingPanel" style="display:none;"><a href="#" onclick="return false;"><li flag="online" class="EQQ_SettingPanel_item" style="margin-top:6px;">                            <div class="EQQ_setIcon EQQ_setOnlineIcon">icon</div>                            <div class="EQQ_SettingPanel_Text">'+_("在线")+'</div>                        </li></a><a href="#" onclick="return false;">                        <li title="'+_("断开服务器连接")+'" flag="offline" class="EQQ_SettingPanel_item">                            <div class="EQQ_setIcon EQQ_setOfflineIcon">icon</div>                            <div class="EQQ_SettingPanel_Text">'+_("离线")+'</div>                        </li></a><a href="#" onclick="return false;">                        <li title="'+_("不接受实时聊天消息")+'" flag="lock" class="EQQ_SettingPanel_item">                            <div class="EQQ_setIcon EQQ_setLockIcon">icon</div>                            <div class="EQQ_SettingPanel_Text">'+_("禁用")+'</div>                        </li></a>                    </ul>\t<a href="#" onclick="return false;">\t                    <div id="EQQ_SettingButton" class="EQQ_settingButton" title="'+_("设置")+'">\t                        <div class="EQQ_settingButtonIcon">'+_("下")+'</div>\t                        <div id="EQQ_settingButtonText" class="EQQ_settingButtonText">'+_("设置")+'</div>\t                    </div>\t</a>                    <div class="EQQ_titleText">'+_("在线互听")+'<span id="EQQ_onlineCount">(0)</span></div>                    <div class="EQQ_betaText" title="1.0.10.12"></div>                </div>                <div style="display:none;" id="EQQ_MyPanel" class="EQQ_myPanel">                    <div class="EQQ_myInfo">                        <div id="EQQ_MyState" class="EQQ_myState" title="'+_("我的状态")+'">                            <div id="EQQ_MyStateShow" class="EQQ_myStateShow EQQ_offline">'+_("状态")+'</div>                            <div class="EQQ_myStateDown">'+_("下")+'</div>                        </div>                        <div id="EQQ_MyNick" class="EQQ_myNick" title="'+_("昵称")+'">'+_("昵称")+'</div>                        <ul id="EQQ_StateSelectPanel" class="EQQ_stateSelectPanel">                            <li id="EQQ_SetOnline" state="online"><div class="EQQ_stateSelect_icon EQQ_online"></div><div class="EQQ_stateSelect_text">'+_("我在线上")+'</div></li>                            <li id="EQQ_SetCallme" state="callme"><div class="EQQ_stateSelect_icon EQQ_callme"></div><div class="EQQ_stateSelect_text">Q'+_("我吧")+'</div></li>                            <li id="EQQ_SetAway" state="away"><div class="EQQ_stateSelect_icon EQQ_away"></div><div class="EQQ_stateSelect_text">'+_("离开")+'</div></li>                            <li id="EQQ_SetBusy" state="busy"><div class="EQQ_stateSelect_icon EQQ_busy"></div><div class="EQQ_stateSelect_text">'+_("忙碌")+'</div></li>                            <li id="EQQ_SetSilent" state="silent"><div class="EQQ_stateSelect_icon EQQ_silent"></div><div class="EQQ_stateSelect_text">'+_("请勿打扰")+'</div></li>                            <li id="EQQ_SetHidden" state="hidden"><div class="EQQ_stateSelect_icon EQQ_hidden"></div><div class="EQQ_stateSelect_text">'+_("隐身")+'</div></li>                            <li id="EQQ_SetOffline" state="offline"><div class="EQQ_stateSelect_icon EQQ_offline"></div><div class="EQQ_stateSelect_text">'+_("离线")+'</div></li>                        </ul>                    </div>                    <div id="EQQ_MySignature" class="EQQ_mySignature" title="'+_("载入中")+'...">'+_("载入中")+'...</div>                </div>                <div id="EQQ_YellowTips" class="EQQ_YellowTips">                    <div id="EQQ_YellowTips_CloseButton" class="EQQ_YellowTips_CloseButton" title="'+_("关闭提示")+'">X</div>                    <a class="EQQ_YellowTips_Link" href="http://survey.qq.com/cgi-bin/submitsurvey?id=2473&qpage=1&page=1&rm=dnN4k1bBG" target="_blank">'+_("邀请参与")+"WebQQ"+_("用户调查")+'</a>                </div>                <div id="EQQ_SearchBar" class="EQQ_SearchBar">                    <input id="EQQ_SearchBox" class="EQQ_SearchBox" name="EQQ_SearchBox" type="text" value="'+_("输入微博帐号")+'..." title="'+_("直接输入微博帐号")+'..." />                    <div id="EQQ_SearchButton" class="EQQ_SearchButton" title="'+_("回车打开会话窗口")+'">'+_("搜索按钮")+'</div>                </div>                <div id="EQQ_SearchResultPanel" class="EQQ_SearchResultPanel">                    <div class="EQQ_SearchResultItem" title="">Kevity1(666666)</div>                    <div class="EQQ_SearchResultItemHover" title="">Kevity2(666666)</div>                    <div class="EQQ_SearchResultItem" title="">Kevity3(66666)</div>                </div>                <div id="EQQ_Logining" class="EQQ_Logining">'+_("登录中")+'...</div>                <div id="EQQ_ReLoginPanel" class="EQQ_ReLoginPanel">            '+_("登录失败")+'，<span id="EQQ_ReLoginButton" class="EQQ_ReLoginButton">'+_("重试")+'</span>                </div>                <\!--                <div id="EQQ_VerifyPanel" class="EQQ_VerifyPanel">                    <div id="EQQ_VerifyText" class="EQQ_VerifyText">'+_("请输入验证码")+'</div>                    <div id="EQQ_VerifyTip" class="EQQ_VerifyTip">'+_("输入验证码有误")+","+_("请重试")+'</div><input type="text" id="EQQ_VerifyInput" class="EQQ_VerifyInput" maxlength=4 />                    <img id="EQQ_VerifyImg" class="EQQ_VerifyImg" src="http://imgcache.qq.com/ac/b.gif" />                    <a id="EQQ_VerifyChange" class="EQQ_VerifyChange" href="#">'+_("换一张")+'</a>                    <div id="EQQ_VerifySummit" class="EQQ_VerifySummit"></div>                </div>                --\>                <div style="display:none;" id="EQQ_BuddyList" class="EQQ_buddyList">\t<div id="EQQ_listClassHead_0" class="EQQ_listClassHeadCollapsed" classIndex="0"><div class="EQQ_listClassHeadIcon">icon</div><div class="EQQ_ClassList_RightContainer" title="">\t&nbsp;[<span id="EQQ_Class_0_OnlineCounter"></span>/<span id="EQQ_Class_0_Counter"></span>]</div>\t</div>\t<div id="EQQ_listClassBody_0" class="EQQ_listClassBody"><div id="EQQ_Class_0_callme" class="EQQ_callmeBuddy"></div><div style="display:block;" id="EQQ_Class_0_online" class="EQQ_onlineBuddy"></div><div id="EQQ_Class_0_busy" class="EQQ_busyBuddy"></div><div id="EQQ_Class_0_away" class="EQQ_awayBuddy"></div><div id="EQQ_Class_0_silent" class="EQQ_silentBuddy"></div><div id="EQQ_Class_0_offline" class="EQQ_offlineBuddy"></div>\t</div>                </div>            </div>            <\!--            <div id="EQQ_MsgBox" class="EQQ_msgBox">                <div class="EQQ_titleInMsgBox">                    <div class="EQQ_titleTextInMsgBox">'+_("消息盒子")+'</div>                    <div id="EQQ_ViewMainPanelButtonInMsgBox" class="EQQ_viewMainPanelButtonInMsgBox" title="'+_("点击查看好友列表")+'">'+_("好友列表")+'</div>                </div>                <div id="EQQ_MessageList" class="EQQ_messageList">                </div>                <div id="EQQ_IgnoreAllMsgButtonInMsgBox" class="EQQ_ignoreAllMsgButtonInMsgBox" title="'+_("点击忽略全部消息")+'">'+_("忽略全部")+'</div>            </div>            <div id="EQQ_LoginBox" class="EQQ_LoginBox">                <div class="EQQ_LoginBox_Title">                    <div id="EQQ_LoginBox_CloseButton" class="EQQ_LoginBox_CloseButton" title="'+_("关闭")+'">X</div>                    <div class="EQQ_LoginBox_TitleText">WebQQ'+_("登录保护")+"</div>                </div>            </div>            --\>    ",l=o.extend({target:"EQQ_Container",container:["div",{"class":"EQQ_global_yellowTips"}],template:'        <div style="width:<%=width+8%>px" class="EQQ_global_yellowTips_content">            <div class="EQQ_global_yellowTips_content_left"></div>            <div style="width:<%=width%>px" class="EQQ_global_yellowTips_content_middle">                <div class="EQQ_global_yellowTips_content_middle_text">                    <%=text%>                </div>                <div class="EQQ_global_yellowTips_content_middle_close">                </div>            </div>            <div class="EQQ_global_yellowTips_content_right"></div>        </div>        <div class="EQQ_global_yellowTips_arrow">^</div>        ',events:{".EQQ_global_yellowTips_content_middle_close click":function(a,b){b.trigger("puke",b.getId())}},resetPosition:function(a){var b=f.getClientWidth(),c=f.getClientHeight(),d=f.getClientXY(a),a=d[1],b=b-(d[0]+parseInt(this.id("EQQ_Container").style.right)+25);this.el.style.right=b-this._data.width+25+"px";this.el.style.bottom=c-a+3+"px"},delayClose:function(a){var b=this;setTimeout(function(){try{b.trigger("puke",b.getId())}catch(a){}},a*1E3)}}),m=m.extend({map:function(a,b,c){if(a=="text"){a=b.replace(/[^\x00-\xff]/g,"aa");c.width=Math.floor(Math.round(a.length/2)*14.5)}return b}}),k=k.extend({model:m,key:"type"}),n=new (n.extend({collection:k,view:l,viewObserver:{puke:function(a,b){b.puke(a)}}}))({}),s=o.extend({target:"EQQ_SearchResultPanel",template:'\t<% for(var i=0;i<results.length;i++) {%><div flag="<%=results[i].id%>" class="EQQ_SearchResultItem" title=""><%=results[i].htmlNick%>(<%=results[i].id%>)</div>\t<% } %>',events:{".EQQ_SearchResultItem click":function(a){a=a.target.getAttribute("flag");a=webq.module.buddyList.collection.find(a);webq.module.taskBar.chat(a);webq.module.chatBox.chat(a)}},arrowDown:function(a){if(!this.isHide){if(this.pointer){this.pointer[0][this.pointer[1]].className="EQQ_SearchResultItem";a?this.pointer[1]--:this.pointer[1]++;this.pointer[1]=(this.pointer[1]+this.pointer[2])%this.pointer[2]}else{a=f.getElementsByClassName(this.el,"div","EQQ_SearchResultItem");this.pointer=[a,0,a.length]}this.pointer[0][this.pointer[1]].className="EQQ_SearchResultItemHover"}},arrowUp:function(){this.arrowDown(true)},hide:function(){this.isHide=true;f.hide(this.el);this.pointer=null},show:function(){this.isHide=false;this.pointer=null;f.show(this.el)}}),p,d=o.extend({target:"EQQ_Container",events:{"#EQQ_ExtendButton,#EQQ_ExtendButton>.EQQ_extendButton_bg click":function(a,b){b.isTaskBarRightExtend()?b.hideTaskBar():b.isTaskBarLeftExtend()&&b.showTaskBar()},"!.faceButtonInChatbox click":function(){b.hideFacePanel()},"@ @click":function(b,c){b.stopPropagation();p&&p.hide();c.hideSettingPanel();a.reset()}},hideTaskBar:function(){if(this.isTaskBarRightExtend()){this.id("EQQ_ExtendButton").className="EQQ_leftExtendButton";this.taskBarWidth=parseInt(this.id("EQQ_TaskBar").style.width);this.id("EQQ_TaskBar").style.width="17px";f.hide(this.id("EQQ_ChatBuddyList"))}},showTaskBar:function(){if(this.isTaskBarLeftExtend()){this.id("EQQ_ExtendButton").className="EQQ_rightExtendButton";f.show(this.id("EQQ_ChatBuddyList"));this.id("EQQ_TaskBar").style.width=this.taskBarWidth+"px";this.unflashTaskBar()}},TASKWIDTH:35,taskAdd:function(){var a=this.TASKWIDTH;if(this.id("EQQ_ExtendButton").className=="EQQ_noExtendButton")var b=17+a,a=0+a;else{b=this.isTaskBarLeftExtend()?this.taskBarWidth=this.taskBarWidth+a:parseInt(this.id("EQQ_TaskBar").style.width||17)+a;a=parseInt(this.id("EQQ_ChatBuddyList").style.width||0)+a}this.id("EQQ_ExtendButton").className="EQQ_rightExtendButton";this.id("EQQ_TaskBar").style.width=b+"px";this.id("EQQ_ChatBuddyList").style.width=a+"px";f.show(this.id("EQQ_ChatBuddyList"))},taskRemove:function(){var a=this.TASKWIDTH;if(this.isTaskBarLeftExtend()){this.taskBarWidth=this.taskBarWidth-a;a=parseInt(this.id("EQQ_ChatBuddyList").style.width||0)-a;this.id("EQQ_ChatBuddyList").style.width=a+"px";if(this.taskBarWidth==17){this.id("EQQ_ExtendButton").className="EQQ_noExtendButton";this.id("EQQ_TaskBar").style.width="2px"}}else{var b=parseInt(this.id("EQQ_TaskBar").style.width||17)-a,a=parseInt(this.id("EQQ_ChatBuddyList").style.width||0)-a;if(b==17){this.id("EQQ_ExtendButton").className="EQQ_noExtendButton";this.id("EQQ_TaskBar").style.width="2px"}else this.id("EQQ_TaskBar").style.width=b+"px";this.id("EQQ_ChatBuddyList").style.width=a+"px"}},flashMainBar:function(){if(!b.isMainPanelShow){var a=this.id("EQQ_StartButtonIcon");this.unflashMainBar();f.addClass(a,"EQQ_startButtonIconRadio");this.isMainBarFlashing=new j.fx(4,j.toggle(function(){f.addClass(a,"EQQ_startButtonIconFlash")},function(){f.removeClass(a,"EQQ_startButtonIconFlash")},true))}},unflashMainBar:function(){if(this.isMainBarFlashing){var a=this.id("EQQ_StartButtonIcon");f.removeClass(a,"EQQ_startButtonIconRadio");this.isMainBarFlashing.stop();this.isMainBarFlashing=null}},flashTaskBar:function(){if(this.isTaskBarLeftExtend()){var a=this.id("EQQ_ExtendButton");this.unflashTaskBar();this.isTaskBarFlashing=new j.fx(4,j.toggle(function(){f.addClass(a,"EQQ_flashExtendButton")},function(){f.removeClass(a,"EQQ_flashExtendButton")},true))}},unflashTaskBar:function(){if(this.isTaskBarFlashing){this.isTaskBarFlashing.stop();this.isTaskBarFlashing=
null}},isTaskBarLeftExtend:function(){return f.hasClass(this.id("EQQ_ExtendButton"),"EQQ_leftExtendButton")},isTaskBarRightExtend:function(){return f.hasClass(this.id("EQQ_ExtendButton"),"EQQ_rightExtendButton")},showSettingPanel:function(){this.id("EQQ_SettingButton").className="EQQ_settingButton_buttonDown";f.show(this.id("EQQ_SettingPanel"))},hideSettingPanel:function(){this.id("EQQ_SettingButton").className="EQQ_settingButton";f.hide(this.id("EQQ_SettingPanel"))}}),d=new d;d.render();var c=j.toggle(function(){MI.WebQQ.click=1;b.show();d.unflashMainBar();f.addClass(h,"EQQ_startButtonDown");webq.module.buddyList.initAvatar();MI.WebQQ.report2m(151290)},function(){b.hide();f.removeClass(h,"EQQ_startButtonDown")}),a=j.toggle(function(){d.showSettingPanel()},function(){d.hideSettingPanel()},!0),k=o.extend({target:"EQQ_Container",container:["div",{"class":"EQQ_global_main"}],html:g,afterRender:function(){var a=this;if(MI.AutoCmt){p=new MI.AutoCmt({target:a.id("EQQ_SearchBox"),key:0,tips:_("输入微博帐号，发起聊天"),topic:1,maxWidth:159,face:1,call:function(b){b.stop();var b=a.id("EQQ_SearchBox"),c=b.value;b.blur();setTimeout(function(){var b=webq.module.buddyList.collection.find(c);if(b){webq.module.taskBar.chat(b);webq.module.chatBox.chat(b)}else a.remoteAtChat()},0)}});UI.EA(window,"scroll",function(){p.hide()})}},observers:{search:function(a,b){var c=b.id("EQQ_SearchBox").value,c=c.split("@").join("");if(c!=""){c=webq.module.buddyList.collection.filter({nick:c,id:c});if(c.length){var d;if(d=b.searchResultView)b.searchResultView.update({results:c.slice(0,5)});else{d=b.searchResultView=new s({results:c.slice(0,5)});d.render()}d.show();b.searchKeyWord=null}}try{b.id("EQQ_SearchBox").focus()}catch(h){}}},events:{".EQQ_SearchButton click":function(){},".EQQ_SearchBox keyup":function(){},"!.faceButtonInChatbox click":function(){b.hideFacePanel()},"#EQQ_SearchBox click":function(a){if(a.target.value==_("输入微博帐号")+"..."){a.target.value="";a.target.style.color="black"}},"#EQQ_SearchBox blur":function(a,b){if(a.target.value==""){a.target.value=_("输入微博帐号...");a.target.style.color="#999"}setTimeout(function(){b.searchResultView&&(b.searchResultView.isHide||b.searchResultView.hide())},2E3)},".EQQ_qqfaces click":function(a,b){webq.module.chatBox.appendFace(a.target.title);b.hideFacePanel()},".EQQ_settingButton,.EQQ_settingButtonIcon,#EQQ_settingButtonText click":function(b){b.preventDefault();a()},"!.EQQ_settingButton,.EQQ_settingButtonIcon,#EQQ_settingButtonText click":function(b){b.preventDefault();d.hideSettingPanel();a.reset()},".~EQQ_SettingPanel_item,.~EQQ_setIcon,.EQQ_SettingPanel_Text click":function(d,e){for(var i=f.findPapa()(d.target,"EQQ_SettingPanel_item"),g=f.getElementsByClassName(e.id("EQQ_SettingPanel"),"li","EQQ_SettingPanel_item"),l=g.length-1;l>=0;l--)f.removeClass(g[l],"EQQ_CurrentMode");f.addClass(i,"EQQ_CurrentMode");a.reset();switch(i.getAttribute("flag")){case "offline":y(function(){e.id("EQQ_settingButtonText").className="EQQ_settingButtonText_offline";e.id("EQQ_StartButtonIcon").className="EQQ_startButtonIconOffline"});break;case "online":var j=function(){e.id("EQQ_settingButtonText").className="EQQ_settingButtonText_online";e.id("EQQ_StartButtonIcon").className="EQQ_startButtonIconActive"};r&q||w();r&t||setTimeout(function(){A(j)},0);webq.framework.cookie.set("mb_chat",(new Date).getTime(),"t.qq.com");break;case "lock":var p=function(){e.id("EQQ_settingButtonText").className="EQQ_settingButtonText_lock";e.id("EQQ_StartButtonIcon").className="EQQ_startButtonIconForbidden"};webq.module.taskBar.clear();webq.module.chatBox.clear();b.hide();c.reset();f.removeClass(h,"EQQ_startButtonDown");if(r&q){typeof UI!="undefined"&&MI.ajax&&MI.ajax({url:MI.url.chatStat,type:"post",data:{v:0},success:function(a){if(a.indexOf("result:0")>-1){p&&p();r=r^q}}});MI.WebQQ.report2m(151295)}r&t&&setTimeout(function(){z()},0)}},".~EQQ_MinButton click":function(a){a.preventDefault();c()},"@ @click":function(a){a.stopPropagation();p&&p.hide()}},show:function(){this.isMainPanelShow=true;f.show(this.id("EQQ_MainPanel"))},hide:function(){this.isMainPanelShow=false;f.hide(this.id("EQQ_MainPanel"))},showFacePanel:function(a){if(this.isFacePanelShow)this.hideFacePanel();else{this.id("EQQ_FaceSelection").style.right=a+"px";f.show(this.id("EQQ_FaceSelection"));this.isFacePanelShow=true}},hideFacePanel:function(){f.hide(this.id("EQQ_FaceSelection"));this.isFacePanelShow=false},remoteAtChat:function(){webq.framework.rpcservice.send(webq.CONST.CONN_SERVER_DOMAIN+"channel/get_friend_info",{context:this,data:{to:this.id("EQQ_SearchBox").value.split("@").join("")},onSuccess:function(a){a.retcode===0?webq.module.buddyList.chat(a.result.id,a.result):webq.module.yellowTips.bite({type:"remoteAtChatFail",text:_("未相互收听，无法即时聊天")},{beforeRender:function(){this.resetPosition(this.id("EQQ_SearchBox"));this.delayClose(3)}})},onError:function(){webq.module.yellowTips.bite({type:"remoteAtChatFail",text:_("未相互收听，无法即时聊天")},{beforeRender:function(){this.resetPosition(this.id("EQQ_SearchBox"));this.delayClose(3)}})}})}});webq.CONST.index=0;var b=new k(webq.CONST);b.render();b.afterRender();var h=f.id("EQQ_StartButton"),i=!0,x=function(a){e.off(h);e.on(h,"click",c);h.setAttribute("title","");if(i){i=false;setTimeout(function(){webq.framework.rpcservice.send(webq.CONST.CONN_SERVER_DOMAIN+"channel/login",{context:this,data:{},onSuccess:function(b){if(b.retcode===0){webq.CONST.myId=b.result.id;webq.CONST.myNick=b.result.nick;webq.CONST.uin=b.result.uin;a||webq.module.buddyList.fetch(c);webq.module.buddyList.fetch();MI.user.fun.chat===0&&w();r=q|t;MI&&MI.bannerTips&&MI.bannerTips()}else i=true},onError:function(){i=true},onTimeout:function(){i=true}})},300)}};e.on(h,"click",x);var q=1,t=2,r=0,y=function(a){r&q||w(a);r&t&&setTimeout(function(){z(a)},0)},A=function(a){webq.framework.rpcservice.send(webq.CONST.CONN_SERVER_DOMAIN+"channel/login",{context:this,data:{},onSuccess:function(b){if(b.retcode===0){webq.CONST.msg_id=0;webq.module.poll.poll();f.id("EQQ_StartButtonIcon").className="EQQ_startButtonIconActive";a&&a();r=r|t}},onError:function(){}})},z=function(a){webq.framework.rpcservice.send(webq.CONST.CONN_SERVER_DOMAIN+"channel/logout",{onSuccess:function(b){if(b.retcode===0){webq.module.poll.stopPoll();webq.CONST.msg_id=0;r=r^t;a&&setTimeout(a,0)}}})},w=function(a){typeof UI!="undefined"&&MI.ajax&&MI.ajax({url:MI.url.chatStat,type:"post",data:{v:1},success:function(b){if(b.indexOf("result:0")>-1){a&&a();r=r|q}}})};(new (o.extend({target:document,events:{"!.addAttention,.reply,.chat,.msg,...moreFun,...talkWrap,...DWrap,...tbSendMsg click":function(){b.hideFacePanel();b.hide();c.reset();f.removeClass(h,"EQQ_startButtonDown");webq.module.chatBox.hide()}}}))).render();webq.module.container=d;webq.module.ammo=b;setTimeout(function(){x(true)},100);webq.module.login={setOffline:y};webq.module.yellowTips=n})();(function(){var g=webq.framework,f=g.rpcservice={},o=g.string;document.domain="qq.com";"undefined"===typeof window.XMLHttpRequest&&(window.XMLHttpRequest=function(){return new window.ActiveXObject(0<=navigator.userAgent.indexOf("MSIE 5")?"Microsoft.XMLHTTP":"Msxml2.XMLHTTP")});webq.tProxyReady=function(){};var m=webq.CONST.CLIENTID,k,n=!1,j=[],e=function(e,d){if(k)l(e,d);else{j.push({url:e,option:d});if(!n){n=true;var c=document.body,a=document.createElement("div"),b="EQQ_ProxySendIframe"+(new Date).getTime();a.innerHTML='<iframe style="display:none" id="'+b+'" class="hiddenIframe" name="'+b+'" width="1" height="1" src="about:blank"></iframe>';c.appendChild(a);c=document.getElementById(b);webq.tProxyReady=function(){setTimeout(function(){k=window.frames[b].ajax;for(var a=0;a<j.length;++a){var c=j[a].url,d=j[a].option;try{l(c,d)}catch(e){if(!d.onError)break;c={};c.arguments=d.arguments||{};d.onError.call(d.context,c)}}},50)};c.setAttribute("src",webq.CONST.CONN_PROXY_URL)}}},l=function(e,d){d=d||{};d.cacheTime=d.cacheTime||0;d.onSuccess=d.onSuccess||function(){};d.onError=d.onError||function(){};d.onTimeout=d.onTimeout||function(){};d.onComplete=d.onComplete||function(){};var c={method:d.method||"GET",enctype:d.enctype||"",data:d.data||{},arguments:d.arguments||{},context:d.context||null,timeout:d.timeout,onSuccess:function(a){var c={},e=false;a.responseText=a.responseText||"-";try{c=g.json.parse(a.responseText)}catch(f){a.responseText=a.responseText+":bad-JSON-format:";e=true}finally{c.arguments=d.arguments||{};c.o=a;d.onSuccess.call(d.context,c,e)}},onError:function(a){d.onError.call(d.context,a)},onTimeout:function(){var a={};a.arguments=d.arguments||{};d.onTimeout.call(d.context,a)},onComplete:function(){var a={};a.arguments=d.arguments||{};d.onComplete.call(d.context,a)}};c.data.clientid=m;if(c.method=="GET"){var a=o.obj2queryString(c.data);d.cacheTime===0&&(a=a?a+("&t="+(new Date).getTime()):a+("t="+(new Date).getTime()));a&&(e=e+"?"+a);c.data=null}else{c.contentType="application/x-www-form-urlencoded";e.indexOf("?")}k(e,c)},s=function(e,d){var c,a,b,h=false,i=false,d={method:d.method||"GET",data:d.data||null,arguments:d.arguments||null,onSuccess:d.onSuccess||function(){},onError:d.onError||function(){},onComplete:d.onComplete||function(){},onTimeout:d.onTimeout||function(){},isAsync:d.isAsync||true,timeout:d.timeout?d.timeout:1E4,contentType:d.contentType?d.contentType:"utf-8",type:d.type||"xml"},e=e||"";b=d.timeout;c=new window.XMLHttpRequest;c.open(d.method,e,d.isAsync);c.setRequestHeader("Content-Type",d.contentType);a=function(a){try{return!a.status&&location.protocol=="file:"||a.status>=200&&a.status<300||a.status==304||navigator.userAgent.indexOf("Safari")>-1&&typeof a.status=="undefined"}catch(b){}return false};c.onreadystatechange=function(){if(c.readyState==4){if(!h){var b={};b.responseText=c.responseText;b.responseXML=c.responseXML;b.data=d.data;b.status=c.status;b.uri=e;b.arguments=d.arguments;if(a(c)){d.type==="script"&&eval.call(window,data);d.onSuccess(b)}else d.onError(b);d.onComplete(b)}i=true;c=null}};c.send(d.data);window.setTimeout(function(){var a;if(!i){h=true;a={};a.uri=e;a.arguments=d.arguments;d.onTimeout(a);d.onComplete(a)}},b);return c};f.send=e;f.combine=function(f,d,c){var a=function(a){d.onError=d.errback||function(){};a=a||function(){};d.onSuccess=function(c){d.callback(c,a)};e(f,d)};return c?a:a()};f.require=function(e,d){for(var c=e.length,a=function(){c--;c==0&&setTimeout(d,13)},b=0;b<c;b++)e[b](a)};f.abortProxy=function(){try{(void 0).abort()}catch(e){}};f.ajax=function(e,d){d=d||{};d.cacheTime=d.cacheTime||0;d.onSuccess=d.onSuccess||function(){};d.onError=d.onError||function(){};d.onTimeout=d.onTimeout||function(){};d.onComplete=d.onComplete||function(){};var c={method:d.method||"GET",contentType:d.contentType||"",enctype:d.enctype||"",param:d.param||{},arguments:d.arguments||{},context:d.context||null,timeout:d.timeout||3E4,onSuccess:function(a){a=g.json.parse(a.responseText);a.arguments=d.arguments||{};d.onSuccess.call(d.context,a)},onError:function(a){d.onError.call(d.context,a)},onTimeout:function(){var a={};a.arguments=d.arguments||{};d.onTimeout.call(d.context,a)},onComplete:function(){var a={};a.arguments=d.arguments||{};d.onComplete.call(d.context,a)}};if(c.method=="GET"){c.data=d.data||{};var a=g.string.Obj2QueryString(c.data);d.cacheTime===0&&(a=a?a+("&t="+(new Date).getTime()):a+("t="+(new Date).getTime()));a&&(e=e+"?"+a);c.data=null}else{c.data=d.data||"";c.contentType="application/x-www-form-urlencoded";e.indexOf("?")}s(e,c)}})();(function(){function g(f){return this instanceof arguments.callee?this.init.call(this,f):n.api}var f=webq.framework,o=f.dom,m=f.rpcservice,k=webq.CONST;g.prototype={init:function(){},timeout:9E4,pollCount:0,pollMax:1,failCount:0,sendPoll:function(f){f={msg_id:webq.CONST.msg_id,clientid:webq.CONST.clientid};this.pollCount<this.pollMax&&(this.pollCount++,m.send(k.CONN_SERVER_DOMAIN+"channel/poll",{context:this,data:f,timeout:this.timeout,onSuccess:this.sendPollSuccess,onError:this.sendPollError,onTimeout:this.sendPollTimeout}))},startPoll:function(){this.pollMax=1;this.sendPoll()},stopPoll:function(){this.pollMax=0},sendPollSuccess:function(f){this.pollCount--;0===f.retcode||102===f.retcode?(this.resetFailCount(),this.router(f.result),this.sendPoll()):(this.sendPoll(),this.onFail())},sendPollError:function(){this.sendPollTimeout()},sendPollTimeout:function(){this.pollCount--;this.sendPoll();this.onFail()},resetFailCount:function(){this.failCount=0},onFail:function(){this.failCount++;4<this.failCount&&(this.failCount=0,g().stopPoll())},router:function(f){if(f)try{var e=f.message,g=f.history,k=f.buddies_status_change,p=f.logout;if(e){e.sort(function(a,b){return a[1].msg_id>b[1].msg_id?1:-1});for(var d=0;d<e.length;d++)webq.module.chatBox.msgRouter(webq.module.msg.setItem(e[d])),webq.CONST.msg_id=e[d][1].msg_id}if(g){g.sort(function(a,b){return a[1].msg_id>b[1].msg_id?1:-1});for(d=0;d<g.length;d++)webq.module.chatBox.msgRouter(webq.module.msg.setItem(g[d]),!0),webq.CONST.msg_id=g[d][1].msg_id}k&&webq.module.buddyList.buddyRouter(k);p&&webq.module.login.setOffline()}catch(c){}}};var n={};n.api={core:new g,poll:function(){this.core.startPoll();o.id("EQQ_StartButtonIcon").className="EQQ_startButtonIconActive"},stopPoll:function(){this.core.stopPoll()}};webq.module.poll=g()})();(function(){var g=webq.framework,f=g.dom,o=g.model,m=g.controller,k=g.collection,n=g.func,g=g.view.extend({target:"EQQ_Class_0_online",container:["div",{style:"height:34px;overflow:auto;"},function(){}],template:'<div id="EQQ_BuddyList_AvatarContainer_<%=id%>" class="EQQ_BuddyList_AvatarContainer" uin="<%=id%>" title="<%=id%>">\t<img id="EQQ_BuddyList_Avatar_<%=id%>" class="EQQ_BuddyList_Avatar" src="<%=MI.picSrc.h30%>" />\t<div class="EQQ_BuddyList_State"></div></div><div id="EQQ_BuddyList_RightContainer_<%=id%>" class="EQQ_BuddyList_RightContainer" title="<%=htmlNick%>(<%=id%>)">\t<div class="EQQ_BuddyList_Nick"><div class="EQQ_BuddyList_Nick_inner"><%=htmlNick%>(<%=id%>)</div></div>\t<a class="EQQ_BuddyList_QzoneIcon" target="_blank" href="http://t.qq.com/<%=id%>" title="'+_("查看最新微博")+'"></a></div>',events:{".EQQ_BuddyList_RightContainer,.EQQ_BuddyList_Nick,.EQQ_BuddyList_Nick_inner,.EQQ_BuddyList_Avatar click":function(e,f){f.trigger("chat",f.getId());f.trigger("unflash",f.getId())}},afterRender:function(e){e||this.loadAvatar()},loadAvatar:function(){!this._loaded&&this._data.avatar&&(f.id("EQQ_BuddyList_Avatar_"+this._data.id).src=this._data.avatar,this._loaded=!0)},init:function(){},flash:function(){var e=this;this.unflash();this.isFlashing=new n.fx(4,n.toggle(function(){e.el.style.background="#73cff1"},function(){e.el.style.background="transparent"},!0))},unflash:function(){this.isFlashing&&(this.el.style.background="transparent",this.isFlashing.stop(),delete this.isFlashing)},insertBefore:function(){this.target.insertBefore(this.el,this.target.childNodes[0])},renew:function(){f.removeClass(this.el,"fade");this.trigger("renew",this.getId())},fade:function(){f.addClass(this.el,"fade");this.target.appendChild(this.el);this.trigger("fade",this.getId())},update:function(e){"online"==e.statu?(this.renew(),this.insertBefore()):"offline"==e.statu&&this.fade()}}),o=o.extend({xss:{nick:"htmlNick"},map:function(e,f,g){if("avatar"==e){var j;f?(j=f+"/20",f+="/30"):j=f=webq.CONST.DEFAULT_FACE_URL;g[e+"_20"]=j}return f}}),k=k.extend({model:o,key:"id"}),j=new (m.extend({init:function(){var e=this;this.collection.bind("add",function(){e.updateOnlineCount(1)})},collection:k,view:g,viewObserver:{chat:function(e,f){f.chat(e);webq.module.container.unflashTaskBar()},unflash:function(e,f){f.unflash(e);webq.module.taskBar.unflash(e)},renew:function(e,f){f.updateOnlineCount(1)},fade:function(e,f){f.updateOnlineCount(-1)}},_onlineCount:0,updateOnlineCount:function(e){this._onlineCount+=e;f.id("EQQ_onlineCount").innerHTML="("+this._onlineCount+")"},initAvatar:function(){if(!this._initAvatar){var e=this;MI.WebQQ.loadCss();var f;a:{for(f in this.collection._hash){f=!1;break a}f=!0}!f&&(MI.WebQQ.dataLoaded&&MI.WebQQ.click)&&(this.collection.map(function(f){(f=e.find(f))&&f.loadAvatar()}),this._initAvatar=!0)}},chat:function(e,f){f&&(this.bite(f),"offline"==f.statu&&this.find(e).fade());f=this.collection.find(e);webq.module.taskBar.chat(f);webq.module.chatBox.chat(f)},fetch:function(e){webq.framework.rpcservice.send(webq.CONST.CONN_SERVER_DOMAIN+"channel/get_online_buddies",{context:this,data:{},onSuccess:function(g){if(0===g.retcode){g.result.sort(function(e,d){return e.id<d.id?-1:1});for(var j=g.result.length-1;0<=j;j--)g.result[j].statu="online";f.hide("EQQ_Logining");f.show("EQQ_BuddyList");this.feed(g.result,{delay:!0});MI.WebQQ.dataLoaded=1;webq.module.buddyList.initAvatar();e&&e();setTimeout(function(){webq.module.poll.poll();for(var e=MI.WebQQ.chatQueue;0<e.length;e++)MI.WebQQ.chat.apply(null,e[0])},0)}},onError:function(){}})},buddyRouter:function(e){this.bite(e)},unflash:function(e){if(this.flashingViews){var f=n.arrayIndexOf(this.flashingViews,e);-1<f&&(this.flashingViews.splice(f,1),this.find(e).unflash(),0==this.flashingViews.length&&webq.module.container.unflashMainBar())}},insertBefore:function(e){(e=this.find(e))&&e.insertBefore()},GET_FRIEND_INFO_LOCK:{},msgRouter:function(e){var f=this.find(e),g=this;f?(webq.module.titleMaquee.run(),f.flash(),this.flashingViews=this.flashingViews||[],-1<n.arrayIndexOf(this.flashingViews,e)||this.flashingViews.push(e),f.insertBefore(),webq.module.container.flashMainBar()):g.GET_FRIEND_INFO_LOCK[e]||(g.GET_FRIEND_INFO_LOCK[e]=!0,webq.framework.rpcservice.send(webq.CONST.CONN_SERVER_DOMAIN+"channel/get_friend_info",{data:{to:e},timeout:5E3,onSuccess:function(f){if(0===f.retcode){g.bite(f.result);var d=g.find(e);d.flash();"offline"==f.result.statu&&d.fade();g.flashingViews=g.flashingViews||[];g.flashingViews.push(e);d.insertBefore();webq.module.container.flashMainBar();webq.module.titleMaquee.run()}delete g.GET_FRIEND_INFO_LOCK[e]},onError:function(){delete g.GET_FRIEND_INFO_LOCK[e]},onTimeout:function(){delete g.GET_FRIEND_INFO_LOCK[e]}}))}}))({});webq.module.buddyList=j;MI.WebQQ.chat=function(e,f,g){j.chat(e,{id:e,nick:f,avatar:g})}})();(function(){var g=webq.framework,f=g.dom,o=g.model,m=g.controller,k=g.collection,n=g.func,g=g.view.extend({target:"EQQ_ChatBuddyList",container:["div",{style:"width:35px;height:35px;float:left;cursor: pointer;"}],template:'<div id="EQQ_FlashDiv_<%=id%>" class="EQQ_TaskBar_FlashDiv EQQ_taskBar_currentBuddy">                    <div id="EQQ_TaskBar_BuddyState_<%=id%>" class="EQQ_taskBar_onlineBuddy">                        <img class="EQQ_taskBar_avatar" src="<%=avatar_20%>" />                        <div class="EQQ_taskBar_state">online</div>                    </div>                    <div class="EQQ_taskBar_nick"><%=htmlNick%></div>                </div>                <div id="EQQ_TaskBar_CloseChatBoxButton_<%=id%>" class="EQQ_TaskBar_CloseChatBoxButton" title="'+_("关闭会话窗口")+'">X</div>            ',init:function(){},afterInit:function(){this.trigger("taskAdd")},destory:function(){this.el.parentNode.removeChild(this.el);this.trigger("taskRemove")},getRight:function(){var g=f.getClientWidth(),e=f.getClientXY(this.el)[0],g=g-(e+parseInt(this.id("EQQ_Container").style.right)+25);265>e&&(g-=265-e);return g},setCurrent:function(){f.addClass(this.el.childNodes[0],"EQQ_taskBar_currentBuddy")},setUnCurrent:function(){f.removeClass(this.el.childNodes[0],"EQQ_taskBar_currentBuddy")},events:{"@ @click":function(f,e){var g=e.getId();e.trigger("click",e);e.trigger("unflash",g)}},update:function(){f.show(this.el)},flash:function(){var f=this;this.unflash();this.isFlashing=new n.fx(4,n.toggle(function(){f.el.style.background="#C9F1FF"},function(){f.el.style.background="transparent"},!0))},unflash:function(){this.isFlashing&&(this.el.style.background="transparent",this.isFlashing.stop(),delete this.isFlashing)},insertBefore:function(){this.target.appendChild(this.el);this.trigger("insertBefore",this.getId())}}),o=o.extend({}),k=k.extend({model:o,key:"id"}),m=new (m.extend({collection:k,view:g,viewObserver:{click:function(f,e){var g=e.collection.find(f.getId());e.chat(g);webq.module.chatBox.chat(g);webq.module.container.unflashTaskBar()},taskAdd:function(f){webq.module.container.taskAdd();f.checkTaskLimit()},taskRemove:function(){webq.module.container.taskRemove()},insertBefore:function(f,e){e.collection.insertBefore(f)},unflash:function(f,e){e.unflash(f);webq.module.buddyList.unflash(f)}},chat:function(f){this.bite(f);this.setCurrent(f[this.key])},setCurrent:function(f){if(this.currentId){var e=this.find(this.currentId);e&&e.setUnCurrent()}this.currentId=f;this.find(f).setCurrent()},setUnCurrent:function(f){this.find(f).setUnCurrent()},unflash:function(f){if(this.flashingViews){var e=n.arrayIndexOf(this.flashingViews,f);-1<e&&(this.flashingViews.splice(e,1),this.find(f).unflash(),0==this.flashingViews.length&&webq.module.container.unflashTaskBar())}},msgRouter:function(f){var e=this.find(f);e&&(e.flash(),this.flashingViews=this.flashingViews||[],this.flashingViews.push(f),e.insertBefore(),webq.module.container.flashTaskBar())},clear:function(){var f=this;this.collection.map(function(e){f.puke(e)});this.currentId=null},taskLimit:Math.floor(795.8),checkTaskLimit:function(){if(this.collection.getLength()>this.taskLimit){var f=this.collection.getFirst();this.puke(f);webq.module.chatBox.puke(f)}}}))({});webq.module.taskBar=m})();(function(){var g=webq.framework,f=g.dom,o=g.view,m=g.model,k=g.controller,n=g.collection,j=g.json,e=g.string,l=g.func,s=function(){return parseInt(webq.framework.cookie.get("luin").substr(1),"10")||parseInt(webq.framework.cookie.get("uin").substr(1),"10")},p=function(a){return 2>String(a).length?"0"+a:a},d={toofast:_("您的说话速度太快了，请稍后再发。"),uinconflict:_("登录失效请刷新页面"),charsovermax:_("消息内容请勿超过300字，请修改后再试。"),selfoffline:_("您已经离线，无法进行会话，请重新上线后再试。"),offline:_("对方已经下线，可能无法即时回复，您可以给他发送离线消息或者私信。"),msgmiss:_("现在通过微博实时聊天的记录会自动转存为私信，方便您以后查阅，快来试试吧 ~"),dirtyword:_("您输入的内容有误，请修改后再次发送。"),notfollow:_("会话方与您不存在互听关系，如需发起实时聊天，需要双方微博互听。"),notopen:function(a){var b=c.collection.find(a).getter("htmlNick");return _("对方禁用了聊天，无法收到本条消息")+'...<a style="text-decoration:underline;cursor:pointer" onclick=\'MI.message("'+a+'","Hi~'+b+"，"+_("我正在使用腾讯微博的实时聊天功能，快来这里开通实时聊天功能，与我在线聊天吧！")+(MI.user.isLab?"http://p.t.qq.com/setting/privacy":"http://p.t.qq.com/setting/others")+"\");return false;'>"+_("点这里")+"</a>"+_("，发封私信告诉Ta开通实时聊天权限吧。")}},g=o.extend({target:"EQQ_Container",container:["div",{"class":"EQQ_chatbox"}],template:'<div id="EQQ_uin_chatboxTitle" class="EQQ_chatboxTitle">                <div id="chatBox_avatarArea_<%=id%>" class="onlineBuddyInChatbox" title="">                    <a title="<%=nick%>(@<%=id%>)" href="http://t.qq.com/<%=id%>"><img id="EQQ_Chatbox_Avatar_<%=id%>" class="avatarInChatbox" title="<%=nick%>(@<%=id%>)" src="<%=avatar%>" /></a>                    <div class="stateInChatbox">'+_("状态")+'</div>                </div>                <div class="EQQ_chatboxControler">                    <a href="#" onclick="return false;"><div id="EQQ_ChatboxCloseButton_<%=id%>" class="EQQ_chatboxCloseButton" title="'+_("关闭")+'" href="#"></div></a>                    <a href="#" onclick="return false;"><div id="EQQ_ChatboxMinButton_<%=id%>" class="EQQ_chatboxMinButton" title="'+_("最小化")+'" href="#"></div></a>                </div>                <div class="EQQ_chatboxNameLine">                    <a id="EQQ_ChatboxName_<%=id%>" class="EQQ_chatboxName" href="/<%=id%>" ><span id="EQQ_ChatboxMainName_<%=id%>" class="mainName"><%=htmlNick%>(<%=id%>)</span></a>                </div>                <div id="EQQ_ChatboxMoreInfo_<%=id%>" class="EQQ_chatboxMoreInfo">                    <a href="#" onclick="return false;" title="'+_("加为QQ好友")+'"><div class="EQQ_addBuddyIcon"></div><div class="EQQ_addBuddyText">'+_("加为QQ好友")+'</div></a>                </div>            </div>            <div class="EQQ_chatOutline">                <div id="ChatContentInChatbox_<%=id%>" class="chatContentInChatbox">\t<\!--\t<dl class= "myMsgInChatbox"><dt class="msgHead">dasdasdasdsa</dt><dd class="msgBody">dasdasdas</dd>\t</dl>\t<dl class="buddyMsgInChatbox"><dt class="msgHead">asdasdads</dt><dd class="msgBody">dasdasd</dd>\t</dl>\t--\>                </div>            </div>            </div>            <div class="optionInChatbox">            <a href="#" style="width: 20px;display: block;" onclick="return false;">            \t<div id="FaceButtonInChatbox_<%=id%>" class="faceButtonInChatbox">'+_("表情")+'</div>\t</a>\t</div>            <textarea id="TextareaInChatbox_<%=id%>" class="textareaInChatbox"></textarea>            <div class="EQQ_chatControler"><a href="#" onclick=\'MI.report("<%=id%>");return false;\' style="display: block; margin-left: 5px; position: absolute; margin-top: 3px;"><div class="EQQ_chatReport">'+_("举报")+'</div></a>                <a href="#" onclick="return false;"><div id="EQQ_sendMsgButton_<%=id%>" class="EQQ_sendMsgButton" title="'+_("发送")+'" >'+_("发送")+'</div></a>                <a href="#" onclick="return false;"><div id="EQQ_ChatboxCloseButton2_<%=id%>" class="EQQ_chatboxCloseButton2" title="'+_("关闭")+'" >'+_("关闭")+"</div></a>            </div>",events:{".EQQ_chatboxCloseButton,.EQQ_chatboxCloseButton2 click":function(a,b){b.trigger("puke",b.getId());webq.module.ammo.hideFacePanel()},".EQQ_chatboxMinButton click":function(a,b){b.hide();b.trigger("mini",b.getId())},".textareaInChatbox keydown":function(a,b){if(13==a.keyCode&&a.ctrlKey){var c=b.getId(),d=b.getContent();b.trigger("send",c,d)}},".EQQ_sendMsgButton click":function(a,b){var c=b.getId(),d=b.getContent();b.trigger("send",c,d)},".faceButtonInChatbox click":function(a,b){a.preventDefault();a.stopPropagation();var c=f.getClientWidth(),d=f.getClientXY(a.target)[0],c=c-(d+parseInt(b.id("EQQ_Container").style.right)+25);411>d&&(c-=411-d);try{b.id("TextareaInChatbox_"+b.getId()).focus()}catch(e){}if((d=document.selection)&&d.createRange)this.selection=d.createRange();b.trigger("face",b.getId(),c)},".EQQ_yellowTips_close click":function(a,b){var c=a.target.parentNode;b.closeTips(c);"msgmiss"==c.getAttribute("flag")&&b.trigger("setNoWarnning")},"...EQQ_chatboxMoreInfo click":function(a,b){MI&&MI.addQQ&&MI.addQQ(b.getId());MI.WebQQ.report2m(151291)}},tipsCount:0,renderTips:function(a,b){var c,g=!1;(c=f.id("EQQ_yellowTips_"+this.getId()+"_"+a))&&this.closeTips(c);var j=this;c=f.node("div",{id:"EQQ_yellowTips_"+this.getId()+"_"+a,"class":"EQQ_yellowTips",flag:a});"notopen"==a?(c.innerHTML=e.template('\t<div class="EQQ_yellowTips_info">!</div>\t<div class="EQQ_yellowTips_text"><%=content%></div>\t<div class="EQQ_yellowTips_close">X</div>\t',{content:d[a](this.getId())}),g=!0):c.innerHTML=e.template('\t<div class="EQQ_yellowTips_info">!</div>\t<div class="EQQ_yellowTips_text"><%=content%></div>\t<div class="EQQ_yellowTips_close">X</div>\t',{content:d[a]});this.id("ChatContentInChatbox_"+this.getId()).appendChild(c);this.tipsCount++;f.addClass(this.id("ChatContentInChatbox_"+this.getId()),"tips");(!g||b)&&setTimeout(function(){j.closeTips(c)},6E3)},closeTips:function(a){try{a.parentNode.removeChild(a),this.tipsCount--,0==this.tipsCount&&f.removeClass(this.id("ChatContentInChatbox_"+this.getId()),"tips")}catch(b){}},afterInit:function(){this.isShow=!0},update:function(){var a=this;f.show(this.el);var b=this.id("ChatContentInChatbox_"+this.getId());setTimeout(function(){b.scrollTop=b.scrollHeight;try{a.id("TextareaInChatbox_"+a.getId()).focus()}catch(c){}},0);this.trigger("update",this.getId())},afterRender:function(){try{this.id("TextareaInChatbox_"+this.getId()).focus()}catch(a){}this.trigger("fillMe",this.getId());this.trigger("setTips",this.getId())},appendMsg:function(a){var b=webq.CONST.myId==a.from_id?f.node("dl",{"class":"myMsgInChatbox"}):f.node("dl",{"class":"buddyMsgInChatbox"}),c=a.content,d=a.time;13>String(d).length&&(d=1E3*parseInt(d));var d=new Date(parseInt(d)),d=[p(d.getHours())+":"+p(d.getMinutes()),d.getMonth()+1+"-"+d.getDate()][0],g=webq.CONST.SHORTCUT_2_FACE,j=[],k,c=e.encodeHtmlSimple(c);c.replace(/\/[\u4e00-\u9fa5ON]/g,function(a,b){var d,e;if(d=g[a])return(e=l.each(d,function(a){a=c.substr(b,a.length);if("undefined"!=typeof d[a])return[a,d[a]]}))&&j.push(e),a});for(k=j.length-1;0<=k;k--)var m='<img class="EQQ_faceImg" src="'+webq.CONST.SYSTEM_FACE_URL+j[k][1]+'.gif" />',c=c.split(j[k][0]).join(m);c=c.replace(/\r\n|\r|\n/ig,"<br />");b.innerHTML=e.template('<dt class="msgHead"><%=htmlAllName%> <%=hm%></dt>                        <dd class="msgBody"><%=htmlContent%></dd>            ',{htmlContent:c,htmlAllName:a.htmlNick+"("+a.from_id+")",hm:d});var n=this.id("ChatContentInChatbox_"+this.getId());n.appendChild(b);setTimeout(function(){n.scrollTop=n.scrollHeight},0)},appendFace:function(a){var b=this.id("TextareaInChatbox_"+this.getId());try{b.focus()}catch(c){}var d=document.selection;if("undefined"!=typeof b.selectionStart)b.value=b.value.substr(0,b.selectionStart)+a+b.value.substr(b.selectionEnd);else if(d&&d.createRange){b=d.createRange();b.text=a;try{b.moveStart("character",-strlen(a))}catch(e){}}else b.value+=a},setRight:function(a){this.el.style.right=a+"px"},getContent:function(){return this.id("TextareaInChatbox_"+this.getId()).value},clearContent:function(){this.id("TextareaInChatbox_"+this.getId()).value="";try{this.id("TextareaInChatbox_"+this.getId()).focus()}catch(a){}}}),m=m.extend({}),n=n.extend({model:m,key:"id"}),c=new (k.extend({init:function(){this.collection.bind("add",function(){MI.WebQQ.report2m(151289)})},collection:n,view:g,viewObserver:{puke:function(a,b){b.puke(a);webq.module.taskBar.puke(a);a==b.currentId&&(b.currentId=null)},update:function(a,b){b.setRight(a);b.currentId&&b.find(b.currentId).hide();b.currentId=a},fillMe:function(a,b){for(var c=b.find(a),d=webq.module.msg.getItem(a),e=0;e<d.length;e++)c.appendMsg(d[e][1])},mini:function(a,b){webq.module.taskBar.setUnCurrent(a);a==b.currentId&&(b.currentId=null)},send:function(a,b,c){b&&300<b.length?c.find(a).renderTips("charsovermax"):c.find(a).SENDING?c.find(a).renderTips("toofast"):b&&(c.find(a).SENDING=!0,webq.framework.rpcservice.send(webq.CONST.CONN_SERVER_DOMAIN+"channel/send_msg",{method:"post",timeout:5E3,data:e.obj2queryString({r:j.stringify({to:a,content:b})}),onSuccess:function(d){delete c.find(a).SENDING;switch(d.retcode){case 0:c.find(a).clearContent();MI.WebQQ.report2m(151293);break;case 118:c.find(a).renderTips("offline");c.msgRouter(webq.module.msg.setItem(["message",{msg_id:webq.module.msg.getSequence(),from_id:webq.CONST.myId,to_id:a,time:Math.floor((new Date).getTime()/1E3),content:b}]));c.find(a).clearContent();MI.WebQQ.report2m(151292);break;case 117:c.find(a).renderTips("dirtyword");MI.WebQQ.report2m(151294);break;case 119:s()!=webq.CONST.uin?webq.module.yellowTips.bite({type:"uinconflict",text:_("登录失效请刷新页面")},{beforeRender:function(){this.resetPosition(this.id("EQQ_StartButtonIcon"))}}):c.find(a).renderTips("notfollow");MI.WebQQ.report2m(151294);break;case 121:c.find(a).renderTips("notopen");MI.WebQQ.report2m(151294);break;case 103:case 100:s()!=webq.CONST.uin?webq.module.yellowTips.bite({type:"uinconflict",text:_("登录失效请刷新页面")},{beforeRender:function(){this.resetPosition(this.id("EQQ_StartButtonIcon"))}}):c.find(a).renderTips("selfoffline"),MI.WebQQ.report2m(151294)}},onError:function(){delete c.find(a).SENDING},onTimeout:function(){delete c.find(a).SENDING}}))},face:function(a,b){webq.module.ammo.showFacePanel(b)},setTips:function(a,b){b.isWarnning&&b.find(a).renderTips("msgmiss",!0)},setNoWarnning:function(a){a.isWarnning=!1}},isWarnning:!0,appendFace:function(a){if(this.currentId){var b=this.find(this.currentId);b.isShow&&b.appendFace(a)}},setRight:function(a){if(webq.module.container.isTaskBarRightExtend()){var b=webq.module.taskBar.find(a).getRight();this.find(a).setRight(b)}},chat:function(a){if(a[this.key]==this.currentId)this.find(this.currentId).hide(),webq.module.taskBar.setUnCurrent(this.currentId),this.currentId=null;else{var b=a[this.key];this.bite(a);this.setRight(b);this.currentId&&this.find(this.currentId).hide();this.currentId=b;this.find(b).show()}},msgRouter:function(a,b){var c=a[1],d,e;e=c.from_id;e==webq.CONST.myId&&(e=c.to_id);(d=this.find(e))&&d.appendMsg(c);if(!(d=this.find(e))||!d.isShow)b?e!=c.to_id&&webq.module.buddyList.insertBefore(e):e!=c.to_id&&(webq.module.buddyList.msgRouter(e),webq.module.taskBar.msgRouter(e))},clear:function(){var a=this;this.collection.map(function(b){a.puke(b)});this.currentId=null},hide:function(){this.currentId&&(this.find(this.currentId).hide(),webq.module.taskBar.setUnCurrent(this.currentId),this.currentId=null)}}))({});webq.module.chatBox=c})();(function(){var g=webq.framework,f=g.func,g=g.event,o=webq.module,m={},k=(new Date).getTime(),k=(k-k%1E3)/1E3,k=1E4*(k%1E4),n=0;o.msg={getItem:function(c){return m[c]||[]},setItem:function(c){var a,b;c[1].from_id==webq.CONST.myId?(a=m[c[1].to_id]=m[c[1].to_id]||[],c[1].htmlNick=_(webq.CONST.myNick)):(a=m[c[1].from_id]=m[c[1].from_id]||[],b=webq.module.buddyList.collection.find(c[1].from_id),c[1].htmlNick=b?b.getter("htmlNick"):c[1].from_id);a.push(c);return c},getSequence:function(){n++;return k+n}};var o=webq.module,j,e=_(" 收到新的微博实时聊天消息"),l=e,s=document.title+"",p=!1,d=function(){j&&(j.stop(),j=null);l=e;document.title=(MI.newCountNum?"("+MI.newCountNum+") ":"")+(document.titleTmp||s)};"onfocusin"in document?(g.on(document,"focusin",function(){p=!1;d()}),g.on(document,"focusout",function(){p=!0})):(g.on(window,"focus",function(){p=!1;d()}),g.on(window,"blur",function(){p=!0}));o.titleMaquee={run:function(){d();p&&(j=new f.fx(2,function(){l=l.substr(1)+l.charAt(0);document.title=l}))},stop:d}})();/*version:101465*//*  |xGv00|7c9ef15ebed52d4eb6dd97adee20ced5 */