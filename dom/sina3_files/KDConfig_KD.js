var KD=(function(){var STK=(function(){var spec={dependCacheList:{},importCacheStore:{},importCacheList:[],jobsCacheList:[]};var that={};var lastPoint=1;var baseURL="";var errorInfo=[];var register=function(ns,maker){var path=ns.split(".");var curr=that;for(var i=0,len=path.length;i<len;i+=1){if(i==len-1){if(curr[path[i]]!==undefined){throw ns+"has been register!!!"}curr[path[i]]=maker(that);return true}if(curr[path[i]]===undefined){curr[path[i]]={}}curr=curr[path[i]]}};var checkPath=function(ns){var list=ns.split(".");var curr=that;for(var i=0,len=list.length;i<len;i+=1){if(curr[list[i]]===undefined){return false}curr=curr[list[i]]}return true};var checkDepend=function(){for(var k in spec.dependCacheList){var loaded=true;for(var i=0,len=spec.dependCacheList[k]["depend"].length;i<len;i+=1){if(!checkPath(spec.dependCacheList[k]["depend"][i])){loaded=false;break}}if(loaded){try{register.apply(that,spec.dependCacheList[k]["args"])}catch(exp){}delete spec.dependCacheList[k];setTimeout(function(){checkDepend()},25)}}};var E=function(id){if(typeof id==="string"){return document.getElementById(id)}else{return id}};var addEvent=function(sNode,sEventType,oFunc){var oElement=E(sNode);if(oElement==null){return}sEventType=sEventType||"click";if((typeof oFunc).toLowerCase()!="function"){return}if(oElement.attachEvent){oElement.attachEvent("on"+sEventType,oFunc)}else{if(oElement.addEventListener){oElement.addEventListener(sEventType,oFunc,false)}else{oElement["on"+sEventType]=oFunc}}};that.inc=function(ns,undepended){if(!spec.importCacheList){spec.importCacheList=[]}for(var i=0,len=spec.importCacheList.length;i<len;i+=1){if(spec.importCacheList[i]===ns){if(!undepended){spec.importCacheList.push(ns)}return false}}if(!undepended){spec.importCacheList.push(ns)}spec.importCacheStore[ns]=false;var js=document.createElement("SCRIPT");js.setAttribute("type","text/javascript");js.setAttribute("src",baseURL+ns.replace(/\./ig,"/")+".js");js.setAttribute("charset","utf-8");js[that.IE?"onreadystatechange":"onload"]=function(){if(!that.IE||this.readyState.toLowerCase()=="complete"||this.readyState.toLowerCase()=="loaded"){lastPoint=spec.importCacheList.length;spec.importCacheStore[ns]=true;checkDepend()}};document.getElementsByTagName("HEAD")[0].appendChild(js)};that.register=function(ns,maker,shortName){spec.dependCacheList[ns]={args:arguments,depend:spec.importCacheList.slice(lastPoint,spec.importCacheList.length),"short":shortName};lastPoint=spec.importCacheList.length;checkDepend()};that.regShort=function(sname,sfun){if(that[sname]!==undefined){throw sname+":show has been register"}that[sname]=sfun};that.setBaseURL=function(url){baseURL=url};that.getErrorInfo=function(){return errorInfo};that.IE=/msie/i.test(navigator.userAgent);that.E=E;that.C=function(tagName){var dom;tagName=tagName.toUpperCase();if(tagName=="TEXT"){dom=document.createTextNode("")}else{if(tagName=="BUFFER"){dom=document.createDocumentFragment()}else{dom=document.createElement(tagName)}}return dom};that.Ready=(function(){var funcList=[];var inited=false;var exec_func_list=function(){if(inited==true){return}inited=true;for(var i=0,len=funcList.length;i<len;i++){if((typeof funcList[i]).toLowerCase()=="function"){funcList[i].call()}}funcList=[]};if(document.attachEvent&&window==window.top){(function(){try{document.documentElement.doScroll("left")}catch(e){setTimeout(arguments.callee,0);return}exec_func_list()})()}else{if(document.addEventListener){addEvent(document,"DOMContentLoaded",exec_func_list)}else{if(/WebKit/i.test(navigator.userAgent)){(function(){if(/loaded|complete/.test(document.readyState.toLowerCase())){exec_func_list();return}setTimeout(arguments.callee,25)})()}}}addEvent(window,"load",exec_func_list);return function(oFunc){if(inited==true||(document.readyState&&(/loaded|complete/).test(document.readyState.toLowerCase()))){if((typeof oFunc).toLowerCase()=="function"){oFunc.call()}}else{funcList.push(oFunc)}}})();return that})();$Import=STK.inc;STK.register("core.util.getUniqueKey",function($){var _loadTime=(new Date()).getTime().toString(),_i=1;return function(){return _loadTime+(_i++)}});STK.register("core.dom.getStyle",function($){return function(node,property){if($.IE){switch(property){case"opacity":var val=100;try{val=node.filters["DXImageTransform.Microsoft.Alpha"].opacity}catch(e){try{val=node.filters("alpha").opacity}catch(e){}}return val/100;case"float":property="styleFloat";default:var value=node.currentStyle?node.currentStyle[property]:null;return(node.style[property]||value)}}else{if(property=="float"){property="cssFloat"}try{var computed=document.defaultView.getComputedStyle(node,"")}catch(e){}return node.style[property]||computed?computed[property]:null}}});STK.register("core.dom.setStyle",function($){return function(node,property,val){if($.IE){switch(property){case"opacity":node.style.filter="alpha(opacity="+(val*100)+")";if(!node.currentStyle||!node.currentStyle.hasLayout){node.style.zoom=1}break;case"float":property="styleFloat";default:node.style[property]=val}}else{if(property=="float"){property="cssFloat"}node.style[property]=val}}});STK.register("core.func.getType",function($){return function(oObject){var _t;return((_t=typeof(oObject))=="object"?oObject==null&&"null"||Object.prototype.toString.call(oObject).slice(8,-1):_t).toLowerCase()}});STK.register("core.dom.uniqueID",function($){return function(node){return node&&(node.uniqueID||(node.uniqueID=$.core.util.getUniqueKey()))}});STK.register("core.arr.isArray",function($){return function(o){return Object.prototype.toString.call(o)==="[object Array]"}});STK.register("core.arr.findout",function($){return function(o,value){if(!$.core.arr.isArray(o)){throw"the findout function needs an array as first parameter"}var k=[];for(var i=0,len=o.length;i<len;i+=1){if(o[i]===value){k.push(i)}}return k}});STK.register("core.arr.clear",function($){return function(o){if(!$.core.arr.isArray(o)){throw"the clear function needs an array as first parameter"}var result=[];for(var i=0,len=o.length;i<len;i+=1){if(!($.core.arr.findout([undefined,null,""],o[i]).length)){result.push(o[i])}}return result}});STK.register("core.arr.copy",function($){return function(o){if(!$.core.arr.isArray(o)){throw"the copy function needs an array as first parameter"}return o.slice(0)}});STK.register("core.arr.foreach",function($){return function(o,insp){if(!$.core.arr.isArray(o)){throw"the foreach function needs an array as first parameter"}var r=[];for(var i=0,len=o.length;i<len;i+=1){var x=insp(o[i],i);if(x===false){break}else{if(x!==null){r[i]=x}}}return r}});STK.register("core.arr.hasby",function($){return function(o,insp){if(!$.core.arr.isArray(o)){throw"the hasBy function needs an array as first parameter"}var k=[];for(var i=0,len=o.length;i<len;i+=1){if(insp(o[i],i)){k.push(i)}}return k}});STK.register("core.arr.indexOf",function($){return function(oElement,aSource){if(aSource.indexOf){return aSource.indexOf(oElement)}for(var i=0,len=aSource.length;i<len;i++){if(aSource[i]===oElement){return i}}return -1}});STK.register("core.arr.inArray",function($){return function(oElement,aSource){return $.core.arr.indexOf(oElement,aSource)>-1}});STK.register("core.arr.unique",function($){return function(o){if(!$.core.arr.isArray(o)){throw"the unique function needs an array as first parameter"}var result=[];for(var i=0,len=o.length;i<len;i+=1){if($.core.arr.indexOf(o[i],result)===-1){result.push(o[i])}}return result}});STK.register("core.dom.hasClassName",function($){return function(node,className){return(new RegExp("\\b"+className+"\\b").test(node.className))}});STK.register("core.dom.addClassName",function($){return function(node,className){if(node.nodeType===1){if(!$.core.dom.hasClassName(node,className)){var _cn=$.core.str.trim(node.className+" "+className);node.className=_cn}}}});STK.register("core.dom.addHTML",function($){return function(node,html){if($.IE){node.insertAdjacentHTML("BeforeEnd",html)}else{var oRange=node.ownerDocument.createRange();oRange.setStartBefore(node);var oFrag=oRange.createContextualFragment(html);node.appendChild(oFrag)}}});STK.register("core.dom.builder",function($){function autoDeploy(sHTML,oSelector){if(oSelector){return oSelector}var result,re=/\<(\w+)[^>]*\s+node-type\s*=\s*([\'\"])?(\w+)\2.*?>/g;var selectorList={};var node,tag,selector;while((result=re.exec(sHTML))){tag=result[1];node=result[3];selector=tag+"[node-type="+node+"]";selectorList[node]=selectorList[node]==null?[]:selectorList[node];if(!$.core.arr.inArray(selector,selectorList[node])){selectorList[node].push(tag+"[node-type="+node+"]")}}return selectorList}return function(sHTML,oSelector){var selectorList=autoDeploy(sHTML,oSelector);var container=$.C("div");container.innerHTML=sHTML;var key,domList={};for(key in selectorList){domList[key]=$.core.dom.sizzle(selectorList[key].toString(),container)}var domBox=$.C("buffer");while(container.children[0]){domBox.appendChild(container.children[0])}return{box:domBox,list:domList}}});STK.register("core.obj.beget",function($){return function(o){var F=function(){};F.prototype=o;return new F()}});STK.register("core.dom.insertAfter",function($){return function(node,target){var parent=target.parentNode;if(parent.lastChild==target){parent.appendChild(node)}else{parent.insertBefore(node,target.nextSibling)}}});STK.register("core.dom.insertBefore",function($){return function(node,target){var parent=target.parentNode;parent.insertBefore(node,target)}});STK.register("core.dom.removeClassName",function($){return function(node,className){if(node.nodeType===1){if($.core.dom.hasClassName(node,className)){node.className=$.core.str.trim(node.className.replace(new RegExp("\\b"+className+"\\b")," "))}}}});STK.register("core.dom.trimNode",function($){return function(node){var cn=node.childNodes;for(var i=0;i<cn.length;i++){if(cn[i].nodeType==3||cn[i].nodeType==8){node.removeChild(cn[i])}}}});STK.register("core.dom.removeNode",function($){return function(node){node=$.E(node)||node;try{node.parentNode.removeChild(node)}catch(e){}}});STK.register("core.evt.addEvent",function($){return function(sNode,sEventType,oFunc){var oElement=$.E(sNode);if(oElement==null){return false}sEventType=sEventType||"click";if((typeof oFunc).toLowerCase()!="function"){return}if(oElement.attachEvent){oElement.attachEvent("on"+sEventType,oFunc)}else{if(oElement.addEventListener){oElement.addEventListener(sEventType,oFunc,false)}else{oElement["on"+sEventType]=oFunc}}return true}});STK.register("core.evt.removeEvent",function($){return function(el,evType,func,useCapture){var _el=$.E(el);if(_el==null){return false}if(typeof func!="function"){return false}if(_el.detachEvent){_el.detachEvent("on"+evType,func)}else{if(_el.removeEventListener){_el.removeEventListener(evType,func,useCapture)}else{_el["on"+evType]=null}}return true}});STK.register("core.evt.fireEvent",function($){return function(el,sEvent){_el=$.E(el);if($.IE){_el.fireEvent("on"+sEvent)}else{var evt=document.createEvent("HTMLEvents");evt.initEvent(sEvent,true,true);_el.dispatchEvent(evt)}}});STK.register("core.util.browser",function($){var ua=navigator.userAgent.toLowerCase();var ret={IE:/msie/.test(ua),OPERA:/opera/.test(ua),MOZ:/gecko/.test(ua),IE5:/msie 5 /.test(ua),IE55:/msie 5.5/.test(ua),IE6:/msie 6/.test(ua),IE7:/msie 7/.test(ua),SAFARI:/safari/.test(ua)};return ret});STK.register("core.dom.position",function($){return function(oElement){if(oElement==document.body){return false}if(oElement.parentNode==null){return false}if(oElement.style.display=="none"){return false}var parent=null,pos=[],box;var scrollTop,scrollLeft,borderLeft,borderTop;if(oElement.getBoundingClientRect){box=oElement.getBoundingClientRect();scrollTop=Math.max(document.documentElement.scrollTop,document.body.scrollTop);scrollLeft=Math.max(document.documentElement.scrollLeft,document.body.scrollLeft);var doc=oElement.ownerDocument;var body=doc.body;var docElem=doc.documentElement;var clientTop=docElem.clientTop||body.clientTop||0;var clientLeft=docElem.clientLeft||body.clientLeft||0;return{l:parseInt(box.left+scrollLeft-clientLeft,10)||0,t:parseInt(box.top+scrollTop-clientTop,10)||0}}else{if(document.getBoxObjectFor){box=document.getBoxObjectFor(oElement);borderLeft=(oElement.style.borderLeftWidth)?parseInt(oElement.style.borderLeftWidth,10):0;borderTop=(oElement.style.borderTopWidth)?parseInt(oElement.style.borderTopWidth,10):0;pos=[box.x-borderLeft,box.y-borderTop]}else{pos=[oElement.offsetLeft,oElement.offsetTop];parent=oElement.offsetParent;if(parent!=oElement){while(parent){pos[0]+=parent.offsetLeft;pos[1]+=parent.offsetTop;parent=parent.offsetParent}}if($.core.util.browser.OPERA!=-1||($.core.util.browser.SAFARI!=-1&&oElement.style.position=="absolute")){pos[0]-=document.body.offsetLeft;pos[1]-=document.body.offsetTop}}}if(oElement.parentNode){parent=oElement.parentNode}else{parent=null}while(parent&&!/^body|html$/i.test(parent.tagName)){if(parent.style.display.search(/^inline|table-row.*$/i)){pos[0]-=parent.scrollLeft;pos[1]-=parent.scrollTop}parent=parent.parentNode}return{l:parseInt(pos[0],10),t:parseInt(pos[1],10)}}});STK.register("core.dom.setXY",function($){return function(node,pos){var pos_style=$.core.dom.getStyle(node,"position");if(pos_style=="static"){$.core.dom.setStyle(node,"position","relative");pos_style="relative"}var page_xy=$.core.dom.position(node);if(page_xy==false){return}var delta={l:parseInt($.core.dom.getStyle(node,"left"),10),t:parseInt($.core.dom.getStyle(node,"top"),10)};if(isNaN(delta.l)){delta.l=(pos_style=="relative")?0:node.offsetLeft}if(isNaN(delta.t)){delta.t=(pos_style=="relative")?0:node.offsetTop}if(pos.l!=null){node.style.left=pos.l-page_xy.l+delta.l+"px"}if(pos.t!=null){node.style.top=pos.t-page_xy.t+delta.t+"px"}}});STK.register("core.str.encodeHTML",function($){return function(str){if(typeof str!=="string"){throw"encodeHTML need a string as parameter"}return str.replace(/\&/g,"&amp;").replace(/"/g,"&quot;").replace(/\</g,"&lt;").replace(/\>/g,"&gt;").replace(/\'/g,"&#39").replace(/\u00A0/g,"&nbsp;").replace(/(\u0020|\u000B|\u2028|\u2029|\f)/g,"&#32")}});STK.register("core.str.decodeHTML",function($){return function(str){if(typeof str!=="string"){throw"decodeHTML need a string as parameter"}return str.replace(/&quot;/g,'"').replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&#39/g,"'").replace(/&nbsp;/g,"\u00A0").replace(/&#32/g,"\u0020").replace(/&amp;/g,"&")}});STK.register("core.dom.cascadeNode",function($){return function(node){var that=$.core.obj.beget(node);var display=node.style.display||"";display=(display==="none"?"":display);that.setStyle=function(property,value){$.core.dom.setStyle(node,property,value);if(property==="display"){display=(value==="none"?"":value)}return that};that.insertAfter=function(el){$.core.dom.insertAfter(el,node);return that};that.insertBefore=function(el){$.core.dom.insertBefore(el,node);return that};that.addClassName=function(cn){$.core.dom.addClassName(node,cn);return that};that.removeClassName=function(cn){$.core.dom.removeClassName(node,cn);return that};that.trimNode=function(){$.core.dom.trimNode(node);return that};that.removeNode=function(){$.core.dom.removeNode(node);return that};that.on=function(type,func){$.core.evt.addEvent(node,type,func);return that};that.unon=function(type,func){$.core.evt.removeEvent(node,func,type);return that};that.fire=function(type){$.core.evt.fireEvent(type,node);return that};that.appendChild=function(el){node.appendChild(el);return that};that.removeChild=function(el){node.removeChild(el);return that};that.toggle=function(){if(node.style.display==="none"){node.style.display=display}else{node.style.display="none"}return that};that.show=function(){if(node.style.display==="none"){if(display==="none"){node.style.display=""}else{node.style.display=display}}return that};that.hidd=function(){if(node.style.display!=="none"){node.style.display="none"}return that};that.hide=that.hidd;that.scrollTo=function(type,value){if(type==="left"){node.scrollLeft=value}if(type==="top"){node.scrollTop=value}return that};that.replaceChild=function(newNode,oldNode){node.replaceChild(newNode,oldNode);return that};that.position=function(args){if(args!==undefined){$.core.dom.setXY(node,args)}return $.core.dom.position(node)};that.html=function(html){if(html!==undefined){node.innerHTML=html}return node.innerHTML};that.ttext=function(text){if(text!==undefined){node.innerHTML=$.core.str.encodeHTML(text)}return $.core.str.decodeHTML(node.innerHTML)};that.get=function(key){if(key==="node"){return node}return $.core.dom.getStyle(node,key)};return that}});STK.register("core.dom.contains",function($){return function(parent,node){if(parent===node){return false}else{if(parent.compareDocumentPosition){return((parent.compareDocumentPosition(node)&16)===16)}else{if(parent.contains&&node.nodeType===1){return parent.contains(node)}else{while(node=node.parentNode){if(parent===node){return true}}}}}return false}});STK.register("core.dom.insertHTML",function($){return function(node,html,where){node=$.E(node)||document.body;where=where?where.toLowerCase():"beforeend";if(node.insertAdjacentHTML){switch(where){case"beforebegin":node.insertAdjacentHTML("BeforeBegin",html);return node.previousSibling;case"afterbegin":node.insertAdjacentHTML("AfterBegin",html);return node.firstChild;case"beforeend":node.insertAdjacentHTML("BeforeEnd",html);return node.lastChild;case"afterend":node.insertAdjacentHTML("AfterEnd",html);return node.nextSibling}throw'Illegal insertion point -> "'+where+'"'}else{var range=node.ownerDocument.createRange();var frag;switch(where){case"beforebegin":range.setStartBefore(node);frag=range.createContextualFragment(html);node.parentNode.insertBefore(frag,node);return node.previousSibling;case"afterbegin":if(node.firstChild){range.setStartBefore(node.firstChild);frag=range.createContextualFragment(html);node.insertBefore(frag,node.firstChild);return node.firstChild}else{node.innerHTML=html;return node.firstChild}break;case"beforeend":if(node.lastChild){range.setStartAfter(node.lastChild);frag=range.createContextualFragment(html);node.appendChild(frag);return node.lastChild}else{node.innerHTML=html;return node.lastChild}break;case"afterend":range.setStartAfter(node);frag=range.createContextualFragment(html);node.parentNode.insertBefore(frag,node.nextSibling);return node.nextSibling}throw'Illegal insertion point -> "'+where+'"'}}});STK.register("core.dom.insertElement",function($){return function(node,element,where){node=$.E(node)||document.body;where=where?where.toLowerCase():"beforeend";switch(where){case"beforebegin":node.parentNode.insertBefore(element,node);break;case"afterbegin":node.insertBefore(element,node.firstChild);break;case"beforeend":node.appendChild(element);break;case"afterend":if(node.nextSibling){node.parentNode.insertBefore(element,node.nextSibling)}else{node.parentNode.appendChild(element)}break}}});STK.register("core.dom.isNode",function($){return function(node){return(node!=undefined)&&Boolean(node.nodeName)&&Boolean(node.nodeType)}});STK.register("core.dom.next",function($){return function(node){var next=node.nextSibling;if(!next){return null}else{if(next.nodeType!==1){next=arguments.callee(next)}}return next}});STK.register("core.dom.prev",function($){return function(node){var prev=node.previousSibling;if(!prev){return null}else{if(prev.nodeType!==1){prev=arguments.callee(prev)}}return prev}});STK.register("core.dom.replaceNode",function($){return function(node,original){if(node==null||original==null){throw"replaceNode need node as paramster"}original.parentNode.replaceChild(node,original)}});STK.register("core.dom.sizzle",function($){var chunker=/((?:\((?:\([^()]+\)|[^()]+)+\)|\[(?:\[[^\[\]]*\]|['"][^'"]*['"]|[^\[\]'"]+)+\]|\\.|[^ >+~,(\[\\]+)+|[>+~])(\s*,\s*)?((?:.|\r|\n)*)/g,done=0,toString=Object.prototype.toString,hasDuplicate=false,baseHasDuplicate=true;[0,0].sort(function(){baseHasDuplicate=false;return 0});var Sizzle=function(selector,context,results,seed){results=results||[];context=context||document;var origContext=context;if(context.nodeType!==1&&context.nodeType!==9){return[]}if(!selector||typeof selector!=="string"){return results}var parts=[],m,set,checkSet,extra,prune=true,contextXML=Sizzle.isXML(context),soFar=selector,ret,cur,pop,i;do{chunker.exec("");m=chunker.exec(soFar);if(m){soFar=m[3];parts.push(m[1]);if(m[2]){extra=m[3];break}}}while(m);if(parts.length>1&&origPOS.exec(selector)){if(parts.length===2&&Expr.relative[parts[0]]){set=posProcess(parts[0]+parts[1],context)}else{set=Expr.relative[parts[0]]?[context]:Sizzle(parts.shift(),context);while(parts.length){selector=parts.shift();if(Expr.relative[selector]){selector+=parts.shift()}set=posProcess(selector,set)}}}else{if(!seed&&parts.length>1&&context.nodeType===9&&!contextXML&&Expr.match.ID.test(parts[0])&&!Expr.match.ID.test(parts[parts.length-1])){ret=Sizzle.find(parts.shift(),context,contextXML);context=ret.expr?Sizzle.filter(ret.expr,ret.set)[0]:ret.set[0]}if(context){ret=seed?{expr:parts.pop(),set:makeArray(seed)}:Sizzle.find(parts.pop(),parts.length===1&&(parts[0]==="~"||parts[0]==="+")&&context.parentNode?context.parentNode:context,contextXML);set=ret.expr?Sizzle.filter(ret.expr,ret.set):ret.set;if(parts.length>0){checkSet=makeArray(set)}else{prune=false}while(parts.length){cur=parts.pop();pop=cur;if(!Expr.relative[cur]){cur=""}else{pop=parts.pop()}if(pop==null){pop=context}Expr.relative[cur](checkSet,pop,contextXML)}}else{checkSet=parts=[]}}if(!checkSet){checkSet=set}if(!checkSet){Sizzle.error(cur||selector)}if(toString.call(checkSet)==="[object Array]"){if(!prune){results.push.apply(results,checkSet)}else{if(context&&context.nodeType===1){for(i=0;checkSet[i]!=null;i++){if(checkSet[i]&&(checkSet[i]===true||checkSet[i].nodeType===1&&Sizzle.contains(context,checkSet[i]))){results.push(set[i])}}}else{for(i=0;checkSet[i]!=null;i++){if(checkSet[i]&&checkSet[i].nodeType===1){results.push(set[i])}}}}}else{makeArray(checkSet,results)}if(extra){Sizzle(extra,origContext,results,seed);Sizzle.uniqueSort(results)}return results};Sizzle.uniqueSort=function(results){if(sortOrder){hasDuplicate=baseHasDuplicate;results.sort(sortOrder);if(hasDuplicate){for(var i=1;i<results.length;i++){if(results[i]===results[i-1]){results.splice(i--,1)}}}}return results};Sizzle.matches=function(expr,set){return Sizzle(expr,null,null,set)};Sizzle.find=function(expr,context,isXML){var set;if(!expr){return[]}for(var i=0,l=Expr.order.length;i<l;i++){var type=Expr.order[i],match;if((match=Expr.leftMatch[type].exec(expr))){var left=match[1];match.splice(1,1);if(left.substr(left.length-1)!=="\\"){match[1]=(match[1]||"").replace(/\\/g,"");set=Expr.find[type](match,context,isXML);if(set!=null){expr=expr.replace(Expr.match[type],"");break}}}}if(!set){set=context.getElementsByTagName("*")}return{set:set,expr:expr}};Sizzle.filter=function(expr,set,inplace,not){var old=expr,result=[],curLoop=set,match,anyFound,isXMLFilter=set&&set[0]&&Sizzle.isXML(set[0]);while(expr&&set.length){for(var type in Expr.filter){if((match=Expr.leftMatch[type].exec(expr))!=null&&match[2]){var filter=Expr.filter[type],found,item,left=match[1];anyFound=false;match.splice(1,1);if(left.substr(left.length-1)==="\\"){continue}if(curLoop===result){result=[]}if(Expr.preFilter[type]){match=Expr.preFilter[type](match,curLoop,inplace,result,not,isXMLFilter);if(!match){anyFound=found=true}else{if(match===true){continue}}}if(match){for(var i=0;(item=curLoop[i])!=null;i++){if(item){found=filter(item,match,i,curLoop);var pass=not^!!found;if(inplace&&found!=null){if(pass){anyFound=true}else{curLoop[i]=false}}else{if(pass){result.push(item);anyFound=true}}}}}if(found!==undefined){if(!inplace){curLoop=result}expr=expr.replace(Expr.match[type],"");if(!anyFound){return[]}break}}}if(expr===old){if(anyFound==null){Sizzle.error(expr)}else{break}}old=expr}return curLoop};Sizzle.error=function(msg){throw"Syntax error, unrecognized expression: "+msg};var Expr={order:["ID","NAME","TAG"],match:{ID:/#((?:[\w\u00c0-\uFFFF\-]|\\.)+)/,CLASS:/\.((?:[\w\u00c0-\uFFFF\-]|\\.)+)/,NAME:/\[name=['"]*((?:[\w\u00c0-\uFFFF\-]|\\.)+)['"]*\]/,ATTR:/\[\s*((?:[\w\u00c0-\uFFFF\-]|\\.)+)\s*(?:(\S?=)\s*(['"]*)(.*?)\3|)\s*\]/,TAG:/^((?:[\w\u00c0-\uFFFF\*\-]|\\.)+)/,CHILD:/:(only|nth|last|first)-child(?:\((even|odd|[\dn+\-]*)\))?/,POS:/:(nth|eq|gt|lt|first|last|even|odd)(?:\((\d*)\))?(?=[^\-]|$)/,PSEUDO:/:((?:[\w\u00c0-\uFFFF\-]|\\.)+)(?:\((['"]?)((?:\([^\)]+\)|[^\(\)]*)+)\2\))?/},leftMatch:{},attrMap:{"class":"className","for":"htmlFor"},attrHandle:{href:function(elem){return elem.getAttribute("href")}},relative:{"+":function(checkSet,part){var isPartStr=typeof part==="string",isTag=isPartStr&&!/\W/.test(part),isPartStrNotTag=isPartStr&&!isTag;if(isTag){part=part.toLowerCase()}for(var i=0,l=checkSet.length,elem;i<l;i++){if((elem=checkSet[i])){while((elem=elem.previousSibling)&&elem.nodeType!==1){}checkSet[i]=isPartStrNotTag||elem&&elem.nodeName.toLowerCase()===part?elem||false:elem===part}}if(isPartStrNotTag){Sizzle.filter(part,checkSet,true)}},">":function(checkSet,part){var isPartStr=typeof part==="string",elem,i=0,l=checkSet.length;if(isPartStr&&!/\W/.test(part)){part=part.toLowerCase();for(;i<l;i++){elem=checkSet[i];if(elem){var parent=elem.parentNode;checkSet[i]=parent.nodeName.toLowerCase()===part?parent:false}}}else{for(;i<l;i++){elem=checkSet[i];if(elem){checkSet[i]=isPartStr?elem.parentNode:elem.parentNode===part}}if(isPartStr){Sizzle.filter(part,checkSet,true)}}},"":function(checkSet,part,isXML){var doneName=done++,checkFn=dirCheck,nodeCheck;if(typeof part==="string"&&!/\W/.test(part)){part=part.toLowerCase();nodeCheck=part;checkFn=dirNodeCheck}checkFn("parentNode",part,doneName,checkSet,nodeCheck,isXML)},"~":function(checkSet,part,isXML){var doneName=done++,checkFn=dirCheck,nodeCheck;if(typeof part==="string"&&!/\W/.test(part)){part=part.toLowerCase();nodeCheck=part;checkFn=dirNodeCheck}checkFn("previousSibling",part,doneName,checkSet,nodeCheck,isXML)}},find:{ID:function(match,context,isXML){if(typeof context.getElementById!=="undefined"&&!isXML){var m=context.getElementById(match[1]);return m?[m]:[]}},NAME:function(match,context){if(typeof context.getElementsByName!=="undefined"){var ret=[],results=context.getElementsByName(match[1]);for(var i=0,l=results.length;i<l;i++){if(results[i].getAttribute("name")===match[1]){ret.push(results[i])}}return ret.length===0?null:ret}},TAG:function(match,context){return context.getElementsByTagName(match[1])}},preFilter:{CLASS:function(match,curLoop,inplace,result,not,isXML){match=" "+match[1].replace(/\\/g,"")+" ";if(isXML){return match}for(var i=0,elem;(elem=curLoop[i])!=null;i++){if(elem){if(not^(elem.className&&(" "+elem.className+" ").replace(/[\t\n]/g," ").indexOf(match)>=0)){if(!inplace){result.push(elem)}}else{if(inplace){curLoop[i]=false}}}}return false},ID:function(match){return match[1].replace(/\\/g,"")},TAG:function(match,curLoop){return match[1].toLowerCase()},CHILD:function(match){if(match[1]==="nth"){var test=/(-?)(\d*)n((?:\+|-)?\d*)/.exec(match[2]==="even"&&"2n"||match[2]==="odd"&&"2n+1"||!/\D/.test(match[2])&&"0n+"+match[2]||match[2]);match[2]=(test[1]+(test[2]||1))-0;match[3]=test[3]-0}match[0]=done++;return match},ATTR:function(match,curLoop,inplace,result,not,isXML){var name=match[1].replace(/\\/g,"");if(!isXML&&Expr.attrMap[name]){match[1]=Expr.attrMap[name]}if(match[2]==="~="){match[4]=" "+match[4]+" "}return match},PSEUDO:function(match,curLoop,inplace,result,not){if(match[1]==="not"){if((chunker.exec(match[3])||"").length>1||/^\w/.test(match[3])){match[3]=Sizzle(match[3],null,null,curLoop)}else{var ret=Sizzle.filter(match[3],curLoop,inplace,true^not);if(!inplace){result.push.apply(result,ret)}return false}}else{if(Expr.match.POS.test(match[0])||Expr.match.CHILD.test(match[0])){return true}}return match},POS:function(match){match.unshift(true);return match}},filters:{enabled:function(elem){return elem.disabled===false&&elem.type!=="hidden"},disabled:function(elem){return elem.disabled===true},checked:function(elem){return elem.checked===true},selected:function(elem){elem.parentNode.selectedIndex;return elem.selected===true},parent:function(elem){return !!elem.firstChild},empty:function(elem){return !elem.firstChild},has:function(elem,i,match){return !!Sizzle(match[3],elem).length},header:function(elem){return(/h\d/i).test(elem.nodeName)},text:function(elem){return"text"===elem.type},radio:function(elem){return"radio"===elem.type},checkbox:function(elem){return"checkbox"===elem.type},file:function(elem){return"file"===elem.type},password:function(elem){return"password"===elem.type},submit:function(elem){return"submit"===elem.type},image:function(elem){return"image"===elem.type},reset:function(elem){return"reset"===elem.type},button:function(elem){return"button"===elem.type||elem.nodeName.toLowerCase()==="button"},input:function(elem){return(/input|select|textarea|button/i).test(elem.nodeName)}},setFilters:{first:function(elem,i){return i===0},last:function(elem,i,match,array){return i===array.length-1},even:function(elem,i){return i%2===0},odd:function(elem,i){return i%2===1},lt:function(elem,i,match){return i<match[3]-0},gt:function(elem,i,match){return i>match[3]-0},nth:function(elem,i,match){return match[3]-0===i},eq:function(elem,i,match){return match[3]-0===i}},filter:{PSEUDO:function(elem,match,i,array){var name=match[1],filter=Expr.filters[name];if(filter){return filter(elem,i,match,array)}else{if(name==="contains"){return(elem.textContent||elem.innerText||Sizzle.getText([elem])||"").indexOf(match[3])>=0}else{if(name==="not"){var not=match[3];for(var j=0,l=not.length;j<l;j++){if(not[j]===elem){return false}}return true}else{Sizzle.error("Syntax error, unrecognized expression: "+name)}}}},CHILD:function(elem,match){var type=match[1],node=elem;switch(type){case"only":case"first":while((node=node.previousSibling)){if(node.nodeType===1){return false}}if(type==="first"){return true}node=elem;case"last":while((node=node.nextSibling)){if(node.nodeType===1){return false}}return true;case"nth":var first=match[2],last=match[3];if(first===1&&last===0){return true}var doneName=match[0],parent=elem.parentNode;if(parent&&(parent.sizcache!==doneName||!elem.nodeIndex)){var count=0;for(node=parent.firstChild;node;node=node.nextSibling){if(node.nodeType===1){node.nodeIndex=++count}}parent.sizcache=doneName}var diff=elem.nodeIndex-last;if(first===0){return diff===0}else{return(diff%first===0&&diff/first>=0)}}},ID:function(elem,match){return elem.nodeType===1&&elem.getAttribute("id")===match},TAG:function(elem,match){return(match==="*"&&elem.nodeType===1)||elem.nodeName.toLowerCase()===match},CLASS:function(elem,match){return(" "+(elem.className||elem.getAttribute("class"))+" ").indexOf(match)>-1},ATTR:function(elem,match){var name=match[1],result=Expr.attrHandle[name]?Expr.attrHandle[name](elem):elem[name]!=null?elem[name]:elem.getAttribute(name),value=result+"",type=match[2],check=match[4];return result==null?type==="!=":type==="="?value===check:type==="*="?value.indexOf(check)>=0:type==="~="?(" "+value+" ").indexOf(check)>=0:!check?value&&result!==false:type==="!="?value!==check:type==="^="?value.indexOf(check)===0:type==="$="?value.substr(value.length-check.length)===check:type==="|="?value===check||value.substr(0,check.length+1)===check+"-":false},POS:function(elem,match,i,array){var name=match[2],filter=Expr.setFilters[name];if(filter){return filter(elem,i,match,array)}}}};Sizzle.selectors=Expr;var origPOS=Expr.match.POS,fescape=function(all,num){return"\\"+(num-0+1)};for(var type in Expr.match){Expr.match[type]=new RegExp(Expr.match[type].source+(/(?![^\[]*\])(?![^\(]*\))/.source));Expr.leftMatch[type]=new RegExp(/(^(?:.|\r|\n)*?)/.source+Expr.match[type].source.replace(/\\(\d+)/g,fescape))}var makeArray=function(array,results){array=Array.prototype.slice.call(array,0);if(results){results.push.apply(results,array);return results}return array};try{Array.prototype.slice.call(document.documentElement.childNodes,0)[0].nodeType}catch(e){makeArray=function(array,results){var ret=results||[],i=0;if(toString.call(array)==="[object Array]"){Array.prototype.push.apply(ret,array)}else{if(typeof array.length==="number"){for(var l=array.length;i<l;i++){ret.push(array[i])}}else{for(;array[i];i++){ret.push(array[i])}}}return ret}}var sortOrder;if(document.documentElement.compareDocumentPosition){sortOrder=function(a,b){if(!a.compareDocumentPosition||!b.compareDocumentPosition){if(a==b){hasDuplicate=true}return a.compareDocumentPosition?-1:1}var ret=a.compareDocumentPosition(b)&4?-1:a===b?0:1;if(ret===0){hasDuplicate=true}return ret}}else{if("sourceIndex" in document.documentElement){sortOrder=function(a,b){if(!a.sourceIndex||!b.sourceIndex){if(a==b){hasDuplicate=true}return a.sourceIndex?-1:1}var ret=a.sourceIndex-b.sourceIndex;if(ret===0){hasDuplicate=true}return ret}}else{if(document.createRange){sortOrder=function(a,b){if(!a.ownerDocument||!b.ownerDocument){if(a==b){hasDuplicate=true}return a.ownerDocument?-1:1}var aRange=a.ownerDocument.createRange(),bRange=b.ownerDocument.createRange();aRange.setStart(a,0);aRange.setEnd(a,0);bRange.setStart(b,0);bRange.setEnd(b,0);var ret=aRange.compareBoundaryPoints(Range.START_TO_END,bRange);if(ret===0){hasDuplicate=true}return ret}}}}Sizzle.getText=function(elems){var ret="",elem;for(var i=0;elems[i];i++){elem=elems[i];if(elem.nodeType===3||elem.nodeType===4){ret+=elem.nodeValue}else{if(elem.nodeType!==8){ret+=Sizzle.getText(elem.childNodes)}}}return ret};(function(){var form=document.createElement("div"),id="script"+(new Date()).getTime();form.innerHTML="<a name='"+id+"'/>";var root=document.documentElement;root.insertBefore(form,root.firstChild);if(document.getElementById(id)){Expr.find.ID=function(match,context,isXML){if(typeof context.getElementById!=="undefined"&&!isXML){var m=context.getElementById(match[1]);return m?m.id===match[1]||typeof m.getAttributeNode!=="undefined"&&m.getAttributeNode("id").nodeValue===match[1]?[m]:undefined:[]}};Expr.filter.ID=function(elem,match){var node=typeof elem.getAttributeNode!=="undefined"&&elem.getAttributeNode("id");return elem.nodeType===1&&node&&node.nodeValue===match}}root.removeChild(form);root=form=null})();(function(){var div=document.createElement("div");div.appendChild(document.createComment(""));if(div.getElementsByTagName("*").length>0){Expr.find.TAG=function(match,context){var results=context.getElementsByTagName(match[1]);if(match[1]==="*"){var tmp=[];for(var i=0;results[i];i++){if(results[i].nodeType===1){tmp.push(results[i])}}results=tmp}return results}}div.innerHTML="<a href='#'></a>";if(div.firstChild&&typeof div.firstChild.getAttribute!=="undefined"&&div.firstChild.getAttribute("href")!=="#"){Expr.attrHandle.href=function(elem){return elem.getAttribute("href",2)}}div=null})();if(document.querySelectorAll){(function(){var oldSizzle=Sizzle,div=document.createElement("div");div.innerHTML="<p class='TEST'></p>";if(div.querySelectorAll&&div.querySelectorAll(".TEST").length===0){return}Sizzle=function(query,context,extra,seed){context=context||document;if(!seed&&context.nodeType===9&&!Sizzle.isXML(context)){try{return makeArray(context.querySelectorAll(query),extra)}catch(e){}}return oldSizzle(query,context,extra,seed)};for(var prop in oldSizzle){Sizzle[prop]=oldSizzle[prop]}div=null})()}(function(){var div=document.createElement("div");div.innerHTML="<div class='test e'></div><div class='test'></div>";if(!div.getElementsByClassName||div.getElementsByClassName("e").length===0){return}div.lastChild.className="e";if(div.getElementsByClassName("e").length===1){return}Expr.order.splice(1,0,"CLASS");Expr.find.CLASS=function(match,context,isXML){if(typeof context.getElementsByClassName!=="undefined"&&!isXML){return context.getElementsByClassName(match[1])}};div=null})();function dirNodeCheck(dir,cur,doneName,checkSet,nodeCheck,isXML){for(var i=0,l=checkSet.length;i<l;i++){var elem=checkSet[i];if(elem){elem=elem[dir];var match=false;while(elem){if(elem.sizcache===doneName){match=checkSet[elem.sizset];break}if(elem.nodeType===1&&!isXML){elem.sizcache=doneName;elem.sizset=i}if(elem.nodeName.toLowerCase()===cur){match=elem;break}elem=elem[dir]}checkSet[i]=match}}}function dirCheck(dir,cur,doneName,checkSet,nodeCheck,isXML){for(var i=0,l=checkSet.length;i<l;i++){var elem=checkSet[i];if(elem){elem=elem[dir];var match=false;while(elem){if(elem.sizcache===doneName){match=checkSet[elem.sizset];break}if(elem.nodeType===1){if(!isXML){elem.sizcache=doneName;elem.sizset=i}if(typeof cur!=="string"){if(elem===cur){match=true;break}}else{if(Sizzle.filter(cur,[elem]).length>0){match=elem;break}}}elem=elem[dir]}checkSet[i]=match}}}Sizzle.contains=document.compareDocumentPosition?function(a,b){return !!(a.compareDocumentPosition(b)&16)}:function(a,b){return a!==b&&(a.contains?a.contains(b):true)};Sizzle.isXML=function(elem){var documentElement=(elem?elem.ownerDocument||elem:0).documentElement;return documentElement?documentElement.nodeName!=="HTML":false};var posProcess=function(selector,context){var tmpSet=[],later="",match,root=context.nodeType?[context]:context;while((match=Expr.match.PSEUDO.exec(selector))){later+=match[0];selector=selector.replace(Expr.match.PSEUDO,"")}selector=Expr.relative[selector]?selector+"*":selector;for(var i=0,l=root.length;i<l;i++){Sizzle(selector,root[i],tmpSet)}return Sizzle.filter(later,tmpSet)};return Sizzle});STK.register("core.dom.selector",function($){var getDomList=function(selector,context,results,seed){var res=[];if(typeof selector==="string"){lis=$.core.dom.sizzle(selector,context,results,seed);for(var i=0,len=lis.length;i<len;i+=1){res[i]=lis[i]}}else{if($.core.dom.isNode(selector)){if(context){if($.core.dom.contains(context,selector)){res=[selector]}}else{res=[selector]}}else{if($.core.arr.isArray(selector)){if(context){for(var i=0,len=selector.length;i<len;i+=1){if($.core.dom.contains(context,selector[i])){res.push(selector[i])}}}else{res=selector}}}}return res};return function(selector,context,results,seed){var that=getDomList.apply(window,arguments);that.on=function(etype,efun){for(var i=0,len=that.length;i<len;i+=1){$.core.evt.addEvent(that[i],etype,efun)}return that};that.css=function(cssKey,cssValue){for(var i=0,len=that.length;i<len;i+=1){$.core.dom.setStyle(that[i],cssKey,cssValue)}return that};that.show=function(){for(var i=0,len=that.length;i<len;i+=1){that[i].style.display=""}return that};that.hidd=function(){for(var i=0,len=that.length;i<len;i+=1){that[i].style.display="none"}return that};that.hide=that.hidd;return that}});STK.register("core.dom.setStyles",function($){return function(nodes,property,val){if(!$.core.arr.isArray(nodes)){var nodes=[nodes]}for(i=0,l=nodes.length;i<l;i++){$.core.dom.setStyle(nodes[i],property,val)}return nodes}});STK.register("core.evt.custEvent",function($){var _oArray=[],_oCache={};var _findObj=function(obj,type){var _key=(typeof obj=="number")?obj:$.core.arr.indexOf(obj,_oArray);return(_oArray[_key])&&{obj:(type?_oCache[_key][type]:_oCache[_key]),key:_key}};return{define:function(obj,type){if(typeof obj!="undefined"&&type){var _key=(typeof obj=="number")?obj:$.core.arr.indexOf(obj,_oArray),_cache;if(!_oArray[_key]){_oArray[(_key=_oArray.length)]=obj;_oCache[_key]={}}_cache=_oCache[_key];_cache[type]||(_cache[type]=[]);return _key}},undefine:function(obj,type){if(typeof obj!="undefined"){var _key=(typeof obj=="number")?obj:$.core.arr.indexOf(obj,_oArray);if(_oArray[_key]){if(type){if(type in _oCache[_key]){delete _oCache[_key][type]}for(var i in _oCache[_key]){return}}_oArray[_key]=undefined;delete _oCache[_key]}}},add:function(obj,type,fn,data){if(typeof obj!="undefined"&&type&&fn){var _cache=_findObj(obj,type);if(!_cache){throw"对该对象的自定义事件("+type+")没有定义!"}_cache.obj.push({fn:fn,data:data});return _cache.key}},remove:function(obj,type,fn){if(typeof obj!="undefined"){var _cache=_findObj(obj,type),_obj;if(_cache&&(_obj=_cache.obj)){if($.core.arr.isArray(_obj)){if(fn){for(var i=0;i<_obj.length&&_obj[i].fn!==fn;i++){}_obj.splice(i,1)}else{_obj.splice(0)}}else{for(var i in _obj){_obj[i]=[]}}return _cache.key}}},fire:function(obj,type,args){if(typeof obj!="undefined"&&type){var _cache=_findObj(obj,type),_obj;if(_cache&&(_obj=_cache.obj)){if(!$.core.arr.isArray(args)){args=args?[args]:[]}for(var i=0;i<_obj.length;i++){var fn=_obj[i].fn;if(fn&&fn.apply){fn.apply(_oArray[_cache.key],[{type:type,data:_obj[i].data}].concat(args))}}return _cache.key}}}}});STK.register("core.evt.fixEvent",function($){return function(e){if(typeof e=="undefined"){e=window.event}if(!e.target){e.target=e.srcElement;e.pageX=e.x;e.pageY=e.y}if(typeof e.layerX=="undefined"){e.layerX=e.offsetX}if(typeof e.layerY=="undefined"){e.layerY=e.offsetY}return e}});STK.register("core.evt.delegatedEvent",function($){return function(actEl,expEl){if(!$.core.dom.isNode(actEl)){throw"core.evt.delegatedEvent need an Element as first Parameter"}var evtList={};var bindEvent=function(e){var evt=$.core.evt.fixEvent(e);var el=evt.target;var type=e.type;if(expEl&&$.core.dom.contains(expEl,el)){return false}else{var actionType=null;while(!(actionType=el.getAttribute("action_type"))&&el!==actEl){el=el.parentNode}if(evtList[type][actionType]){evtList[type][actionType]({evt:evt,el:el,data:$.core.json.queryToJson(el.getAttribute("action_data")||"")})}}};var that={};that.add=function(funcName,evtType,process){if(!evtList[evtType]){evtList[evtType]={};$.core.evt.addEvent(actEl,evtType,bindEvent)}ns=evtList[evtType];ns[funcName]=process};that.remove=function(funcName,evtType){if(evtList[evtType]){delete evtList[evtType][funcName]}};return that}});STK.register("core.evt.getEvent",function($){return function(){if($.IE){return window.event}else{if(window.event){return window.event}var o=arguments.callee.caller;var e;var n=0;while(o!=null&&n<40){e=o.arguments[0];if(e&&(e.constructor==Event||e.constructor==MouseEvent)){return e}n++;o=o.caller}return e}}});STK.register("core.evt.getActiveElement",function($){return function(){try{var evt=$.core.evt.getEvent();return document.activeElement?document.activeElement:evt.explicitOriginalTarget}catch(e){return document.body}}});STK.register("core.util.scrollPos",function($){return function(oDocument){oDocument=oDocument||document;var dd=oDocument.documentElement;var db=oDocument.body;return{top:Math.max(window.pageYOffset||0,dd.scrollTop,db.scrollTop),left:Math.max(window.pageXOffset||0,dd.scrollLeft,db.scrollLeft)}}});STK.register("core.evt.hitTest",function($){function getNodeInfo(oNode){var node=STK.E(oNode);var pos=$.core.dom.position(node);var area={left:pos.l,top:pos.t,right:pos.l+node.offsetWidth,bottom:pos.t+node.offsetHeight};return area}return function(oNode,oEvent){var node1Area=getNodeInfo(oNode);if(oEvent==null){oEvent=$.core.evt.getEvent()}else{if(oEvent.nodeType==1){var node2Area=getNodeInfo(oEvent);if(node1Area.right>node2Area.left&&node1Area.left<node2Area.right&&node1Area.bottom>node2Area.top&&node1Area.top<node2Area.bottom){return true}return false}else{if(oEvent.clientX==null){throw"core.evt.hitTest: ["+oEvent+":oEvent] is not a valid value"}}}var scrollPos=$.core.util.scrollPos();var evtX=oEvent.clientX+scrollPos.left;var evtY=oEvent.clientY+scrollPos.top;return(evtX>=node1Area.left&&evtX<=node1Area.right)&&(evtY>=node1Area.top&&evtY<=node1Area.bottom)?true:false}});STK.register("core.evt.stopEvent",function($){return function(e){var ev=e?e:$.core.evt.getEvent();if($.IE){ev.cancelBubble=true;ev.returnValue=false}else{ev.preventDefault();ev.stopPropagation()}return false}});STK.register("core.func.bind",function($){return function(obj,fun,args){args=$.core.arr.isArray(args)?args:[args];return function(){return fun.apply(obj,args)}}});STK.register("core.func.memorize",function($){return function(fun,args){if(typeof fun!=="function"){throw"core.func.memorize need a function as first parameter"}args=args||{};var cache={};if(args.timeout){setInterval(function(){cache={}},args.timeout)}return function(){var key=Array.prototype.join.call(arguments,"_");if(!(key in cache)){cache[key]=fun.apply((args.context||{}),arguments)}return cache[key]}}});STK.register("core.obj.parseParam",function($){return function(oSource,oParams,isown){var key;if(typeof oParams!="undefined"){for(key in oSource){if(oParams[key]!=null){if(isown){if(oSource.hasOwnProperty[key]){oSource[key]=oParams[key]}}else{oSource[key]=oParams[key]}}}}return oSource}});STK.register("core.func.methodBefore",function($){return function(){var started=false;var methodList=[];var that={};that.add=function(oFunc,oOpts){var opts={args:[],pointer:window,top:false};$.core.obj.parseParam(opts,oOpts);if(opts.top==true){methodList.unshift([oFunc,opts.args,opts.pointer])}else{methodList.push([oFunc,opts.args,opts.pointer])}return !started};that.start=function(){var i,len,method,args,pointer;if(started==true){return}started=true;for(i=0,len=methodList.length;i<len;i++){method=methodList[i][0];args=methodList[i][1];pointer=methodList[i][2];method.apply(pointer,args)}};that.reset=function(){methodList=[];started=false};that.getList=function(){return methodList};return that}});STK.register("core.func.timedChunk",function($){return function(items,args){if(!$.core.arr.isArray(items)){throw"core.func.timedChunk need an array as first parameter"}var todo=items.concat();var conf=$.core.obj.parseParam({process:function(func){if(typeof func==="function"){func()}},context:{},callback:null,delay:25,execTime:50},args);var timer=null;var loop=function(){var start=+new Date();do{conf.process.call(conf.context,todo.shift())}while(todo.length>0&&(+new Date()-start<conf.execTime));if(todo.length<=0){if(conf.callback){conf.callback(items)}}else{setTimeout(arguments.callee,conf.delay)}};timer=setTimeout(loop,conf.delay)}});STK.register("core.io.getXHR",function($){return function(){var _XHR=false;try{_XHR=new XMLHttpRequest()}catch(try_MS){try{_XHR=new ActiveXObject("Msxml2.XMLHTTP")}catch(other_MS){try{_XHR=new ActiveXObject("Microsoft.XMLHTTP")}catch(failed){_XHR=false}}}return _XHR}});STK.register("core.str.parseURL",function($){return function(url){var parse_url=/^(?:([A-Za-z]+):)?(\/{0,3})([0-9.\-A-Za-z]+\.[0-9A-Za-z]+)?(?::(\d+))?(?:\/([^?#]*))?(?:\?([^#]*))?(?:#(.*))?$/;var names=["url","scheme","slash","host","port","path","query","hash"];var results=parse_url.exec(url);var that={};for(var i=0,len=names.length;i<len;i+=1){that[names[i]]=results[i]||""}return that}});STK.register("core.str.trim",function($){return function(str){if(typeof str!=="string"){throw"trim need a string as parameter"}return str.replace(/^(\u3000|\s|\t|\u00A0)*|(\u3000|\s|\t|\u00A0)*$/g,"")}});STK.register("core.json.queryToJson",function($){return function(QS,isDecode){var _Qlist=$.core.str.trim(QS).split("&");var _json={};var _fData=function(data){if(isDecode){return decodeURIComponent(data)}else{return data}};for(var i=0,len=_Qlist.length;i<len;i++){if(_Qlist[i]){_hsh=_Qlist[i].split("=");_key=_hsh[0];_value=_hsh[1];if(_hsh.length<2){_value=_key;_key="$nullName"}if(!_json[_key]){_json[_key]=_fData(_value)}else{if($.core.arr.isArray(_json[_key])!=true){_json[_key]=[_json[_key]]}_json[_key].push(_fData(_value))}}}return _json}});STK.register("core.json.jsonToQuery",function($){var _fdata=function(data,isEncode){data=data==null?"":data;data=$.core.str.trim(data.toString());if(isEncode){return encodeURIComponent(data)}else{return data}};return function(JSON,isEncode){var _Qstring=[];if(typeof JSON=="object"){for(var k in JSON){if(JSON[k] instanceof Array){for(var i=0,len=JSON[k].length;i<len;i++){_Qstring.push(k+"="+_fdata(JSON[k][i],isEncode))}}else{if(typeof JSON[k]!="function"){_Qstring.push(k+"="+_fdata(JSON[k],isEncode))}}}}if(_Qstring.length){return _Qstring.join("&")}else{return""}}});STK.register("core.util.URL",function($){return function(sURL,args){var opts=$.core.obj.parseParam({isEncodeQuery:false,isEncodeHash:false},args||{});var that={};var url_json=$.core.str.parseURL(sURL);var query_json=$.core.json.queryToJson(url_json.query);var hash_json=$.core.json.queryToJson(url_json.hash);that.setParam=function(sKey,sValue){query_json[sKey]=sValue;return this};that.getParam=function(sKey){return query_json[sKey]};that.setParams=function(oJson){for(var key in oJson){that.setParam(key,oJson[key])}return this};that.setHash=function(sKey,sValue){hash_json[sKey]=sValue;return this};that.getHash=function(sKey){return hash_json[sKey]};that.valueOf=that.toString=function(){var url=[];var query=$.core.json.jsonToQuery(query_json,opts.isEncodeQuery);var hash=$.core.json.jsonToQuery(hash_json,opts.isEncodeQuery);if(url_json.scheme!=""){url.push(url_json.scheme+":");url.push(url_json.slash)}if(url_json.host!=""){url.push(url_json.host);url.push(url_json.port)}url.push("/");url.push(url_json.path);if(query!=""){url.push("?"+query)}if(hash!=""){url.push("#"+hash)}return url.join("")};return that}});STK.register("core.io.ajax",function($){return function(oOpts){var opts={url:"",charset:"UTF-8",timeout:30*1000,args:{},onComplete:null,onTimeout:null,uniqueID:null,onFail:null,method:"get",asynchronous:true,contentType:"application/x-www-form-urlencoded",isEncode:false,responseType:"json"};$.core.obj.parseParam(opts,oOpts);if(opts.url==""){throw"ajax need url in parameters object"}var trans=$.core.io.getXHR();var cback=function(){if(trans.readyState==4){var data="";if(opts.responseType==="xml"){data=trans.responseXML}else{if(opts.responseType==="text"){data=trans.responseText}else{try{data=eval("("+trans.responseText+")")}catch(exp){data=opts.url+"return error : data error"}}}if(trans.status==200){if(opts.onComplete!=null){opts.onComplete(data)}}else{if(opts.onFail!=null){opts.onFail(data,trans)}}}else{if(opts.onTraning!=null){opts.onTraning(trans)}}};trans.onreadystatechange=cback;if(opts.method.toLocaleLowerCase()=="get"){var url=$.core.util.URL(opts.url,{isEncodeQuery:opts.isEncode});url.setParams(opts.args);url.setParam("__rnd",new Date().valueOf());trans.open(opts.method,url,opts.asynchronous);trans.send("")}else{trans.open(opts.method,opts.url,opts.asynchronous);trans.setRequestHeader("Content-Type",opts.contentType);trans.send($.core.json.jsonToQuery(opts.args,opts.isEncode))}}});STK.register("core.io.scriptLoader",function($){var entityList={};return function(oOpts){var js,requestTimeout;var opts={url:"",charset:"UTF-8",timeout:30*1000,args:{},onComplete:null,onTimeout:null,uniqueID:null};$.core.obj.parseParam(opts,oOpts);if(opts.url==""){throw"scriptLoader: url is null"}var uniqueID=opts.uniqueID||$.core.util.getUniqueKey();js=entityList[uniqueID];if(js!=null&&$.IE!=true){$.core.dom.removeNode(js);js=null}if(js==null){js=entityList[uniqueID]=$.C("script")}js.charset=opts.charset;js.id="scriptRequest_script_"+uniqueID;js.type="text/javascript";if(opts.onComplete!=null){if($.IE){js.onreadystatechange=function(){if(js.readyState.toLowerCase()=="loaded"||js.readyState.toLowerCase()=="complete"){clearTimeout(requestTimeout);opts.onComplete()}}}else{js.onload=function(){clearTimeout(requestTimeout);opts.onComplete()}}}js.src=STK.core.util.URL(opts.url).setParams(opts.args);document.getElementsByTagName("head")[0].appendChild(js);if(opts.timeout>0&&opts.onTimeout!=null){requestTimeout=setTimeout(function(){opts.onTimeout()},opts.timeout)}return js}});STK.register("core.io.jsonp",function($){return function(oOpts){var opts={url:"",charset:"UTF-8",timeout:30*1000,args:{},onComplete:null,onTimeout:null,responseName:null,varkey:"callback"};var funcStatus=-1;$.core.obj.parseParam(opts,oOpts);var uniqueID=opts.responseName||("STK_"+$.core.util.getUniqueKey());opts.args[opts.varkey]=uniqueID;var completeFunc=opts.onComplete;var timeoutFunc=opts.onTimeout;window[uniqueID]=function(oResult){if(funcStatus!=2&&completeFunc!=null){funcStatus=1;completeFunc(oResult)}};opts.onComplete=null;opts.onTimeout=function(){if(funcStatus!=1&&timeoutFunc!=null){funcStatus=2;timeoutFunc()}};return $.core.io.scriptLoader(opts)}});STK.register("core.json.clone",function($){function clone(jsonObj){var buf;if(jsonObj instanceof Array){buf=[];var i=jsonObj.length;while(i--){buf[i]=clone(jsonObj[i])}return buf}else{if(jsonObj instanceof Object){buf={};for(var k in jsonObj){buf[k]=clone(jsonObj[k])}return buf}else{return jsonObj}}}return clone});STK.register("core.json.include",function($){return function(json2,json1){for(var k in json1){if(typeof json1[k]==="object"){if(json1[k] instanceof Array){if(json2[k] instanceof Array){if(json1[k].length===json2[k].length){for(var i=0,len=json1[k].length;i<len;i+=1){if(!arguments.callee(json1[k][i],json2[k][i])){return false}}}else{return false}}else{return false}}else{if(typeof json2[k]==="object"){if(!arguments.callee(json1[k],json2[k])){return false}}else{return false}}}else{if(typeof json1[k]==="number"||typeof json1[k]==="string"){if(json1[k]!==json2[k]){return false}}else{if(json1[k]!==undefined&&json1[k]!==null){if(json2[k]!==undefined&&json2[k]!==null){if(!json1[k].toString||!json2[k].toString){throw"json1[k] or json2[k] do not have toString method"}if(json1[k].toString()!==json2[k].toString()){return false}}else{return false}}}}}return true}});STK.register("core.json.compare",function($){return function(json1,json2){if($.core.json.include(json1,json2)&&$.core.json.include(json2,json1)){return true}else{return false}}});STK.register("core.json.jsonToStr",function($){function f(n){return n<10?"0"+n:n}if(typeof Date.prototype.toJSON!=="function"){Date.prototype.toJSON=function(key){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null};String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(key){return this.valueOf()}}var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;function quote(string){escapable.lastIndex=0;return escapable.test(string)?'"'+string.replace(escapable,function(a){var c=meta[a];return typeof c==="string"?c:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+string+'"'}function str(key,holder){var i,k,v,length,mind=gap,partial,value=holder[key];if(value&&typeof value==="object"&&typeof value.toJSON==="function"){value=value.toJSON(key)}if(typeof rep==="function"){value=rep.call(holder,key,value)}switch(typeof value){case"string":return quote(value);case"number":return isFinite(value)?String(value):"null";case"boolean":case"null":return String(value);case"object":if(!value){return"null"}gap+=indent;partial=[];if(Object.prototype.toString.apply(value)==="[object Array]"){length=value.length;for(i=0;i<length;i+=1){partial[i]=str(i,value)||"null"}v=partial.length===0?"[]":gap?"[\n"+gap+partial.join(",\n"+gap)+"\n"+mind+"]":"["+partial.join(",")+"]";gap=mind;return v}if(rep&&typeof rep==="object"){length=rep.length;for(i=0;i<length;i+=1){k=rep[i];if(typeof k==="string"){v=str(k,value);if(v){partial.push(quote(k)+(gap?": ":":")+v)}}}}else{for(k in value){if(Object.hasOwnProperty.call(value,k)){v=str(k,value);if(v){partial.push(quote(k)+(gap?": ":":")+v)}}}}v=partial.length===0?"{}":gap?"{\n"+gap+partial.join(",\n"+gap)+"\n"+mind+"}":"{"+partial.join(",")+"}";gap=mind;return v}}return function(value,replacer,space){var i;gap="";indent="";if(typeof space==="number"){for(i=0;i<space;i+=1){indent+=" "}}else{if(typeof space==="string"){indent=space}}rep=replacer;if(replacer&&typeof replacer!=="function"&&(typeof replacer!=="object"||typeof replacer.length!=="number")){throw new Error("JSON.stringify")}return str("",{"":value})}});STK.register("core.json.strToJson",function($){var at,ch,escapee={'"':'"',"\\":"\\","/":"/",b:"\b",f:"\f",n:"\n",r:"\r",t:"\t"},text,error=function(m){throw {name:"SyntaxError",message:m,at:at,text:text}},next=function(c){if(c&&c!==ch){error("Expected '"+c+"' instead of '"+ch+"'")}ch=text.charAt(at);at+=1;return ch},number=function(){var number,string="";if(ch==="-"){string="-";next("-")}while(ch>="0"&&ch<="9"){string+=ch;next()}if(ch==="."){string+=".";while(next()&&ch>="0"&&ch<="9"){string+=ch}}if(ch==="e"||ch==="E"){string+=ch;next();if(ch==="-"||ch==="+"){string+=ch;next()}while(ch>="0"&&ch<="9"){string+=ch;next()}}number=+string;if(isNaN(number)){error("Bad number")}else{return number}},string=function(){var hex,i,string="",uffff;if(ch==='"'){while(next()){if(ch==='"'){next();return string}else{if(ch==="\\"){next();if(ch==="u"){uffff=0;for(i=0;i<4;i+=1){hex=parseInt(next(),16);if(!isFinite(hex)){break}uffff=uffff*16+hex}string+=String.fromCharCode(uffff)}else{if(typeof escapee[ch]==="string"){string+=escapee[ch]}else{break}}}else{string+=ch}}}}error("Bad string")},white=function(){while(ch&&ch<=" "){next()}},word=function(){switch(ch){case"t":next("t");next("r");next("u");next("e");return true;case"f":next("f");next("a");next("l");next("s");next("e");return false;case"n":next("n");next("u");next("l");next("l");return null}error("Unexpected '"+ch+"'")},value,array=function(){var array=[];if(ch==="["){next("[");white();if(ch==="]"){next("]");return array}while(ch){array.push(value());white();if(ch==="]"){next("]");return array}next(",");white()}}error("Bad array")},object=function(){var key,object={};if(ch==="{"){next("{");white();if(ch==="}"){next("}");return object}while(ch){key=string();white();next(":");if(Object.hasOwnProperty.call(object,key)){error('Duplicate key "'+key+'"')}object[key]=value();white();if(ch==="}"){next("}");return object}next(",");white()}}error("Bad object")};value=function(){white();switch(ch){case"{":return object();case"[":return array();case'"':return string();case"-":return number();default:return ch>="0"&&ch<="9"?number():word()}};return function(source,reviver){var result;text=source;at=0;ch=" ";result=value();white();if(ch){error("Syntax error")}return typeof reviver==="function"?(function walk(holder,key){var k,v,value=holder[key];if(value&&typeof value==="object"){for(k in value){if(Object.hasOwnProperty.call(value,k)){v=walk(value,k);if(v!==undefined){value[k]=v}else{delete value[k]}}}}return reviver.call(holder,key,value)}({"":result},"")):result}});STK.register("core.obj.cascade",function($){return function(obj,fList){for(var i=0,len=fList.length;i<len;i+=1){if(typeof obj[fList[i]]!=="function"){throw"cascade need function list as the second paramsters"}obj[fList[i]]=(function(fun){return function(){fun.apply(obj,arguments);return obj}})(obj[fList[i]])}}});STK.register("core.obj.clear",function($){return function(oHash){var key,newHash={};for(key in oHash){if(oHash[key]!=null){newHash[key]=oHash[key]}}return newHash}});STK.register("core.obj.isEmpty",function($){return function(o,isprototype){var ret=true;for(var k in o){if(isprototype){ret=false;break}else{if(o.hasOwnProperty(k)){ret=false;break}}}return ret}});STK.register("core.obj.sup",function($){return function(obj,fList){var that={};for(var i=0,len=fList.length;i<len;i+=1){if(typeof obj[fList[i]]!=="function"){throw"super need function list as the second paramsters"}that[fList[i]]=(function(fun){return function(){return fun.apply(obj,arguments)}})(obj[fList[i]])}return that}});STK.register("core.str.bLength",function($){return function(str){if(!str){return 0}var aMatch=str.match(/[^\x00-\xff]/g);return(str.length+(!aMatch?0:aMatch.length))}});STK.register("core.str.dbcToSbc",function($){return function(str){return str.replace(/[\uff01-\uff5e]/g,function(a){return String.fromCharCode(a.charCodeAt(0)-65248)}).replace(/\u3000/g," ")}});STK.register("core.str.parseHTML",function($){return function(htmlStr){var tags=/[^<>]+|<(\/?)([A-Za-z0-9]+)([^<>]*)>/g;var a,i;var ret=[];while((a=tags.exec(htmlStr))){var n=[];for(i=0;i<a.length;i+=1){n.push(a[i])}ret.push(n)}return ret}});STK.register("core.str.leftB",function($){return function(str,lens){var s=str.replace(/\*/g," ").replace(/[^\x00-\xff]/g,"**");str=str.slice(0,s.slice(0,lens).replace(/\*\*/g," ").replace(/\*/g,"").length);if($.core.str.bLength(str)>lens&&lens>0){str=str.slice(0,str.length-1)}return str}});STK.register("core.str.queryString",function($){return function(sKey,oOpts){var opts={source:window.location.href.toString(),split:"&"};$.core.obj.parseParam(opts,oOpts);var rs=new RegExp("(^|)"+sKey+"=([^\\"+opts.split+"]*)(\\"+opts.split+"|$)","gi").exec(opts.source),tmp;if(tmp=rs){return tmp[2]}return null}});STK.register("core.util.cookie",function($){var that={set:function(sKey,sValue,oOpts){var arr=[];var d,t;var cfg={expire:null,path:null,domain:null,secure:null,encode:true};$.core.obj.parseParam(cfg,oOpts);if(cfg.encode==true){sValue=escape(sValue)}arr.push(sKey+"="+sValue);if(cfg.path!=null){arr.push("path="+cfg.path)}if(cfg.domain!=null){arr.push("domain="+cfg.domain)}if(cfg.secure!=null){arr.push(cfg.secure)}if(cfg.expire!=null){d=new Date();t=d.getTime()+cfg.expire*3600000;d.setTime(t);arr.push("expires="+d.toGMTString())}document.cookie=arr.join(";")},get:function(sKey){sKey=sKey.replace(/([\.\[\]\$])/g,"\\$1");var rep=new RegExp(sKey+"=([^;]*)?;","i");var co=document.cookie+";";var res=co.match(rep);if(res){return res[1]||""}else{return""}},remove:function(sKey,oOpts){oOpts=oOpts||{};oOpts.expire=-10;that.set(sKey,"",oOpts)}};return that});STK.register("core.util.drag",function($){var stopClick=function(e){e.cancelBubble=true;return false};var getParams=function(args,evt){evt=$.core.evt.fixEvent(evt);args.clientX=evt.clientX;args.clientY=evt.clientY;args.pageX=evt.pageX;args.pageY=evt.pageY;return args};return function(actEl,spec){if(!$.core.dom.isNode(actEl)){throw"core.util.drag need Element as first parameter"}var conf=$.core.obj.parseParam({actRect:[],actObj:{}},spec);var that=conf.actObj;var dragStartKey=$.core.evt.custEvent.define(that,"dragStart");var dragEndKey=$.core.evt.custEvent.define(that,"dragEnd");var dragingKey=$.core.evt.custEvent.define(that,"draging");var startFun=function(e){var args=getParams({},e);document.body.onselectstart=function(){return false};$.core.evt.addEvent(document,"mousemove",dragFun);$.core.evt.addEvent(document,"mouseup",endFun);$.core.evt.addEvent(document,"click",stopClick,true);if(!$.IE){e.preventDefault();e.stopPropagation()}$.core.evt.custEvent.fire(dragStartKey,"dragStart",args);return false};var dragFun=function(e){var args=getParams({},e);e.cancelBubble=true;$.core.evt.custEvent.fire(dragStartKey,"draging",args)};var endFun=function(e){var args=getParams({},e);document.body.onselectstart=function(){return true};$.core.evt.removeEvent(document,"mousemove",dragFun);$.core.evt.removeEvent(document,"mouseup",endFun);$.core.evt.removeEvent(document,"click",stopClick,true);$.core.evt.custEvent.fire(dragStartKey,"dragEnd",args)};$.core.evt.addEvent(actEl,"mousedown",startFun);return that}});STK.register("core.util.log",function($){return window.console&&console.log||function(){}});STK.register("core.util.nameValue",function($){return function(node){var _name=node.getAttribute("name");var _type=node.getAttribute("type");var _el=node.tagName;var _value={name:_name,value:""};var _setVl=function(vl){if(vl===false){_value=false}else{if(!_value.value){_value.value=$.core.str.trim((vl||""))}else{_value.value=[$.core.str.trim((vl||""))].concat(_value.value)}}};if(!node.disabled&&_name){switch(_el){case"INPUT":if(_type=="radio"||_type=="checkbox"){if(node.checked){_setVl(node.value)}else{_setVl(false)}}else{if(_type=="reset"||_type=="submit"||_type=="image"){_setVl(false)}else{_setVl(node.value)}}break;case"SELECT":if(node.multiple){var _ops=node.options;for(var i=0,len=_ops.length;i<len;i++){if(_ops[i].selected){_setVl(_ops[i].value)}}}else{_setVl(node.value)}break;case"TEXTAREA":_setVl(node.value||node.getAttribute("value")||false);break;case"BUTTON":default:_setVl(node.value||node.getAttribute("value")||node.innerHTML||false)}}else{return false}return _value}});STK.register("core.util.htmlToJson",function($){return function(mainBox,tagNameList,isClear){var _retObj={};tagNameList=tagNameList||["INPUT","TEXTAREA","BUTTON","SELECT"];if(!mainBox||!tagNameList){return false}var _opInput=$.core.util.nameValue;for(var i=0,len=tagNameList.length;i<len;i++){var _tags=mainBox.getElementsByTagName(tagNameList[i]);for(var j=0,lenTag=_tags.length;j<lenTag;j++){var _info=_opInput(_tags[j]);if(!_info||(isClear&&(_info.value===""))){continue}if(_retObj[_info.name]){if(_retObj[_info.name] instanceof Array){_retObj[_info.name]=_retObj[_info.name].concat(_info.value)}else{_retObj[_info.name]=[_retObj[_info.name]].concat(_info.value)}}else{_retObj[_info.name]=_info.value}}}return _retObj}});STK.register("core.util.jobsM",function($){return(function(){var jobList=[];var usedHash={};var running=false;var that={};var startOneJob=function(job){var jobName=job.name;var jobFunc=job.func;var staTime=+new Date();if(!usedHash[jobName]){try{jobFunc($);jobFunc[jobName]=true}catch(exp){$.core.util.log("jobs ["+jobName+"] 执行失败!")}}};var loop=function(items){if(items.length){$.core.func.timedChunk(items,{process:startOneJob,callback:arguments.callee});items.splice(0,items.length)}else{running=false}};that.register=function(sJobName,oFunc){jobList.push({name:sJobName,func:oFunc})};that.start=function(){if(running){return true}else{running=true}loop(jobList)};that.load=function(){};$.Ready(that.start);return that})()});STK.register("core.util.language",function($){return function(template,data){return template.replace(/#L\{([^\}]+)\}/ig,function(){var key=arguments[1].replace(/\s/ig,"");var ret=arguments[0];if(data&&data[key]!==undefined){ret=data[key]}else{ret=key}return ret})}});STK.register("core.util.listener",function($){return(function(){var dispatchList={};var topWindow;var fireTaskList=[];var fireTaskTimer;function runFireTaskList(){if(fireTaskList.length==0){return}clearTimeout(fireTaskTimer);var curFireTask=fireTaskList.splice(0,1)[0];curFireTask.func.apply(curFireTask.func,[].concat(curFireTask.data));fireTaskTimer=setTimeout(runFireTaskList,25)}var dispatch={conn:function(){var win=window;while(win!=top){win=win.parent;if(win.STK&&win.STK["core"]&&win.STK["core"]["util"]&&win.STK["core"]["util"]["listener"]!=null){topWindow=win}}},register:function(sChannel,sEventType,fCallBack){if(topWindow!=null){topWindow.STK["core"]["util"]["listener"].register(sChannel,sEventType,fCallBack)}else{dispatchList[sChannel]=dispatchList[sChannel]||{};dispatchList[sChannel][sEventType]=dispatchList[sChannel][sEventType]||[];dispatchList[sChannel][sEventType].push(fCallBack)}},fire:function(sChannel,sEventType,oData){if(topWindow!=null){topWindow.listener.fire(sChannel,sEventType,oData)}else{var funcArray;var i,len;if(dispatchList[sChannel]&&dispatchList[sChannel][sEventType]&&dispatchList[sChannel][sEventType].length>0){funcArray=dispatchList[sChannel][sEventType];funcArray.data_cache=oData;for(i=0,len=funcArray.length;i<len;i++){fireTaskList.push({func:funcArray[i],data:oData})}runFireTaskList()}}},remove:function(sChannel,sEventType,fCallBack){if(topWindow!=null){topWindow.STK["core"]["util"]["listener"].remove(sChannel,sEventType,fCallBack)}else{if(dispatchList[sChannel]){if(dispatchList[sChannel][sEventType]){for(var i=0,len=dispatchList[sChannel][sEventType].length;i<len;i++){if(dispatchList[sChannel][sEventType][i]===fCallBack){dispatchList[sChannel][sEventType].splice(i,1);break}}}}}},list:function(){return dispatchList},cache:function(sChannel,sEventType){if(topWindow!=null){return topWindow.listener.cache(sChannel,sEventType)}else{if(dispatchList[sChannel]&&dispatchList[sChannel][sEventType]){return dispatchList[sChannel][sEventType].data_cache}}}};return dispatch})()});STK.register("core.util.winSize",function($){return function(_target){var w,h;if(_target){target=_target.document}else{target=document}if(target.compatMode==="CSS1Compat"){w=target.documentElement.clientWidth;h=target.documentElement.clientHeight}else{if(self.innerHeight){if(_target){target=_target.self}else{target=self}w=target.innerWidth;h=target.innerHeight}else{if(target.documentElement&&target.documentElement.clientHeight){w=target.documentElement.clientWidth;h=target.documentElement.clientHeight}else{if(target.body){w=target.body.clientWidth;h=target.body.clientHeight}}}}return{width:w,height:h}}});STK.register("core.util.pageSize",function($){return function(_target){if(_target){target=_target.document}else{target=document}var _rootEl=(target.compatMode=="CSS1Compat"?target.documentElement:target.body);var xScroll,yScroll;if(window.innerHeight&&window.scrollMaxY){xScroll=_rootEl.scrollWidth;yScroll=window.innerHeight+window.scrollMaxY}else{if(_rootEl.scrollHeight>_rootEl.offsetHeight){xScroll=_rootEl.scrollWidth;yScroll=_rootEl.scrollHeight}else{xScroll=_rootEl.offsetWidth;yScroll=_rootEl.offsetHeight}}var win_s=$.core.util.winSize(_target);if(yScroll<win_s.height){pageHeight=win_s.height}else{pageHeight=yScroll}if(xScroll<win_s.width){pageWidth=win_s.width}else{pageWidth=xScroll}return{page:{width:pageWidth,height:pageHeight},win:{width:win_s.width,height:win_s.height}}}});STK.register("core.util.queue",function($){return function(){var that={};var que=[];that.add=function(item){que.push(item);return that};that.get=function(){if(que.length>0){return que.shift()}else{return false}};return that}});STK.register("core.util.timer",function($){return(function(){var that={};var list={};var refNum=0;var clock=null;var allpause=false;var delay=25;var loop=function(){for(var k in list){if(!list[k]["pause"]){list[k]["fun"]()}}return that};that.add=function(fun){if(typeof fun!="function"){throw ("The timer needs add a function as a parameters")}var key=""+(new Date()).getTime()+(Math.random())*Math.pow(10,17);list[key]={fun:fun,pause:false};if(refNum<=0){that.start()}refNum++;return key};that.remove=function(key){if(list[key]){delete list[key];refNum--}if(refNum<=0){that.stop()}return that};that.pause=function(key){if(list[key]){list[key]["pause"]=true}return that};that.play=function(key){if(list[key]){list[key]["pause"]=false}return that};that.stop=function(){clearInterval(clock);clock=null;return that};that.start=function(){clock=setInterval(loop,delay);return that};that.loop=loop;that.get=function(key){if(key==="delay"){return delay}if(key==="functionList"){return list}};that.set=function(key,value){if(key==="delay"){if(typeof value==="number"){delay=Math.max(25,Math.min(value,200))}}};return that})()});STK.register("core.util.scrollTo",function($){return function(target,spec){if(!$.core.dom.isNode(target)){throw"core.dom.isNode need element as the first parameter"}var conf=$.core.obj.parseParam({box:document.documentElement,top:0,step:2,onMoveStop:null},spec);conf.step=Math.max(2,Math.min(10,conf.step));var orbit=[];var targetPos=$.core.dom.position(target);var boxPos=$.core.dom.position(conf.box);var pos=Math.max(0,(targetPos?targetPos.t:0)-(boxPos?boxPos.t:0)-conf.top);var cur=conf.box===document.documentElement?(conf.box.scrollTop||document.body.scrollTop||window.pageYOffset):conf.box.scrollTop;while(Math.abs(cur-pos)>conf.step&&cur!==0){orbit.push(Math.round(cur+(pos-cur)*conf.step/10));cur=orbit[orbit.length-1]}if(!orbit.length){orbit.push(pos)}var tm=$.core.util.timer.add(function(){if(orbit.length){if(conf.box===document.documentElement){window.scrollTo(0,orbit.shift())}else{conf.box.scrollTop=orbit.shift()}}else{if(conf.box===document.documentElement){window.scrollTo(0,pos)}else{conf.box.scrollTop=pos}$.core.util.timer.remove(tm);if(typeof conf.onMoveStop==="function"){conf.onMoveStop()}}})}});STK.register("core.util.stack",function($){return function(){var that={};var stak=[];that.add=function(item){stak.push(item);return that};that.get=function(){if(stak.length>0){return stak.pop()}else{return false}};return that}});STK.register("core.util.swf",function($){function getSWF(sURL,oOpts){var cfg={id:"swf_"+parseInt(Math.random()*10000,10),width:1,height:1,attrs:{},paras:{},flashvars:{},html:""};$.core.obj.parseParam(cfg,oOpts);if(sURL==null){throw"swf: [sURL] 未定义";return}var key;var html=[];var attrs=[];for(key in cfg.attrs){attrs.push(key+'="'+cfg.attrs[key]+'" ')}var flashvars=[];for(key in cfg.flashvars){flashvars.push(key+"="+cfg.flashvars[key])}cfg.paras.flashvars=flashvars.join("&");if($.IE){html.push('<object width="'+cfg.width+'" height="'+cfg.height+'" id="'+cfg.id+'" classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" ');html.push(attrs.join(""));html.push('><param name="movie" value="'+sURL+'" />');for(key in cfg.paras){html.push('<param name="'+key+'" value="'+cfg.paras[key]+'" />')}html.push("</object>")}else{html.push('<embed width="'+cfg.width+'" height="'+cfg.height+'" id="'+cfg.id+'" src="'+sURL+'" type="application/x-shockwave-flash" ');html.push(attrs.join(""));for(key in cfg.paras){html.push(key+'="'+cfg.paras[key]+'" ')}html.push(" />")}cfg.html=html.join("");return cfg}var that={};that.create=function(sNode,sURL,oOpts){var oElement=$.E(sNode);if(oElement==null){throw"swf: ["+sNode+"] 未找到";return}var swf_info=getSWF(sURL,oOpts);oElement.innerHTML=swf_info.html;return $.E(swf_info.id)};that.html=function(sURL,oOpts){var swf_info=getSWF(sURL,oOpts);return swf_info.html};that.check=function(){var description;if(STK.IE){var flash=new ActiveXObject("ShockwaveFlash.ShockwaveFlash");description=flash.GetVariable("$version")}else{description=navigator.plugins["Shockwave Flash"]["description"]}return description};return that});STK.register("core.util.templet",function($){return function(template,data){return template.replace(/#\{(.+?)\}/ig,function(){var key=arguments[1].replace(/\s/ig,"");var ret=arguments[0];var list=key.split("||");for(var i=0,len=list.length;i<len;i+=1){if(/^default:.*$/.test(list[i])){ret=list[i].replace(/^default:/,"");break}else{if(data[list[i]]!==undefined){ret=data[list[i]];break}}}return ret})}});STK.register("core.util.easyTemplate",function($){var easyTemplate=function(s,d){if(!s){return""}if(s!==easyTemplate.template){easyTemplate.template=s;easyTemplate.aStatement=easyTemplate.parsing(easyTemplate.separate(s))}var aST=easyTemplate.aStatement;var process=function(d2){if(d2){d=d2}return arguments.callee};process.toString=function(){return(new Function(aST[0],aST[1]))(d)};return process};easyTemplate.separate=function(s){var r=/\\'/g;var sRet=s.replace(/(<(\/?)#(.*?(?:\(.*?\))*)>)|(')|([\r\n\t])|(\$\{([^\}]*?)\})/g,function(a,b,c,d,e,f,g,h){if(b){return"{|}"+(c?"-":"+")+d+"{|}"}if(e){return"\\'"}if(f){return""}if(g){return"'+("+h.replace(r,"'")+")+'"}});return sRet};easyTemplate.parsing=function(s){var mName,vName,sTmp,aTmp,sFL,sEl,aList,aStm=["var aRet = [];"];aList=s.split(/\{\|\}/);var r=/\s/;while(aList.length){sTmp=aList.shift();if(!sTmp){continue}sFL=sTmp.charAt(0);if(sFL!=="+"&&sFL!=="-"){sTmp="'"+sTmp+"'";aStm.push("aRet.push("+sTmp+");");continue}aTmp=sTmp.split(r);switch(aTmp[0]){case"+et":mName=aTmp[1];vName=aTmp[2];aStm.push('aRet.push("<!--'+mName+' start-->");');break;case"-et":aStm.push('aRet.push("<!--'+mName+' end-->");');break;case"+if":aTmp.splice(0,1);aStm.push("if"+aTmp.join(" ")+"{");break;case"+elseif":aTmp.splice(0,1);aStm.push("}else if"+aTmp.join(" ")+"{");break;case"-if":aStm.push("}");break;case"+else":aStm.push("}else{");break;case"+list":aStm.push("if("+aTmp[1]+".constructor === Array){with({i:0,l:"+aTmp[1]+".length,"+aTmp[3]+"_index:0,"+aTmp[3]+":null}){for(i=l;i--;){"+aTmp[3]+"_index=(l-i-1);"+aTmp[3]+"="+aTmp[1]+"["+aTmp[3]+"_index];");break;case"-list":aStm.push("}}}");break;default:break}}aStm.push('return aRet.join("");');return[vName,aStm.join("")]};return easyTemplate});STK.register("core.util.storage",function($){var objDS=window.localStorage;if(objDS){return{get:function(key){return unescape(objDS.getItem(key))},set:function(key,value,exp){objDS.setItem(key,escape(value))},del:function(key){objDS.removeItem(key)},clear:function(){objDS.clear()},getAll:function(){var l=objDS.length,key=null,ac=[];for(var i=0;i<l;i++){key=objDS.key(i),ac.push(key+"="+this.getKey(key))}return ac.join("; ")}}}else{if(window.ActiveXObject){store=document.documentElement;STORE_NAME="localstorage";try{store.addBehavior("#default#userdata");store.save("localstorage")}catch(e){}return{set:function(key,value){store.setAttribute(key,value);store.save(STORE_NAME)},get:function(key){store.load(STORE_NAME);return store.getAttribute(key)},del:function(key){store.removeAttribute(key);store.save(STORE_NAME)}}}else{return{get:function(key){var aCookie=document.cookie.split("; "),l=aCookie.length,aCrumb=[];for(var i=0;i<l;i++){aCrumb=aCookie[i].split("=");if(key===aCrumb[0]){return unescape(aCrumb[1])}}return null},set:function(key,value,exp){if(!(exp&&typeof exp===date)){exp=new Date(),exp.setDate(exp.getDate()+1)}document.cookie=key+"="+escape(value)+"; expires="+exp.toGMTString()},del:function(key){document.cookie=key+"=''; expires=Fri, 31 Dec 1999 23:59:59 GMT;"},clear:function(){var aCookie=document.cookie.split("; "),l=aCookie.length,aCrumb=[];for(var i=0;i<l;i++){aCrumb=aCookie[i].split("=");this.deleteKey(aCrumb[0])}},getAll:function(){return unescape(document.cookie.toString())}}}}});(function(){var $=STK.core;var hash={arrCopy:$.arr.copy,arrClear:$.arr.clear,hasby:$.arr.hasby,unique:$.arr.unique,foreach:$.arr.foreach,isArray:$.arr.isArray,inArray:$.arr.inArray,arrIndexOf:$.arr.indexOf,findout:$.arr.findout,domNext:$.dom.next,domPrev:$.dom.prev,isNode:$.dom.isNode,addHTML:$.dom.addHTML,insertHTML:$.dom.insertHTML,setXY:$.dom.setXY,contains:$.dom.contains,position:$.dom.position,trimNode:$.dom.trimNode,insertAfter:$.dom.insertAfter,insertBefore:$.dom.insertBefore,removeNode:$.dom.removeNode,replaceNode:$.dom.replaceNode,setStyle:$.dom.setStyle,setStyles:$.dom.setStyles,getStyle:$.dom.getStyle,addClassName:$.dom.addClassName,hasClassName:$.dom.hasClassName,removeClassName:$.dom.removeClassName,builder:$.dom.builder,cascadeNode:$.dom.cascadeNode,selector:$.dom.selector,sizzle:$.dom.sizzle,addEvent:$.evt.addEvent,custEvent:$.evt.custEvent,removeEvent:$.evt.removeEvent,fireEvent:$.evt.fireEvent,fixEvent:$.evt.fixEvent,getEvent:$.evt.getEvent,stopEvent:$.evt.stopEvent,memorize:$.func.memorize,bind:$.func.bind,getType:$.func.getType,methodBefore:$.func.methodBefore,timedChunk:$.func.timedChunk,ajax:$.io.ajax,jsonp:$.io.jsonp,scriptLoader:$.io.scriptLoader,jsonInclude:$.json.include,jsonCompare:$.json.compare,jsonClone:$.json.clone,jsonToQuery:$.json.jsonToQuery,queryToJson:$.json.queryToJson,jsonToStr:$.json.jsonToStr,strToJson:$.json.strToJson,objIsEmpty:$.obj.isEmpty,beget:$.obj.beget,cascade:$.obj.cascade,objSup:$.obj.sup,parseParam:$.obj.parseParam,bLength:$.str.bLength,dbcToSbc:$.str.dbcToSbc,leftB:$.str.leftB,trim:$.str.trim,encodeHTML:$.str.encodeHTML,decodeHTML:$.str.decodeHTML,parseURL:$.str.parseURL,parseHTML:$.str.parseHTML,queryString:$.str.queryString,log:$.util.log,htmlToJson:$.util.htmlToJson,cookie:$.util.cookie,drag:$.util.drag,timer:$.util.timer,jobsM:$.util.jobsM,listener:$.util.listener,winSize:$.util.winSize,pageSize:$.util.pageSize,templet:$.util.templet,queue:$.util.queue,stack:$.util.stack,swf:$.util.swf,URL:$.util.URL,scrollPos:$.util.scrollPos,scrollTo:$.util.scrollTo,getUniqueKey:$.util.getUniqueKey,storage:$.util.storage};for(var k in hash){STK.regShort(k,hash[k])}})();STK.register("kd.KDUser",function($){var _user={uid:false,uName:false},login=function(uid,name){_user={uid:uid,uName:name};$.custEvent.fire(_loginUser,"login",_user)};var _unLogin=false;var _loginUser={init:function(uid,name,unLogin){if(uid||name){this.setUser(uid,name)}_unLogin=unLogin},setUser:function(uid,name){login(uid,name)},isLogin:function(){if(!_user.uid){if(_unLogin){_unLogin()}return false}return true},getUser:function(){return _user},onLogin:function(fun){if(_user.uid||_user.uName){fun(_user)}$.custEvent.add(this,"login",function(type,user){fun(user)})}};$.custEvent.define(_loginUser,"login");return _loginUser});STK.register("cfg.cKanDianCfg",function($){var cKanDianCfg={URL:{URL_WEIBO:"http://weibo.com/",URL_JS:"http://sjs0.sinajs.cn/kandian/",URL_FLASH:"http://p.you.video.sina.com.cn/kandianswf/",URL_EPG_PIC:"http://image.kandian.net/",URL_INNER:"http://inner.kandian.com/",URL_PLAY:"http://kandian.com/play/iplay.php",URL_PLAY_FID:"http://kandian.com/play/ifplay.php",URL_LOCATION:"http://kandian.com/",URL_IMAGE_DEFORE:"http://sjs0.sinajs.cn/kandian/images/icon/stv_trans.gif",URL_STATIC:"http://sjs0.sinajs.cn/kandian/",URL_ERRORPIC:" onerror=\"this.src='http://sjs0.sinajs.cn/kandian/images/other/default_img.png'\" ",URL_EPG_DEFAULT_IMG:"http://sjs0.sinajs.cn/kandian/images/other/default_img.png",URL_DEFAULT_TV_LOGO:"http://sjs0.sinajs.cn/kandian/images/tv_icon/defaultTvLogo.png",URL_APPCATE:"http://tjs.sjs.sinajs.cn/open/api/js/wb.js?appkey=1592407943",URL_CPLAY:"http://kandian.com/play/cplay.php",HOST:"kandian.com"},getPlayUrl:function(epgId,pt,tf,rkid){if(!epgId){return"javascript:void(0)"}var arr=[];if(tf){arr.push("tf=ct")}if(pt){arr.push("pt="+pt)}if(rkid){arr.push("rkID="+rkid)}return"http://kandian.com/p/epgId.html".replace("epgId",epgId)+(arr.length!=0?"?"+arr.join("&"):"")},getFPlayUrl:function(fId,op){if(!fId){return"javascript:void(0)"}var fId=Math.abs(fId);var _url="http://kandian.com/f/fid.php".replace("fid",fId),_arr=[];if(!op){return _url}for(var i in op){_arr.push(i+"="+op[i])}if(_arr.length!=0){_url=_url+"?"+_arr.join("&")}return _url},getCollUrl:function(cId,epgId,rkid,pt){if(!cId){return"javascript:void(0)"}if(!epgId){return"http://kandian.com/a/cId.html".replace("cId",cId)+"?rkID="+(rkid||"")}else{return"http://kandian.com/a/"+cId+"/"+epgId+".html?rkID="+(rkid||"")+(pt?"&pt="+pt:"")}},getTVUrl:function(epgId,rkid){if(!rkid){return"http://inner.kandian.com/e/api/coll/locationCollByEpgId.php?epgId="+epgId}else{return"http://inner.kandian.com/e/api/coll/locationCollByEpgId.php?epgId="+epgId+"&rkID="+rkid}},getAlbumContentUrl:function(cId){return"http://kandian.com/epg/collection/info?id="+cId},FId:{FID_COLLECTION:-3},V:"1.1",WBCrossURL:"http://kandian.com/play/crossdomain.html"};return cKanDianCfg});STK.register("module.cPluginCfg",function($){var _cfg=$.cfg.cKanDianCfg;return{cfg:_cfg,setCfg:function(config){for(var i in config){_cfg[i]=config[i]}},toDefault:function(){_cfg=$.cfg.cKanDianCfg}}});STK.register("kd.KDUser",function($){var _user={uid:false,uName:false},login=function(uid,name){_user={uid:uid,uName:name};$.custEvent.fire(_loginUser,"login",_user)};var _unLogin=false;var _loginUser={init:function(uid,name,unLogin){if(uid||name){this.setUser(uid,name)}_unLogin=unLogin},setUser:function(uid,name){login(uid,name)},isLogin:function(){if(!_user.uid){if(_unLogin){_unLogin()}return false}return true},getUser:function(){return _user},onLogin:function(fun){if(_user.uid||_user.uName){fun(_user)}$.custEvent.add(this,"login",function(type,user){fun(user)})}};$.custEvent.define(_loginUser,"login");return _loginUser});STK.register("kd.kdStaticConfig",function($){var _config={pkID:"",tkID:"",rkID:""};return{set:function(param){$.parseParam(_config,param)},get:function(){return _config}}});STK.register("kd.KDPlayer",function($){var _cfg=$.module.cPluginCfg.cfg,_pageOpt={};var _player=false,_playData=false;var $user=$.kd.KDUser;var _flashCfg={id:"vPlayer",width:560,height:423,flashvars:{playerType:"1",JSCALL:"window",pkID:"",tkID:"",rkID:""},params:{allowNetworking:"all",allowScriptAccess:"always",wmode:"transparent",allowFullScreen:"true",quality:"high",bgcolor:"#000000"},attributes:{},onComplete:null};window._videoPlayComplete=false;window.videoPlayComplete=function(){if(window._videoPlayComplete){window._videoPlayComplete(arguments)}};var catchPicComplete=false;(function(){window.catchPicComplete=function(isSuc,picUrl){if(catchPicComplete){catchPicComplete(isSuc,picUrl)}}})();var _afterPlay=false;var _playVideo=function(epgId,epgInfo,opt){try{if($.module.p2pMedium){$.module.p2pMedium.onInstallOK=function(){_playVideo(epgId,epgInfo,opt)}}}catch(e){}var _player=kdPlayer.getPlayer();try{opt.lastVideo=0;try{if(opt.opt){if(opt.opt.auto){window.videoPlayStart=function(){}}else{window.videoPlayStart=function(){_player.pauseVideo()}}}}catch(e){}_player.playVideo(epgId,epgInfo,opt)}catch(e){}$.foreach(kdPlayer.onPlay,function(a,i){try{a(epgId)}catch(e){}});_player.displayLayer({type:0});if(_afterPlay){_afterPlay(epgId)}},_madePlayArguments=function(epgId,json,opt){var args={epgId:0,epgInfo:false,opt:false};args.epgId=epgId;args.epgInfo=json;opt=opt||{};args.opt=opt;var _curEpg=args.epgInfo;_playData=args.epgInfo;_playData.id=epgId;_playData.epgName=_playData.title;_playVideo(args.epgId,args.epgInfo,args,opt)};window.collectionVideo=function(){var playData=kdPlayer.getPlayData();if(_playData){window.open("http://kandian.com/play/iframe/stv_coll.php?id="+_playData.id,"_blank","width=605,height=583,location=no,status=no,toolbar=no,menubar=no,top="+(window.screen.height-501)/2+",left="+(window.screen.width-572)/2);kdPlayer.getPlayer().collectionSuccessful(true)}};var _checkIsColl=function(uid,epgId){var url=location.href;var host=$.parseURL(url).host;var _apiURL="http://i.kandian.weibo.com/";if(host.indexOf("weibo.com")<0){_apiURL="http://inner.kandian.com/"}_apiURL+="api/1.1/play/checkCollectEpgForUsers.php";$.jsonp({url:_apiURL,args:{ids:epgId},onComplete:function(json){if(json.data&&json.data[epgId]){kdPlayer.getPlayer().collectionSuccessful(true)}}})};var kdPlayer={init:function(opt){if(opt){$.parseParam(_flashCfg,opt);var vars=_flashCfg.flashvars;var _config=$.kd.kdStaticConfig;var theConfig=_config.get();$.parseParam(vars,theConfig);if(opt.playComplete){window._videoPlayComplete=opt.playComplete}}window._svPlayer={_opt:_flashCfg,initSuccess:function(){_player=$.E(_flashCfg.id);if(_flashCfg.onComplete){_flashCfg.onComplete()}}};var bro={isIPad:function(){return navigator.userAgent.match(/iPad/i)!==null},isIPhone:function(){return navigator.userAgent.match(/iPhone/i)!==null}};var _url=_cfg.URL.URL_JS+"js/play/js/svFlashPlayer.js";if(bro.isIPad()||bro.isIPhone()){try{_url=_cfg.URL.URL_JS+"js/play/js/html5player.js"}catch(e){}}$.scriptLoader({url:_url,args:{v:_cfg.V}})},getPlayData:function(){return _playData},onPlay:[],getPlayer:function(){return _player},catchPic:function(args,onSuccess){if(!_player){throw"has not load player yet"}if(onSuccess){catchPicComplete=onSuccess}var type=args.type?args.type:"1";_player.catchPic(args.time,type)},getCurrentTime:function(){if(!_player){return{playTime:0}}var _t=null;try{_t=_player.getCurrentPosition()}catch(e){return{playTime:0}}return _t},play:function(epgId,opt,playOK,playError){$.jsonp({url:"http://kandian.com/player/getEpgInfo",args:{epgId:epgId},onComplete:function(json){if(json.code=="A0001"){_madePlayArguments(epgId,json.data,opt);if(playOK){playOK(_playData)}}else{if(playError){playError()}}},onTimeout:function(){if(playError){playError()}}})},playByResource:function(epgId,epg,opt){_madePlayArguments(epgId,epg,opt)},seek:function(time){if(!_player){return false}_player.seekVideo(time)}};return kdPlayer});STK.register("module.cGetLength",function($){return(function(){var trim=function(h){return $.trim(h)};var byteLength=function(b){return $.bLength(b)};return function(q,g){g=g||{};g.max=g.max||140;g.min=g.min||41;g.surl=g.surl||20;var p=trim(q).length;if(p>0){var j=g.min,s=g.max,b=g.surl,n=q;var r=q.match(/(http|https):\/\/[a-zA-Z0-9]+(\.[a-zA-Z0-9]+)+([-A-Z0-9a-z\$\.\+\!\_\*\(\)\/\,\:;@&=\?~#%]*)*/gi)||[];var h=0;for(var m=0,p=r.length;m<p;m++){var o=byteLength(r[m]);if(/^(http:\/\/t.cn)/.test(r[m])){continue}else{if(/^(http:\/\/)+(weibo.com|weibo.cn)/.test(r[m])){h+=o<=j?o:(o<=s?b:(o-s+b))}else{h+=o<=s?b:(o-s+b)}}n=n.replace(r[m],"")}return Math.ceil((h+byteLength(n))/2)}else{return 0}}})()});STK.register("module.checkTextLength",function($){return function(opts){var toString=Object.prototype.toString;var tools={isFunction:function(obj){return toString.call(obj)==="[object Function]"}};if(!opts&&!opts.id){return false}var $E=STK.E,_input=$E(opts.id),_length=function(str){if(typeof str=="undefined"){return 0}return $.module.cGetLength(str,{max:opts.maxLen||120})},_check=function(){var _trimStr=getText();var strLen=$.module.cGetLength(_trimStr);var _length=getRemindLength();if((strLen)>opts.maxLen){if(tools.isFunction(opts.callBack)){opts.callBack.call($E(opts.id),true,_length);return false}}else{if(tools.isFunction(opts.callBack)){opts.callBack.call($E(opts.id),false,_length)}return true}},getText=function(){return STK.core.str.trim($E(opts.id).value)},remainTextLen=function(){if(opts.remainWordTarget){opts.remainWordTarget.innerHTML=getRemindLength()}},getRemindLength=function(){var _text=getText();if(opts.defaultText&&opts.defaultText==_text&&opts.remainWordTarget){return opts.maxLen}var _remind=opts.maxLen-_length(_text);if(opts.needAbs){_remind=Math.abs(_remind)}return _remind},lazyCheck=function(){setTimeout(function(){remainTextLen();_check()},200)};if(opts.watchAll){if(opts.remainWordTarget){opts.remainWordTarget=typeof opts.remainWordTarget=="object"?opts.remainWordTarget:$E(opts.remainWordTarget)}if(_length(getText())>0){remainTextLen()}var _arrEvents="paste,copy,cut,focus".split(",");for(var i=0;i<_arrEvents.length;i++){STK.core.evt.addEvent($E(opts.id),_arrEvents[i],function(e){lazyCheck()})}$.addEvent($E(opts.id),"keyup",function(e){var _event=e||window.event,_keyCode=_event.charCode||_event.keyCode;if(_event.ctrlKey&&_keyCode=="90"){lazyCheck()}lazyCheck()});_check()}else{return _check()}}});STK.register("module.cTextAreaUtils",function($){var ds=document.selection;var utils={getCursorPos:function(obj){var CaretPos=0;if($.IE){obj.focus();var range=null;range=ds.createRange();var stored_range=range.duplicate();stored_range.moveToElementText(obj);stored_range.setEndPoint("EndToEnd",range);obj.selectionStart=stored_range.text.length-range.text.length;obj.selectionEnd=obj.selectionStart+range.text.length;CaretPos=obj.selectionStart}else{if(obj.selectionStart||obj.selectionStart=="0"){CaretPos=obj.selectionStart}}return CaretPos},setCursor:function(obj,pos,coverlen){pos=pos==null?obj.value.length:pos;coverlen=coverlen==null?0:coverlen;obj.focus();if(obj.createTextRange){var range=obj.createTextRange();range.move("character",pos);range.moveEnd("character",coverlen);range.select()}else{obj.setSelectionRange(pos,pos+coverlen)}},insertText:function(oElement,sInsertText,nStart,nLen){oElement.focus();nLen=nLen||0;if(!ds){var text=oElement.value,start=nStart-nLen,end=start+sInsertText.length;oElement.value=text.slice(0,start)+sInsertText+text.slice(nStart,text.length);this.selectText(oElement,end,end);return}var c=ds.createRange();c.moveStart("character",-nLen);c.text=sInsertText},selectText:function(oElement,nStart,nEnd){oElement.focus();if(!ds){oElement.setSelectionRange(nStart,nEnd);return}var c=oElement.createTextRange();c.collapse(1);c.moveStart("character",nStart);c.moveEnd("character",nEnd-nStart);c.select()}};return utils});STK.register("module.cIsFun",function(){return function(obj){if(!obj){return false}if(Object.prototype.toString.call(obj)==="[object Function]"){return true}else{return false}}});STK.register("tool.io.ijax",function($){var encodeDoubleByte=function(str){if(typeof str!="string"){return str}return encodeURIComponent(str)},getElementsByClass=function(el,tg,clz){el=el||document;var rs=[];clz=" "+clz+" ";var cldr=el.getElementsByTagName(tg),len=cldr.length;for(var i=0;i<len;++i){var o=cldr[i];if(o.nodeType==1){var ecl=" "+o.className+" ";if(ecl.indexOf(clz)!=-1){rs[rs.length]=o}}}return rs},$C=document.createElement,$E=$.E,Ijax={arrTaskLists:[],createLoadingIframe:function(){if(this.loadFrames!=null){return false}var rndId1="loadingIframe_thread"+Math.ceil(Math.random()*10000);var rndId2="loadingIframe_thread"+Math.ceil((Math.random()+1)*10000);this.loadFrames=[rndId1,rndId2];var html='<iframe id="'+rndId1+'" name="'+rndId1+'" class="invisible"	              scrolling="no" src=""	              allowTransparency="true" style="display:none;" frameborder="0"	              ></iframe>				  <iframe id="'+rndId2+'" name="'+rndId2+'" class="invisible"	              scrolling="no" src=""	              allowTransparency="true" style="display:none;" frameborder="0"	              ></iframe>';var oIjaxIframeCnt=document.createElement("div");oIjaxIframeCnt.id="ijax_iframes";oIjaxIframeCnt.innerHTML=html;document.body.appendChild(oIjaxIframeCnt);var loadTimer=setInterval($.core.func.bind(this,function(){if($E(this.loadFrames[0])!=null&&$E(this.loadFrames[1])!=null){clearInterval(loadTimer);loadTimer=null;this.loadingIframe={thread1:{container:$E(this.loadFrames[0]),isBusy:false},thread2:{container:$E(this.loadFrames[1]),isBusy:false}};this.loadByList()}}),10)},isIjaxReady:function(){if(typeof this.loadingIframe=="undefined"){return false}for(var oLoadCnt in this.loadingIframe){if(this.loadingIframe[oLoadCnt].isBusy==false){this.loadingIframe[oLoadCnt].isBusy=true;return this.loadingIframe[oLoadCnt]}}return false},iRsqt:function(opt){var _m=opt.method||"get";var _args=opt.args;var args={};var s="";if("post"==_m.toLowerCase()){args.POST=_args}else{args.GET=_args}args.onComplete=opt.onComplete;args.onException=opt.onFail;this.request(opt.url,args)},request:function(url,option){var oTask={};oTask.url=url;oTask.option=option||{};this.arrTaskLists.push(oTask);if(this.loadFrames==null){this.createLoadingIframe()}else{this.loadByList()}},loadByList:function(){if(this.arrTaskLists.length==0){return false}var loadStatus=this.isIjaxReady();if(loadStatus==false){return false}var newData=this.arrTaskLists[0];this.loadData(newData.url,newData.option,loadStatus);this.arrTaskLists.shift()},loadData:function(url,option,loader){var _url=new $.core.util.URL(url);if(option.GET){for(var key in option.GET){_url.setParam(key,encodeDoubleByte(option.GET[key]))}}_url.setParam("domain","1");_url=_url.toString();var ifm=loader.container;ifm.listener=$.core.func.bind(this,function(){try{var iframeObject=ifm.contentWindow.document,sResult;var tArea=getElementsByClass(iframeObject,"textarea","")[0];if(typeof tArea!="undefined"){sResult=tArea.value}else{if(iframeObject.body.textContent!=undefined){sResult=iframeObject.body.textContent}else{if(iframeObject.body.innerText!=undefined){sResult=iframeObject.body.innerText}else{sResult=iframeObject.body.innerHTML}}}if(option.onComplete){option.onComplete(sResult)}else{option.onException()}}catch(e){if(option.onException){option.onException(e.message,_url.toString())}}loader.isBusy=false;$.core.evt.removeEvent(ifm,"load",ifm.listener);this.loadByList()});$.core.evt.addEvent(ifm,"load",ifm.listener);if(option.POST){var oIjaxForm=document.createElement("form");oIjaxForm.id="IjaxForm";oIjaxForm.action=_url;oIjaxForm.method="post";oIjaxForm.target=ifm.id;for(var oItem in option.POST){var oInput=document.createElement("input");oInput.type="hidden";oInput.name=oItem;oInput.value=option.POST[oItem];oIjaxForm.appendChild(oInput)}document.body.appendChild(oIjaxForm);oIjaxForm.submit();$.removeNode(oIjaxForm)}else{try{window.frames(ifm.id).location.href=_url}catch(e){ifm.src=_url}}}};return Ijax});STK.register("kd.KDSendComment",function($){var _host=$.module.cPluginCfg.cfg.URL.URL_INNER,staticConfig=$.kd.kdStaticConfig;var executeMethod=function(fun,args){if(fun){fun(args)}};return function(opt){var _args={id:"",content:"",time:"0",picPath:"",url:"",picWith:"0",source:"1",fm:"0000",sFlag:"",domain:"1",pkID:"",tkID:"",rkID:"",method:""};var _need={id:"",content:"",time:"",picPath:"",url:"",sFlag:"",method:"",cId:""};$.parseParam(_need,opt);$.parseParam(_args,_need);_args.picWith=_need.picPath?"1":"0";var _ipalayUrl="http://kandian.com/";if(_need.cId){_ipalayUrl+="a/"+_need.cId+"/"+_need.id+".html"}else{_ipalayUrl+="p/"+_need.id+".html"}_ipalayUrl+="?playTime="+_args.time;_args.content=_args.content+" "+_ipalayUrl;var postUrl=_args.url?_args.url:_host+"api/1.1/comment/sendComment.php?domain=1";var _complete=function(result){if(typeof result=="string"){result=$.strToJson(result)}var _result=result;if(_result.result=="0"){if(_result.errorNum=="400"&&opt.onRepeat){executeMethod(opt.onRepeat(_result))}else{executeMethod(opt.onError(_result))}return}executeMethod(opt.onComplete(_result))};var _config=staticConfig.get();$.parseParam(_args,_config);if(_args.method=="ajax"){_args.content=encodeURIComponent(_args.content);$.ajax({url:_args.url,charset:"UTF-8",timeout:20*1000,args:_args,onComplete:function(result){_complete(result)},onTimeout:function(){executeMethod(opt.onError())},onFail:function(){executeMethod(opt.onError())},method:"post",responseType:"json"})}else{$.tool.io.ijax.request(postUrl,{onComplete:function(result){_complete(result)},onException:function(){executeMethod(opt.onError())},POST:_args})}}});STK.register("kd.KDComment",function($){var _kdOpt={id:"",subId:"",showCount:"",max:120,defaultTxt:"",initText:"",getPic:function(){return{}},url:"",onSending:false,onReat:false,onSuccess:false,onError:false,onStartIn:false,sFlag:"",showState:"",method:""};var _focus=function(textArea){$.module.cTextAreaUtils.setCursor(textArea)};var $login=$.kd.KDUser;var _isSubmit=false;var _submit=function(e){if(!$login.isLogin()){return false}var _value=$.E(_kdOpt.id);var _length=$.bLength(_value.value);if(!$.trim(_value.value)||_length>_kdOpt.max*2||$.trim(_value.value)==_kdOpt.defaultTxt){_state.showInpuError();return false}if(_isSubmit){return false}_state.showLoading();_isSubmit=true;var _source=_kdOpt.getPic();$.kd.KDSendComment({id:_source.epgId,content:_value.value,time:_source.playTime,url:_kdOpt.url,picPath:_source.picPath,sFlag:_kdOpt.sFlag,method:_kdOpt.method,pkID:_kdOpt.pkID,tkID:_kdOpt.tkID,rkID:_kdOpt.rkID,onComplete:function(json){_isSubmit=false;_value.value=_kdOpt.initText;_state.showSuccess();if($.module.cIsFun(_kdOpt.onSuccess)){try{_kdOpt.onSuccess(_source.playTime,json)}catch(e){}}},onError:function(code,msg){_isSubmit=false;_state.showErrorMsg()},onRepeat:function(json){_isSubmit=false;if(json.errorNum.indexOf("illegal")>=0){_state.showRepeat("微博内容含有敏感词，请修改后重新发布。")}else{_state.showRepeat()}}})};var _state={_msgDiv:false,init:function(id){var that=this;if(!_kdOpt.showState){var _area=$.E(id);var _height=_area.clientHeight,_width=_area.clientWidth;var _div=$.C("div");_div.style.cssText="display:none;width:"+_width+"px;height:"+_height+"px;position:absolute;background:white;text-align:center;";that._msgDiv=_div;document.body.appendChild(that._msgDiv)}else{_msgDiv=$.E(_kdOpt.showState)}},hiddenState:function(){var that=this;setTimeout(function(){$.setStyle(that._msgDiv,"display","none");_focus($.E(_kdOpt.id))},2000)},showState:function(){if(!_kdOpt.showState){var _pos=$.position($.E(_kdOpt.id));$.setStyle(this._msgDiv,"left",_pos.l+"px");$.setStyle(this._msgDiv,"top",_pos.t+"px")}$.setStyle(this._msgDiv,"display","block")},showErrorMsg:function(){var that=this;if(that._msgDiv){that.showState();if(!_kdOpt.showState){that._msgDiv.innerHTML="<span style=\"display: inline-block;padding-left: 51px;padding-top:16px;height: 32px;font: 24px/32px 'Microsoft Yahei';background: url(http://sjs0.sinajs.cn/kandian/images/play/stv_hh_fail.gif) left center no-repeat;\">抱歉，发布失败</span>"}else{that._msgDiv.innerHTML='<div class="kandian_tips kandian_fail"> <span>抱歉，发布失败</span><p><a href="http://weibo.com/n/%E7%9C%8B%E7%82%B9" target="_blank" title="">联系客服</a></p></div>'}}if($.module.cIsFun(_kdOpt.onError)){_kdOpt.onError()}that.hiddenState()},showInpuError:function(){var _textArea=$.E(_kdOpt.id);_focus(_textArea);$.setStyle(_textArea,"background","#EEA3A3");setTimeout(function(){$.setStyle(_textArea,"background","")},300)},showRepeat:function(msg){var that=this;if(that._msgDiv){that.showState();if(!_kdOpt.showState){that._msgDiv.innerHTML="<span style=\"display: inline-block;padding-left: 51px;padding-top:16px;height: 32px;font: 24px/32px 'Microsoft Yahei';background: url(http://sjs0.sinajs.cn/kandian/images/play/stv_hh_error.gif) left center no-repeat;\">不要太贪心哦，发一次就够啦</span>"}else{that._msgDiv.innerHTML='<div class="kandian_tips kandian_repeatError"><span>'+(msg||"不要太贪心哦，发一次就够啦")+"</span> </div>"}}if($.module.cIsFun(_kdOpt.onError)){_kdOpt.onError()}that.hiddenState()},showLoading:function(){var that=this;if(that._msgDiv){that.showState();if(!_kdOpt.showState){that._msgDiv.innerHTML="<span style=\"display: inline-block;padding-left: 51px;padding-top:16px;height: 32px;font: 24px/32px 'Microsoft Yahei';background: url(http://sjs0.sinajs.cn/kandian/images/common/stv_loading.gif) left center no-repeat;\">发布中，请稍等</span>"}else{that._msgDiv.innerHTML='<div class="kandian_tips kandian_loading"><span>发布中，请稍等</span> </div>'}}if($.module.cIsFun(_kdOpt.onSending)){_kdOpt.onSending()}},showSuccess:function(){var that=this;if(that._msgDiv){that.showState();if(!_kdOpt.showState){that._msgDiv.innerHTML="<span style=\"display: inline-block;padding-left: 51px;padding-top:16px;height: 32px;font: 24px/32px 'Microsoft Yahei';background: url(http://sjs0.sinajs.cn/kandian/images/play/stv_hh_success.gif) left center no-repeat;\">已发送至新浪微博</span>"}else{that._msgDiv.innerHTML='<div class="kandian_tips kandian_success"><span>发布成功</span></div>'}}that.hiddenState()}};var _comment={init:function(opt){var _textArea=opt.id;if(!_textArea){console.error("未传入textareaid")}$.parseParam(_kdOpt,opt);_textArea=$.E(_textArea);$.module.checkTextLength({id:_textArea,callBack:function(a,b){var _length=$.bLength(_textArea.value);if(_length>240){$.E(_kdOpt.id).value=$.leftB(_textArea.value,240);if($.E(_kdOpt.showCount)){$.E(_kdOpt.showCount).innerHTML=_kdOpt.max}}},maxLen:_kdOpt.max,remainWordTarget:_kdOpt.showCount,watchAll:_kdOpt.showCount?true:false,defaultText:_kdOpt.defaultTxt});_state.init(_textArea);_textArea.value=_kdOpt.defaultTxt;$.addEvent(_textArea,"focus",function(e){if(_textArea.value==_kdOpt.defaultTxt){_textArea.value=_kdOpt.initText;_focus(_textArea)}});$.addEvent(_textArea,"blur",function(e){if($.trim(_textArea.value)==""){_textArea.value=_kdOpt.defaultTxt;_focus(_textArea)}});$.addEvent(_textArea,"keyup",function(e){var state=_kdOpt.getPic().state;if($.trim(_textArea.value)!=""&&state===0){if($.module.cIsFun(_kdOpt.onStartIn)){_kdOpt.onStartIn()}}});$.addEvent(_textArea,"keyup",function(e){e=e||window.event;if((e.keyCode==13)&&(e.ctrlKey)){$.fireEvent($.E(_kdOpt.subId),"click")}});$.addEvent($.E(_kdOpt.subId),"click",function(e){_submit(e)})},resetOpt:function(opt){if(opt){$.parseParam(_kdOpt,opt)}}};return _comment});STK.register("module.cFormatDate",function($){var d={buildDate:function(str){if(typeof(str)=="number"){return new Date(str)}else{if(str instanceof Date){return str}}if(!str){return null}if(str.indexOf("+")>=0){str=str.replace("+0800 ","")}str=str.replace(/-/g,"/");return new Date(str)},format:function(dataStr,pattern){var date=this.buildDate(dataStr);var hour=date.getHours();var o={"M+":date.getMonth()+1,"d+":date.getDate(),"H+":hour,"h+":(hour>12?hour-12:hour),"m+":date.getMinutes(),"s+":date.getSeconds(),"q+":Math.floor((date.getMonth()+3)/3),S:date.getMilliseconds()};if(/(y+)/.test(pattern)){pattern=pattern.replace(RegExp.$1,(date.getFullYear()+"").substr(4-RegExp.$1.length))}for(var k in o){if(new RegExp("("+k+")").test(pattern)){pattern=pattern.replace(RegExp.$1,RegExp.$1.length==1?o[k]:("00"+o[k]).substr((""+o[k]).length))}}return pattern},getChineseDate:function(tar,res){if(!res){res=new Date()}if(typeof(tar)=="string"){tar=this.buildDate(tar)}if(!tar||!tar.getTime()){return""}var resTime=res.getTime();var tarTime=tar.getTime();var between=(resTime-tarTime)/1000;return this.between(between)+"前"},between:function(bet){bet=Math.abs(parseInt(bet));bet=bet==0?1:bet;if(bet<60){return bet+"秒"}if(bet<3600){return parseInt(bet/60)+"分钟"}if(bet<3600*24){return parseInt(bet/3600)+"小时"}if(bet<3600*24*30){return parseInt(bet/(3600*24))+"天"}if(bet<3600*24*30*12){return parseInt(bet/(3600*24*30))+"月"}return parseInt(bet/(3600*24*30*12))+"年"},liveTime:function(second){},differenceTime:function(second,str,flag){var m=parseInt(second/60);var h=parseInt(m/60);var s=second%60;m=m<10?"0"+m:m;s=s<10?"0"+s:s;if(!/h+/.test(str)){var o={"m+":m,"s+":s};for(var k in o){if(new RegExp("("+k+")").test(str)){str=str.replace(RegExp.$1,o[k])}}}else{h=h<10?"0"+h:h;m=m%60;m=m<10?"0"+m:m;var o={"h+":h,"m+":m,"s+":s};for(var k in o){if(new RegExp("("+k+")").test(str)){str=str.replace(RegExp.$1,o[k])}}}if(h==0&&flag==true){return str.substr(3,7)}return str}};return d});STK.register("kd.KDPicImage",function($){var _config={con:false,player:false,showTime:false,onSuccess:false,onTimeout:false};var _cacheFun={time:"0",type:"2",callback:function(){}};var _result={time:0,pic:"",state:0},_reCatchPic=function(){_catchPicFun(_cacheFun.time,_cacheFun.type,_cacheFun.callback)},_catchTimer=false,_catchPicFun=function(time,type,callback){_result.state=1;_result.time=time;_cacheFun={time:time,type:type,callback:callback};_state.showLoading();_config.player.catchPic({time:time,type:type},function(isSuc,picUrl){if(isSuc){_result.state=1;var _little=picUrl.split(",");_result.pic=_little[1];if($.E(_config.showTime)){$.E(_config.showTime).innerHTML=$.module.cFormatDate.differenceTime(parseInt(time),"hh:mm:ss")}_state.showImg(time,_little[0]);try{if(callback){callback(picUrl[0],_little[1])}}catch(e){}if(_catchTimer){clearTimeout(_catchTimer)}if(_config.onSuccess){_config.onSuccess(_little[0],_little[1])}}else{_result.state=0;_state.showFail();if(_config.onTimeout){_config.onTimeout()}}})};var _state={showLoading:function(){if($.E(_config.con)){$.E(_config.con).innerHTML='<span style="display:inline-block;height:91px;line-height:91px;text-align:center;width:100%;"><a style="width:15px;height:15px;background:url(http://sjs0.sinajs.cn/kandian/images/common/stv_hh_loading.gif) no-repeat left center;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</a>&nbsp;正在加载</span>'}},showImg:function(time,img){if($.E(_config.con)){$.E(_config.con).innerHTML='<img src="'+img+'">'}},showFail:function(){if($.E(_config.con)){$.E(_config.con).innerHTML='<span style="display:inline-block;height:91px;line-height:91px;text-align:center;width:100%;">加载失败<a href="javascript:void(0)" action_type="refresh">请刷新</a></span>'}},showNormal:function(){if($.E(_config.con)){$.E(_config.con).innerHTML="<div>点击时间按钮<br>获取截图</div>"}}};var _picImage={init:function(opt){if(opt&&opt.player){$.parseParam(_config,opt);var _clickToCatchPic=function(){var _time=opt.player.getCurrentTime().playTime;if(opt.showTime&&$.E(opt.showTime)){$.E(opt.showTime).innerHTML=$.module.cFormatDate.differenceTime(parseInt(_time),"hh:mm:ss")}_catchPicFun(_time,"2")};if(opt.con&&$.E(opt.con)){var _del=new $.core.evt.delegatedEvent($.E(opt.con));_del.add("getImg","click",function(elt){_clickToCatchPic()});_del.add("refresh","click",function(elt){_reCatchPic()});_del.add("delete","click",function(elt){_result.state=3;_state.showNormal()})}if(opt.showTime){$.addEvent($.E(opt.showTime),"click",function(e){_clickToCatchPic()})}}},reCatchPic:function(){_reCatchPic()},catchPic:function(time,type,callback){if(!time){time=_config.player.getCurrentTime().playTime;type="1"}if(_config.player){_catchPicFun(time,type,callback)}},getPic:function(){return _result}};return _picImage});STK.register("module.cPluginCfg",function($){var _cfg=$.cfg.cKanDianCfg;return{cfg:_cfg,setCfg:function(config){for(var i in config){_cfg[i]=config[i]}},toDefault:function(){_cfg=$.cfg.cKanDianCfg}}});STK.register("kd.KDGetEmceeList",function($){var $cfg=$.module.cPluginCfg;var args={fId:0,epgId:0,filter_all:"y",filter_friend:"y",filter_host:"y",filter_ext:"",st:0,ofs:30,op:3,uId:"000000"};var conf={successCallback:function(data){},failCallback:function(){}};var emcee={init:function(param){conf=$.parseParam(conf,param)},getEmcee:function(epgId){if(!epgId){return}args.epgId=epgId;var inner=$cfg.cfg.URL.URL_INNER;$.jsonp({url:inner+"api/1.1/interMsgList.php",timeout:10000,args:args,onComplete:function(json){if(json&&json.result=="0"){conf.failCallback()}else{conf.successCallback(json.data.emceeList||[])}},onTimeout:function(){conf.failCallback()}})},destroy:function(){}};return emcee});STK.register("kd.KDDefaultTextArea",function($){var _arr=['<div class="sTV_comment clearfix"><!--正常模式-->','<div class="sTV_textareaBox">','<div class="kandian_num" id="showNum">120</div>','<!--<label class="comment_default" for=""></label>-->','<textarea id="textareaId"></textarea>','<div class="sTV_smile"><a href="javascript:void(0)" title="" id="showEmons" class="sTV_smileBtn">表情</a><a href="javascript:void(0)" title="" id="clearContent class="sTV_clearBtn">清空</a></div>','<div id="showState"></div>',"</div>",'<div class="sTV_BtnBox"> <a href="javascript:void(0)" title="" id="submitComment" class="kandian_issue">发布</a>','<p class="kandian_time" id="catcImgButton">00:00</p>',"</div>","<!--这个默认的文字当textarea得到焦点时隐藏-->","</div>"].join("");return function(divId,callback){var _con=$.E(divId);if(_con){$.addHTML(_con,_arr);$.addEvent($.E("clearContent"),"click",function(){$.E("textareaId").value=""});if($.module.cIsFun(callback)){callback()}}}});STK.register("kd.KDGetCommentData",function($){var _apiHost=$.module.cPluginCfg.cfg.URL;var $user=$.kd.KDUser;var _timeout=10000;var _interval=1000;var _getInterVal=function(){if(_conf.interval&&typeof _conf.interval=="number"){return _conf.interval}var r=(Math.random()*10)+10;return parseInt(_interval*r)};var _timer=null;var comment={};var _op=3;var _conf={player:{getCurrentTime:function(){return{playTime:0}}},epgId:"",evt:{onSuccess:function(data){},onfail:function(){}},interval:false,onHost:false};var _filter={all:"y",friend:"y",host:"y",ext:""};var _user={uid:"000000",uName:""};var _getCommentData=function(opt){if(!opt.epgId){return}$.jsonp({url:_apiHost.URL_INNER+"api/1.1/interMsgList.php",timeout:_timeout,args:{fId:opt.fId||0,epgId:opt.epgId,filter_all:opt.filterAll||"y",filter_friend:opt.filterFriend||"y",filter_host:opt.filterHost||"y",filter_ext:opt.filterExt||"",st:opt.playTime||0,ofs:opt.ofs||30,op:_op,uId:opt.uId||"000000"},onComplete:function(json){if(_op==3){_op=0;try{comment.setHost(json.data.emceeList)}catch(e){}}if(json.result=="0"){_conf.evt.onfail()}else{_conf.evt.onSuccess(json.data.cList)}},onTimeout:function(){_conf.evt.onfail()}})};var _getCurrentEpg=function(){return{fId:0,epgId:_conf.epgId,playTime:_conf.player.getCurrentTime().playTime||0,filterAll:_filter.all,filterFriend:_filter.friend,filterHost:_filter.host,filterExt:_filter.ext,uId:_user.uid}};var _getCommentInterval=function(){try{if(_timer){clearTimeout(_timer)}var opt=_getCurrentEpg();_getCommentData(opt);var t=_getInterVal();_timer=setTimeout(_getCommentInterval,t)}catch(e){console.error(e)}};comment={init:function(param){_conf=$.parseParam(_conf,param);if(param.filter){_filter=$.parseParam(_filter,param.filter)}if(param.uId){_user.uid=param.uId}if($user.isLogin()){var user=$user.getUser();_user.uid=user.uid||"000000";_user.uName=user.uName||""}else{$user.onLogin(function(user){_user.uid=user.uid||"000000";_user.uName=user.uName||"";comment.stop();comment.start()})}comment.start()},_host:[],setHost:function(host){this._host=host;if(_conf.onHost){_conf.onHost(this._host)}},start:function(){if(_conf.epgId){_getCommentInterval()}},stop:function(){if(_timer){clearTimeout(_timer)}},setFilter:function(newFilter){_filter=$.parseParam(_filter,newFilter)},resetParam:function(param){var conf={epgId:_conf.epgId,interval:_conf.interval,filter:_filter};conf=$.parseParam(conf,param);var _change=false;if(_conf.epgId!=conf.epgId){_conf.epgId=conf.epgId;_change=true;_op=3}if(_conf.interval!=conf.interval){_conf.interval=conf.interval;_change=true}if(_filter!=conf.filter){_filter=conf.filter;_change=true}if(_change){comment.stop();comment.start()}},destroy:function(){try{comment.stop()}catch(e){}}};return comment});STK.register("module.cIsFun",function(){return function(obj){if(!obj){return false}if(Object.prototype.toString.call(obj)==="[object Function]"){return true}else{return false}}});STK.register("module.stvCf",function($){var config={host:"http://kandian.com",apiHost:"http://inner.kandian.com",wbHost:"http://www.weibo.com",wbAPI:"http://api.weibo.com",innerHost:"http://inner.kandian.com/",staticHost:"http://sjs0.sinajs.cn/kandian",getStHost:function(){var _h="http://sjs0.sinajs.cn/kandian/js";return _h},getJSPath:function(){var _h="http://sjs0.sinajs.cn/kandian/js";return _h},getIMGPath:function(){var _h="http://sjs0.sinajs.cn/kandian/images/";return _h},getFlasPath:function(){return"http://p.you.video.sina.com.cn/kandianswf"},getFrameImg:function(fId){var _src=this.getIMGPath();return _src+"frame/"+fId+".png"},getVersion:function(){return"1.2"}};return config});STK.register("module.p2pMedium",function($){var _host=$.module.stvCf.staticHost;window.stopInstall=function(){if(p2pMedium.boxContainerDivElt){p2pMedium.stopInstall()}if(p2pMedium.p2pErrorDiv){$.removeNode(p2pMedium.p2pErrorDiv);p2pMedium.resizePlayerSize();p2pMedium.p2pErrorDiv=false}};var p2pMedium={init:function(){try{if(this.onInstallOK){this.onInstallOK()}else{var _nowPlay=$.component.cpSvPlaylist.playlistTools.nowPlayInfo;var _f=$.component.cpSvPlaylist.playlistTools.getFrameDataByFid(_nowPlay.fId);$.component.cpSvPlayer.play(_nowPlay.fId,_nowPlay.epgId,{f:_f,epg:_nowPlay})}}catch(err){}},onInstallOK:function(){var epgId=KD.kd.KDPlayer.getPlayData().id;KD.kd.KDPlayer.play(epgId)},p2pInstallInfo:{get_product_list:"正在获取产品列表，请稍候",invalid_id:"产品列表下载失败",get_install_pack:"开始下载安装包",pack_check_error:"安装包校验失败",pack_write_error:"安装写入失败",install_product:"开始安装",create_process_error:"进程创建失败",install_time_out:"安装进程超时",setup_process_error:"安装进程异常",finished:"安装完成"},packageUrl:"http://image2.sina.com.cn/video/p2psetup/sinalive_setup20110117.exe",notWindowsNotice:function(){var arrHtml=[];arrHtml.push('<div id="p2p_load_warn_1" style="display: block;">');arrHtml.push('<div class="box_play" id="p2p_load_warn_1" style="display: block;">');arrHtml.push('<p style="text-align: center;" id="iefailStatus" class="ff">抱歉！目前直播只支持Windows操作系统！</p>');arrHtml.push("</div>");arrHtml.push("</div>");this.addNotice(arrHtml.join(""))},addErrorClass:function(){if(!$.E("p2pErrorCss")){var oStyle=document.createElement("link");oStyle.type="text/css";oStyle.href=_host+"/css/play/stv_p2perror.css";oStyle.rel="stylesheet";oStyle.id="p2pErrorCss";document.getElementsByTagName("head")[0].appendChild(oStyle)}},addNotice:function(noticeHtml){this.addErrorClass();var _p2pErrorDiv=document.getElementById("p2pErrorDiv");if(!_p2pErrorDiv){_p2pErrorDiv=document.createElement("div");_p2pErrorDiv.id="p2pErrorDiv";_p2pErrorDiv.style.display="none";$.E("vPlayer").parentNode.appendChild(_p2pErrorDiv);p2pMedium.minPlayer();_p2pErrorDiv.style.display="block";_p2pErrorDiv.innerHTML=noticeHtml;p2pMedium.p2pErrorDiv=_p2pErrorDiv}},FFP2PLoad:function(sendState){var arrHtml=[];arrHtml.push('<div id="p2p_load_warn_1" style="display: block;">');arrHtml.push('<div class="box_play" id="p2p_load_warn_1" style="display: block;">');arrHtml.push('<p style="display:block;" class="ff">请 <a href="http://image2.sina.com.cn/video/p2psetup/sinalive_setup20110117.exe" class="p2p_load_href">点击下载SinaLive播放器</a>，在本地手动安装<br>');arrHtml.push('安装结束后，如果还出现此提示，请点击 <a href="javascript:window.location.reload();">刷新</a></p>');arrHtml.push("</div>");arrHtml.push("</div>");this.addNotice(arrHtml.join(""));var number=1,objs=[document.getElementById("p2p_load_warn_1"),document.getElementById("p2p_load_warn_2"),document.getElementById("p2p_load_warn_3")];objs[0].style.display="block";if(false){window.setInterval(function(){if(number==3){number=0}for(var i=0;i<3;i++){if(i==number){objs[i].style.display="block"}else{objs[i].style.display="none"}}number++},3000)}},installFail:function(status,failInfo){clearInterval(p2pMedium._timer);var is_admin="",uac_level="";if(failInfo){is_admin=((/is_admin=([^&]+)/).exec(failInfo))||[];uac_level=(/uac_level=([^&]+)/).exec(failInfo)||[];is_admin=is_admin[1]?(is_admin[1]=="true"?"管理员":"非管理员"):"非管理员";uac_level=uac_level[1]?uac_level[1]:"1"}var _errInfo={get_product_list:"下载产品列表。",invalid_id:"产品ID错误。",get_install_pack:"安装包下载中。",pack_check_error:"下载安装包校验失败,请刷新页面或者手动下载安装包安装。",pack_write_error:"文件写入失败,可能被杀毒软件拦截,或者您不是以管理员身份在运行浏览器。请手动下载安装包进行安装。(当前用户权限"+is_admin+", uac级别("+uac_level+"))。",install_product:"正在执行安装。",create_process_error:"安装进程被拦截,请您检测杀毒软件设置,如果重复发生此问题，请执行以下操作: 打开IE菜单中的 “工具”=>”Internet选项”=>”高级” 页, 点击 “重置” 按钮, 选择 “重置”。 (当前用户权限(管理员/非管理员), uac级别(1))。",install_time_out:"安装过程超时,请您手动下载并以管理员身份运行安装包。(当前用户权限"+is_admin+", uac级别("+uac_level+"))。",setup_process_error:"安装进程发生未知错误, 请您手动下载并以管理员身份运行安装包。(当前用户权限"+is_admin+", uac级别("+uac_level+"))。",finished:"安装成功。"};p2pMedium.FFP2PLoad(true);if(_errInfo[status]){document.getElementById("failStatus").innerHTML=_errInfo[status];document.getElementById("iefailStatus").display="block"}else{document.getElementById("iefailStatus").display="none"}},noServer:function(){var _ua=navigator.userAgent.toLowerCase();if(!p2pMedium.isWin){this.notWindowsNotice();return false}this.addErrorClass();if(p2pMedium.isWin&&_ua.indexOf("msie")>0&&_ua.indexOf("win64")<0){var arrHtmlError=[];arrHtmlError.push('<div class="install_box_play" id="play_201010">');arrHtmlError.push('<div class="install_box_play_tit">');arrHtmlError.push("<h1>新浪视频 直播</h1>");arrHtmlError.push("</div>");arrHtmlError.push('<div class="install_box_4">');arrHtmlError.push('<p class="install_text">友情提示：由于您的浏览器禁用activex，导致无法下载直播插件。</p>');arrHtmlError.push('<p class="install_box_play_tips">建议尝试：1.使用IE6以上版本的浏览器观看；<br />');arrHtmlError.push('2.搜索"<a href="http://www.baidu.com/baidu?wd=%BD%E2%B3%FDactivex%BD%FB%D3%C3&tn=monline_dg" target="_blank">解除activex禁用</a>"更改浏览器设置后刷新更改浏览器设置后刷新更改浏览器设置后刷新页面。 </p>');arrHtmlError.push("</div>");arrHtmlError.push("</div>");var arrHtml0=[];arrHtml0.push('<div class="install_box_play" id="play_201010">');arrHtml0.push('<div class="problems">');arrHtml0.push("<h2>您注意到顶部的提示条了吗？您在安装过程中，可能会遇到以下问题：</h2>");arrHtml0.push('<div class="text">');arrHtml0.push("<p>1、等待浏览器顶部提示条，点击右键，安装此加载项。</p>");arrHtml0.push('<div class="pic1"></div>');arrHtml0.push("</div>");arrHtml0.push('<div class="text">');arrHtml0.push('<p>2、Win7、Vista用户注意：当询问您"是否允许程序对计算机<br />');arrHtml0.push('进行更改？"时，请点击"是"。</p>');arrHtml0.push('<div class="pic2"></div>');arrHtml0.push("</div>");arrHtml0.push("</div>");arrHtml0.push("</div>");var arrHtml1=[];arrHtml1.push('<div class="install_box_play" id="play_201010">');arrHtml1.push('<div class="install_box_play_tit">');arrHtml1.push("<h1>新浪视频 直播</h1>");arrHtml1.push("</div>");arrHtml1.push('<div class="install_box_1">');arrHtml1.push('<p class="install_text">安装直播插件，立即看直播</p>');arrHtml1.push('<div class="install_btn_1" id="setup_plugin"><a href="javascript:void(0)">立即安装</a></div>');arrHtml1.push('<p class="install_box_play_tips">友情提示：请使用IE6及以上的版本浏览器观看</p>');arrHtml1.push("</div>");arrHtml1.push("</div>");var arrHtml2=[];arrHtml2.push('<div class="install_box_play" id="play_201010">');arrHtml2.push('<div class="install_box_play_tit">');arrHtml2.push("<h1>新浪视频 直播</h1>");arrHtml2.push("</div>");arrHtml2.push('<div class="install_box_2">');arrHtml2.push('<div class="install_text">');arrHtml2.push('<p id="progress_msg">正在安装 Sina Live 插件，请稍候</p>');arrHtml2.push('<span class="install_ins"></span></div>');arrHtml2.push('<div class="install_progress_box">');arrHtml2.push('<div class="install_progress"><span class="install_left_bg"></span><span class="install_right_bg"></span><span class="install_box" id="progress_bar" style="width:0%;"></span></div>');arrHtml2.push('<span class="install_num" id="progress_num">0%</span></div>');arrHtml2.push('<p class="install_box_play_tips">如果安装程序正被杀毒软件阻止，请您取消此阻止</p>');arrHtml2.push("</div>");arrHtml2.push("</div>");var axObj=null;var objectcode=null;var boxContainerDivElt=document.createElement("div");boxContainerDivElt.id="p2pErrorDiv";boxContainerDivElt.style.display="none";$.E("vPlayer").parentNode.appendChild(boxContainerDivElt);p2pMedium.minPlayer();boxContainerDivElt.style.display="block";boxContainerDivElt.innerHTML=arrHtml0.join("");p2pMedium.boxContainerDivElt=boxContainerDivElt;var _TIMER_VALUE=500;var _TIMER_MAX_NUM=(1000*20)/_TIMER_VALUE;var _counter=0;var _isMaxthon=false;try{var _version=external.max_language_id;if("0001"==_version){_isMaxthon=true}}catch(e){_isMaxthon=false}var timer=setInterval(function(){_counter++;try{axObj=new ActiveXObject("install_service_v4.worker.1")}catch(e){if(_isMaxthon&&_counter===_TIMER_MAX_NUM){p2pMedium.minPlayer();boxContainerDivElt.style.display="block";boxContainerDivElt.innerHTML=arrHtmlError.join("")}var elt=document.getElementById("test_ax_obj");if(!elt){var objDivElt=document.createElement("div");objDivElt.style.display="none";objectcode='<object id=\'test_ax_obj\' classid="clsid:E758BC30-C8C3-4379-B27B-B50E146460A9" codebase="http://update.tv.sina.com.cn/live/p2p/install_service_v4.cab.cab#version=1,0,0,1" height=0 width=0></object>';objDivElt.innerHTML=objectcode;boxContainerDivElt.appendChild(objDivElt)}return false}clearInterval(timer);boxContainerDivElt.innerHTML="";if(!$.E("vPlayer").style){$.E("vPlayer").style={}}p2pMedium.minPlayer();boxContainerDivElt.style.display="block";boxContainerDivElt.innerHTML=arrHtml1.join("");var setupBtn=document.getElementById("setup_plugin");setupBtn.onclick=function(){boxContainerDivElt.innerHTML=arrHtml2.join("");var retval=axObj.exec("cmd=start&product_id=sina_live&product_list=http://update.tv.sina.com.cn/install/product_list_v3.html&params=checkInterval_30000");if("result=1"==retval){var statusInfo="";p2pMedium._timer=setInterval(function(){statusInfo=axObj.exec("cmd=query");var statusMsg=statusInfo.split("&")[0];var progressMsg=statusInfo.split("&")[1];var _status=statusMsg.split("=")[1];var _progress=progressMsg.split("=")[1];var _msgElt=document.getElementById("progress_msg");var _barElt=document.getElementById("progress_bar");var _numElt=document.getElementById("progress_num");_barElt.style.width=_progress+"%";_numElt.innerHTML=_progress+"%";_msgElt.innerHTML=p2pMedium.p2pInstallInfo[_status];switch(_status){case"get_product_list":return false;case"invalid_id":p2pMedium.installFail("invalid_id");return false;case"get_install_pack":return false;case"pack_check_error":p2pMedium.installFail("pack_check_error");return false;case"pack_write_error":p2pMedium.installFail("pack_write_error",statusInfo);return false;case"install_product":return false;case"create_process_error":p2pMedium.installFail("create_process_error",statusInfo);return false;case"install_time_out":p2pMedium.installFail("install_time_out",statusInfo);return false;case"setup_process_error":p2pMedium.installFail("setup_process_error",statusInfo);return false;case"install_failed":p2pMedium.installFail("install_failed");return false;case"finished":p2pMedium.stopInstall();p2pMedium.init();return false;default:clearInterval(p2pMedium._timer);return false}},500)}else{}return false}},_TIMER_VALUE)}else{p2pMedium.FFP2PLoad(false)}},stopInstall:function(){clearInterval(p2pMedium._timer);p2pMedium.boxContainerDivElt.parentNode.removeChild(p2pMedium.boxContainerDivElt);p2pMedium.boxContainerDivElt=null;p2pMedium.resizePlayerSize()},resizePlayerSize:function(){$.setStyle($.E("vPlayer"),"width",parseInt(p2pMedium.playerWidth)+"px");$.setStyle($.E("vPlayer"),"height",parseInt(p2pMedium.playerHeight)+"px")},minPlayer:function(){var _width=$.getStyle($.E("vPlayer"),"width");if(parseInt(_width)>10){p2pMedium.playerWidth=$.getStyle($.E("vPlayer"),"width");p2pMedium.playerHeight=$.getStyle($.E("vPlayer"),"height")}$.setStyle($.E("vPlayer"),"width","1px");$.setStyle($.E("vPlayer"),"height","1px")},connectFMS:function(){$.E("vPlayer").connectFMS()},notify:function(params){var fn=params[0],len=params.length,args=[],i;for(i=1;i<len;i++){args.push(params[i])}$.E("vPlayer")[fn].apply($.E("vPlayer"),args)},error:function(e){switch(e.name){case"noserver":p2pMedium.noServer();break;default:break}},io:{noServer:function(type,code){switch(type){case"noServer":p2pMedium.error({name:"noserver",message:"未找到p2p服务,请于"+p2pMedium.packageUrl+"下载最新版安装程序。"});break;case"noReturn":p2pMedium.error({name:"noreturn",message:"您现在的网络不可用,请刷新页面或查看网络设备。"});break;case"bufferError":switch(code){case"1":p2pMedium.error({name:"bufferError1",message:"没有视频流数据！"});break;case"2":p2pMedium.error({name:"bufferError2",message:"本直播只能在中国国内观看！"});break}break;case"domainError":p2pMedium.error({name:"domainError",message:"本直播只能在 <a href='http://sports.sina.com.cn/'>新浪网站</a> 播放！"});break;case"dnsError":p2pMedium.error({name:"dnsError",message:"连接失败，请刷新页面，如果您是拨号，请重新拨号。"});break;default:p2pMedium.error({name:"noserver",message:"未找到服务。"});break}},notify:function(){p2pMedium.notify(arguments)},error:function(err){p2pMedium.error(err)}},isWin:(function(){var platform=navigator.platform.toLowerCase();if(platform.match(/win/)){return true}return false})()};return p2pMedium});STK.register("kd.KDConfigD",function($){var _defaultConfig={user:{uid:"",uName:""},apiHost:"http://i.kandian.weibo.com/",epgId:"",comment:{useUI:false,sendCommentId:"",textAreaId:"",subComment:"",showCount:"",showState:"",showImg:"",catchImg:"",defaultTxt:"",initText:"",apiUrl:"",onSendComment:false,onCatchImg:false,sFlag:"",method:""},feed:{interval:false,onDataLoad:false},player:{id:"",width:560,height:423,autoPlay:true,onPlay:false,onComplete:false},statistics:{pkID:"",tkID:"",rkID:""}};var _initUtil={initComment:function(config){var _initComment=function(comm){$.kd.KDPicImage.init({con:comm.showImg,player:$.kd.KDPlayer,showTime:comm.catchImg,onSuccess:function(img1,img2){if($.module.cIsFun(comm.onCatchImg)){comm.onCatchImg(img1,img2)}},onTimeout:false});$.kd.KDComment.init({id:comm.textAreaId,subId:comm.subComment,showCount:comm.showCount,max:120,defaultTxt:comm.defaultTxt,initText:comm.initText,getPic:function(){var pic=$.kd.KDPicImage.getPic();return{playTime:pic.time,picPath:pic.pic,epgId:_defaultConfig.epgId,state:pic.state}},url:comm.apiUrl,sFlag:comm.sFlag,method:comm.method,onSuccess:function(time,weibo){if($.module.cIsFun(comm.onSendComment)){comm.onSendComment(time,weibo)}},onStartIn:function(){var _img=$.kd.KDPicImage.getPic();if(_img.state==0){$.kd.KDPicImage.catchPic()}}})};if(config.useUI){var commentConfig={textAreaId:"textareaId",showImg:"catchPic",catchImg:"catcImgButton",subComment:"submitComment",showCount:"showNum",showState:"showState"};$.parseParam(config,commentConfig);$.kd.KDDefaultTextArea(config.sendCommentId,function(){_initComment(commentConfig)})}else{_initComment(config)}},initFeed:function(config){$.kd.KDGetCommentData.init({player:$.kd.KDPlayer,interval:config.interval,uId:_defaultConfig.user.uid,epgId:_defaultConfig.epgId,evt:{onSuccess:function(data){if(config.onDataLoad){config.onDataLoad(data)}},onfail:function(){}}});$.kd.KDPlayer.onPlay.push(function(epgId){$.kd.KDGetCommentData.resetParam({epgId:epgId})})}};var _startConfig=function(config){var _staticConfig=$.kd.kdStaticConfig;_staticConfig.set(config.statistics);$.kd.KDUser.init(config.user.uid,config.user.uName,function(){});$.kd.KDPlayer.onPlay.push(function(epgId){_defaultConfig.epgId=epgId});$.kd.KDPlayer.init({id:config.player.id,width:config.player.width,height:config.player.height,onComplete:function(){$.kd.KDPlayer.play(config.epgId,{auto:config.player.autoPlay},function(_playData){var onPlay=config.player.onPlay;if(onPlay){config.player.onPlay(_playData)}});if(config.player.onComplete){config.player.onComplete()}if(config.comment){_initUtil.initComment(config.comment)}if(config.feed){_initUtil.initFeed(config.feed)}},playComplete:config.player.playComplete})};var _config={init:function(opt){if(!opt||!opt.epgId){return false}$.parseParam(_defaultConfig,opt);if(_defaultConfig.apiHost){var cfg=$.cfg.cKanDianCfg;cfg.URL.URL_INNER=_defaultConfig.apiHost;$.module.cPluginCfg.setCfg(cfg)}_startConfig(_defaultConfig)},setUser:function(user){$.kd.KDUser.setUser(user.uid,user.uName)}};return _config});return STK})();if(!window.STK){window.STK=KD};