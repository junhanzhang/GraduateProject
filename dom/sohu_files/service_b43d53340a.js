kola("newt.service.Account",["jquery.Core","newt.data.Model"],function(b,c){var a=c.create({registByPhoneNumber:{url:"/settings/bindMobile/registBindMobileNumber",params:"mobileNumber=${#phoneNumber}&password=${#password}&verificationCode=${#vCode}&returnurl=${#returnUrl}"},phoneNumberRegistAllow:{url:"/settings/bindMobile/registIsMobileBound",params:"mobileNumber=${#phoneNumber}"},getPhoneNumberVCode:{url:"/settings/bindMobile/registSendVerificationCode",params:"mobileNumber=${#phoneNumber}"},setAddress:function(f){var d={contactInfoRealName:encodeURIComponent(f.realName),contactInfoMobile:f.mobile,contactInfoProvince:f.province,contactInfoCity:f.city,contactInfoAddress:encodeURIComponent(f.address),contactInfoZipCode:f.zipCode};var e=this;b.ajax({url:"/settings/address/set",dataType:"json",type:"post",data:d,success:function(g){e.doSuccess(g)},error:function(g){e.doFail("服务器错误")}})},validUserName:function(f){var d={username:encodeURIComponent(f.uName)};var e=this;b.ajax({url:"/settings/base/validUsername",dataType:"json",type:"post",data:d,success:function(g){e.doSuccess(g)},error:function(g){e.doFail("服务器错误")}})},setUserName:function(f){var d={username:encodeURIComponent(f.uName)};var e=this;b.ajax({url:"/settings/base/setUserNameOnly",dataType:"json",type:"post",data:d,success:function(g){if(g.status==0){kola("newt.cr.crEvent",function(h){if(!g.data){g.data=f.uName}h.send("nickname_modified",g)})}e.doSuccess(g)},error:function(g){e.doFail("服务器错误")}})}});return a});kola("newt.service.Follows",["jquery.Core","newt.data.Model"],function(b,c){var a=c.create({follow:function(f){var d={act:"follow",friendids:f.uids.join(","),type:f.type};if(typeof(window.SRC_ID)!="undefined"){d.from=window.SRC_ID}if(window.LOOKEDUSER&&window.LOOKEDUSER.id){d.uid=window.LOOKEDUSER.id}var e=this;b.ajax({url:"/follow/addfollows",dataType:"json",type:"post",data:d,success:function(g){e.doSuccess(g)},error:function(g){e.doFail("服务器错误")}})},cancelFollow:function(f){var d={act:"cancel_follow",friendid:f.uid};if(window.LOOKEDUSER&&window.LOOKEDUSER.id){d.uid=window.LOOKEDUSER.id}var e=this;b.ajax({url:"/follow/deletefollow",dataType:"json",type:"post",data:d,success:function(g){e.doSuccess(g)},error:function(g){e.doFail("服务器错误")}})},followQuietly:{url:"/follow/addFollowQuietly",params:"friendId=${#friendId}",success:function(d){if(d.status==0){kola("newt.cr.crEvent",function(e){e.send("tw_follow_quietly",d.data)})}}}});c.addProcessors({model:a.follow,success:function(e,f){var d=f.params;if(e.status==0){kola("newt.data.Synchronizer, newt.cr.crEvent",function(j,o){j.save("follow_count",e.data.cnt);var n=d.uids;for(var h=0,g=n.length;h<g;++h){var k=b.extend({uid:n[h]},e.data);try{o.send("tw_follow_user",k)}catch(m){}j.saveSet("follow_op_list",n[h],true)}})}}});c.addProcessors({model:a.cancelFollow,success:function(e,f){var d=f.params;if(e.status==0){kola("newt.data.Synchronizer, newt.cr.crEvent",function(g,j){g.save("follow_count",e.data.cnt);var h=b.extend({uid:d.uid},e.data);try{j.send("tw_cancel_follow",d.uid,e.data.cnt,e.data);j.send("tw_update_follow_del",h)}catch(i){}g.saveSet("follow_op_list",d.uid,false)})}}});c.addProcessors({model:a,beforeCall:function(){if(window.isLogin==false||window.isLogin=="false"){kola("newt.util.Tool",function(d){d.iNoLogin()});return false}}});return a});kola("newt.service.TimelinePage",["jquery.Core","mvc.service.ServiceBuilder"],function(b,a){var c=a.create();a.addUrls({service:c,urls:{GET_PROFILE:"/profile",GET_PEOPLE:"/people"}});a.addNetService({service:c,name:"getProfile",processer:function(e,d){b.extend(d,{url:c.url("GET_PROFILE"),type:"get",dataType:"json",data:e.page});return d}});a.addNetService({service:c,name:"getPeople",processer:function(e,d){b.extend(d,{url:c.url("GET_PEOPLE"),type:"get",dataType:"json",data:e.page});return d}});return c});kola("newt.service.User",["jquery.Core","newt.data.Model","newt.cr.cr"],function(b,c,a){var d=c.create({has:function(f){var e=this;b.ajax({url:"/regist/checkNickName",type:"post",dataType:"json",cache:false,data:"nickname="+b.cr.encodeUTF(f.nickName)+"&mail="+(f.email?f.email:""),success:function(g){e.doSuccess(g)},error:function(h,g){e.doFail(g)}})},getUser:function(g){var f=this;var e={};if(g.hasOwnProperty("uid")){e.type="uid";e.val=g.uid}else{e.type="username";e.val=encodeURIComponent(g.nickname)}b.ajax({url:"/event/uinfo",type:"get",dataType:"json",cache:false,data:e,success:function(h){f.doSuccess(h)},error:function(i,h){f.doFail(h)}})}});return d});