kola("newt.widget.plus.Form",["jquery.Core","newt.net.NetCommon"],function(b,c){function a(e){var d=this;e=e?e:{};var f=b(e.form);b.extend(e,{form:f});e._ajax=b.extend(e._ajax,{url:f.attr("action"),type:f.method?f.method:"post"});e=b.extend({autoSubmit:false,preParser:function(g){return g}},e);b.extend(d,e);if(d.interFace){d.setInterface({interFace:d.interFace})}if(d.model){d.setModel({model:d.model})}if(d.autoSubmit==true){d.form.bind("submit",function(g){d.ajaxSubmit();g.stopPropagation();return false})}}a.prototype.setInterface=function(d){this.interFace=d.interFace};a.prototype.setModel=function(d){this.model=d.model};a.prototype.toArray=function(){return this.form.serializeArray()};a.prototype.getDOM=function(){return this.form.get(0)};a.prototype.toDataForm=function(e){var h=b("<form></form>");var g=new a({form:h});var j=this.toArray();for(var f=0,d=j.length;f<d;++f){g.addParam({name:j[f].name,value:j[f].value})}return g};a.prototype.toParams=function(){return this.form.serialize()};a.prototype.toElements=function(){return b(this.form.get(0)).find("[name]")};a.prototype.addParam=function(d){this.form.append("<input type='hidden' name='"+d.name+"' value='"+d.value+"'/>")};a.prototype.setParam=function(d){var e=this.form.find("input[name='"+d.name+"']");if(e.size()<=0){this.addParam({name:d.name,value:d.value})}else{e.val(d.value)}};a.prototype.getParam=function(e){var d=[];this.find("input[name='"+e.name+"']").each(function(){d.push(b(this).val())});if(d.length<=0){return null}return d};a.prototype.delParam=function(d){this.find("input[name='"+d.name+"']").remove()};a.prototype.paramMergeToStr=function(e){if(!e.sp){e.sp=","}var d=this.getParam({name:e.name});if(d==null){return}if(!e.targetName){this.delParam({name:e.name})}this.setParam({name:e.targetName||e.name,value:d.join(e.sp)})};a.prototype.ajaxSubmit=function(){var f=this;if(f.beforeAjaxSubmit){if(f.beforeAjaxSubmit()==false){return false}}if(this.interFace){var j=f.toArray();var h={};for(var g=0,e=j.length;g<e;++g){h[j[g].name]=j[g].value}h._ajax=f._ajax;f.interFace(h)}else{if(this.model){var j=f.toArray();var d={params:{}};for(var g=0,e=j.length;g<e;++g){if(d.params.hasOwnProperty(j[g].name)==true){if(b.isArray(d.params[j[g].name])==true){d.params[j[g].name].push(j[g].value)}else{d.params[j[g].name]=[d.params[j[g].name],j[g].value]}}else{d.params[j[g].name]=j[g].value}}b.extend(d,f.modelOptions);f.model(d)}else{b.extend(f._ajax,{data:f.preParser(f.toParams())});c.request(f._ajax)}}};a.prototype.find=function(d){return this.form.find(d)};return a});