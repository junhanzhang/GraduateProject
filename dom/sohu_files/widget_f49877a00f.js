kola("app.widget.Composer",["jquery.Core","kola.lang.Class","newt.Config","newt.util.StrUtil","app.widget.MultiPicEditor","newt.reply.VCode","newt.cr.cr","newt.cr.crSimpleEdit","newt.cr.crButton"],function(f,c,a,h,g,b){var e=function(){if(!window.isLogin){kola("newt.util.Tool",function(i){i.iNoLogin()});return false}return true};var d=c.create({syncHandler:function(){},beforeSubmit:function(){},maxLength:300,maxPicNum:12,autoResize:true,isShowVCode:false,submitSelector:"a.crJs_submit",emoteSelector:"li.crJs_em",picSelector:"li.crJs_ig",textMinCls:"tarea_min",_init:function(k){var p=this;f.extend(this,k||{});p.ct=f(p.container);var j=p.postEl=p.ct.find("div.post"),q=p.tareaEl=p.ct.find("div.tarea"),r=p.textEl=p.ct.find("textarea"),o=p.submitEl=p.ct.find(p.submitSelector);p.textHeight=r.height();var n=p.editor=j.crSimpleEdit({state:true,editDom:r,max:p.maxLength,intxt:p.emptyText||"",cut:false,ctrlEnterHandle:function(){o.trigger("mouseup")},syncHandle:function(){p.sync()},focusHandle:function(){if(p.autoResize){q.removeClass(p.textMinCls)}},blurHandle:function(){if(p.autoResize&&n.getVal()==""){q.addClass(p.textMinCls)}}}).getCrControl("crSimpleEdit");p.subBtn=o.crButton({loadingClass:"btn_loading",submitHandle:function(){if(p.beforeSubmit.call(p.scope||window,p)!==false){p.doSubmit()}else{p.sync()}}}).getCrControl("crButton");if(p.autoResize){kola("newt.lib.autoResize",function(){if(r.data("autoResize")!="true"){r.autoResize({extraSpace:17,limit:150}).data("autoResze","true")}})}var i=j.find(p.emoteSelector);if(i.size()>0){kola("newt.composer.emote.Emote",function(){tw.emote.initEmoteBtn(i,n)})}var m=j.find(p.picSelector);if(m.size()>0){p.initPic(m.children("a"))}kola("newt.composer.Attip",function(){new tw.AtTip(j)});if(p.stateId){f(p.stateWindow||window).unload(function(){var s=new Date(new Date().getTime()+1000*60*60*24);f.cr.cookie.set(p.stateId,n.getVal(),s);f.cr.cookie.set(p.stateId+"Height",r.height(),s)});var l=f.cr.cookie.get(p.stateId);if(l){n.setVal(l);if(p.autoResize){q.removeClass(p.textMinCls);r.height(f.cr.cookie.get(p.stateId+"Height"))}n.setCursorEnd()}}if(p.isShowVCode){b.init(j)}},sync:function(){var i=b.isPass(this.editor.elem);if(i&&this.editor.getVal()&&!this.editor.getLimitStatus()&&this.syncHandler.call(this.scope||window,this)!==false){this.subBtn.setEnable()}else{this.subBtn.setDisable()}},initPic:function(i){if(i.size()>0){this.picEditor=g.getEditor(this.editor,f.extend(f.extend({},this.picConfig||{}),{anchor:i,maxPicNum:this.maxPicNum}))}},doSubmit:function(){var i=this;if(!e()){i.subBtn.removeLoading();i.sync();return}var k=(i.topic||"")+i.editor.getVal();var j=f.extend({msg:k,pics:i.picEditor?i.picEditor.getValue():""},i.baseParams||{});j=b.getValue(i.editor.elem,j);if(k){f.ajax({url:i.action,type:"POST",dataType:"json",data:h.toUTF8Params(i.getParams?i.getParams(j):j),success:function(l){if(l.status==a.AJAX_STATUS.SUCCESS){i.editor.setVal(i.emptyText||"");i.subBtn.setDisable();if(i.stateId){f.cr.cookie.set(i.stateId,"")}if(i.picEditor){i.picEditor.close(false)}if(i.autoResize){i.tareaEl.addClass(i.textMinCls);i.textEl.height(i.textHeight)}if(i.onSuccess){i.onSuccess.call(i.scope||window,l)}else{kola("newt.dialog.Notice",function(){tw.notice.showTip("操作成功")})}}else{if(i.onFailure){i.onFailure.call(i.scope||window,l)}else{kola("newt.dialog.Notice",function(){tw.notice.alert(l.statusText)})}}},error:function(){kola("newt.dialog.Notice",function(){tw.notice.showErrTip("操作失败")})},complete:function(){i.subBtn.removeLoading()}})}}});return d});kola("app.widget.CopyPanel",["jquery.Core"],function(b){var a={bindEvents:function(){b("body").bind("click",function(f){var g=b(f.target);while(g.length>0){if(g[0]==b("body")[0]){break}try{var c=g.attr("copy-cat");if(c){g.after(a.createPanel(c));return true}}catch(d){}g=g.parent()}})},createPanel:function(c){var d='<div class="mcopy"><a class="close" title="关闭" onclick="this.parentNode.parentNode.parentNode.className+=\' noDis\'" href="javascript:function(){return false}"><i class="sign signX"><q>×</q><q class="k2">×</q></i></a><i class="txt blur"><input type="text" value="'+c+'" class="blur"></i><p class="btns3"><a href="javascript:void(0);" class="btn"><b>复制链接</b></a></p></div>';var e=b(d);b(e).find("p.btns3 a").click(function(){if(window.clipboardData){window.clipboardData.setData("Text",c);alert("地址已复制到剪切板")}else{alert("您的浏览器不支持自动复制，请选中按Ctrl+C手动复制地址")}});return e},getPos:function(h){var f=h.offset();if(!f.top){return{top:0,left:-500}}var j=self.boxBy.width(),i=self.boxBy.height(),k=b("body").width(),d=self.land.scrollLeft(),c=self.land.scrollTop(),g=f.top-(CRTWCONFIG.SCROLL_DOM.get(0)==window?CRTWCONFIG.SCROLL_DOM.scrollTop():0),e=40;self.box.removeClass("ncard_tl ncard_tr ncard_bl ncard_br");if(g>i+70){if(k-f.left>j){self.box.addClass("ncard_bl")}else{self.box.addClass("ncard_br");e=295}return{top:f.top+c-i-10,left:f.left+d+h.width()/2-e}}else{if(k-f.left>j){self.box.addClass("ncard_tl")}else{self.box.addClass("ncard_tr");e=295}return{top:f.top+c+h.height()+10,left:f.left+d+h.width()/2-e}}}};return a});kola("app.widget.FollowAndRecommendDelegate",["jquery.Core","newt.service.Follows","sohu.ctrl.Tips"],function($,Follows,Tips){var FollowAndRecommendDelegate=function(){var flag=false;return{configFollow:function(el){if(flag){return}flag=true;if(el==undefined||$(el).length==0){el=$("#t-sys")}$(el).bind("click",function(e){var followEl=$(e.target).parents('[behavior-data="show_recommend_window"]');if(followEl.length==0){return}var scrollTop=$(document).scrollTop(),btnRect=followEl[0].getBoundingClientRect(),btnLeft=parseInt(btnRect.left),btnTop=parseInt(btnRect.top)+scrollTop,tipsMove=50;Follows.follow({params:{uids:[$(followEl).attr("uid")]},success:function(json){$(followEl).remove();if(!($.cr.cookie.get("jingxuan_recommend_closeweek")=="true")){$.get("http://t.sohu.com/guide/discover/getRecommendUsrs",{targetUid:$(followEl).attr("uid")},function(data){var resultData=eval("("+data+")");if(resultData.status!=0){return false}var list=eval("("+resultData.data.recommendList+")");var targetNickName=resultData.data.targetnickname;if(list.length<2){Tips.showFucusAddTips(btnLeft,btnTop,-tipsMove)}else{kola("app.widget.RecommendUsersWindow",function(Window){var w=new Window();w.render(list);w.show(targetNickName)})}})}else{Tips.showFucusAddTips(btnLeft,btnTop,-tipsMove)}},fail:function(error){kola("newt.dialog.Notice",function(){tw.notice.alert("关注失败，请重试")})}})})}}}();return FollowAndRecommendDelegate});kola("app.widget.FollowUserDelegate",["jquery.Core","newt.Config","sohu.ctrl.Tips"],function(c,b,g){var a="btn_loading",e="fuc_dis";var h,i;var d=function(k,l){if(window.isLogin!==true){kola("newt.util.Tool",function(m){m.iNoLogin()});return}k=c(k);var j=k.data("uid");if(k.hasClass(e)||k.hasClass(a)||!j){return}k.addClass(a);kola("newt.service.Follows",function(n){var m=(j+"").split(",");n.follow({params:{uids:m},success:function(o){o=(c.type(o)==="string"?c.parseJSON(o):o);if(o.status==b.AJAX_STATUS.SUCCESS){k.removeAttr("title").html(m.length>1?"已全部关注":"已关注").addClass(e);if(m.length==1){var p=k.offset();g.showFucusAddTips(p.left,p.top,-100)}else{tw.notice.showTip("关注成功")}if(h){h.call(i||window,k)}}else{tw.notice.alert(o.statusText)}},fail:function(){tw.notice.showErrTip("操作失败")},complete:function(){k.removeClass(a)}})})};var f=function(){c("body").delegate('a[data-follow-user="true"]',"click",function(j){d(this,j)})};return{init:f,setHandler:function(j,k){h=j;i=k}}});kola("app.widget.ImageUploader",["jquery.Core","kola.lang.Class","newt.Config","newt.composer.ComboUploader","newt.util.Browser"],function(d,b,c,k,j){var h="btn_dis",a="noDis",f="frm_err",i="p.frmTip > b",e="div.frmC";var g=b.create({thumbCtSelector:"div.swfUpP",anchorSelector:"a.swfUpB",anchorWidth:59,anchorHeight:26,maxFileSize:10*1024*1024,thumbWidth:190,thumbHeight:115,uploadFailText:"上传图片失败",defaultBgImage:"image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAG4AAABuCAMAAADxhdbJAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAMZQTFRF3efv3+jw8vb5////2ufx8fX46/L36/H34+305e713+vz9fj63Ony8fb64ezz5u/22+jx2ujx4+vy7PL24Onw6O/03eny2efw7/P3+/z96vH27PL39vj69vn79Pf69Pj75O70/P3++fv95O302efx3ury4uz07PP39vj7+/3+2ebw8/f65u3z8fX54+z0/f3+9vn86fH34ez07/X5+Pr84urx/f7+5O715u/19fn73Ojx6PD24Ovz9/r87/T5f5Cc2Obw9/n7GQJVeAAAAq9JREFUeNrsmnl7ojAQxgNhkcOzqEVbq27vc7v3vUm+/5dqZ1WEgAjBTJ9a3j/GgOjPzLyDgQcigj4xhDAJMWPxXW58fl3EAseuok9IPxAkvDsRSPKDgPR9LJoIxVdCBKIMbJxA1Z7jAkxaAC2OaRVknImJM+tGSGkym6jiDhQ+5HJXjXag4sxLzvklWiOY1jPOMtVw5Qt3zkHnExyrzPhCMxTcEV/pCAFnnkW4M4XylbTK1ZCvNbzS7cxTHtdpedxArXBq5RuUqp15KOEOTY1WOR5yWcNjfTiHp+VoO0U3eJYampyZKpxC+YzCs8sonEL5CtfugW/SgwbcmG/WuASuWJvf3+Tgbu53bBX/F89T098t7oLn62KntRvzbRrvEmc3lkqdM1dv2Fr+Xi0JZ+ldZ1bFlVxnVsUZuLMzsGu337j9dqZRO/ON3AqwLMujFmh0C1HzFVCv1/NoDzS6haj5Cqjb7f6hXdBoClHvFZBoNpufaBM0mkLUegUkhOd536kHuv4JUbNVqCTNuHa7/YO2QdePEDU703Gc39QBzR8hanam67ofqQua/4WoGdfpdGzaAc2/QCyNMzGtUvZubavVmtIW6NsIomZn2rb9j9qgD+8h6sd9roQzBKKMPcfVi4fXi6sboW6E2pm5VmGJUbTFFkqMVsPl/sSHK+Bi3xe9sGVgiUMr4JhI/PL1lOK45d5tOFEEt95g0lyjZAJxdWwsscWduS6RjGMiPTt5ULoRmJTKKJnZOLYlkdsaIZ7M5JhlJPP/XhZLZgWrCLlIWclMzq4SLjLBsqpZjZAuorIzE8lhGc6MoZjYiNtgFZY6S0RTkmch5LMKE6Vx9T9CvVZ54bWKXy+NXmsj+GTPcbUzd4jD5PkGNq6P9tC3CE/6JLxDeyDUH4SEYj5CT58EGAByvHje+qCyoAAAAABJRU5ErkJggg==",_init:function(l){var m=this;d.extend(m,l);m.ct=d(m.target);m.anchor=m.ct.find(m.anchorSelector);m.thumbCt=m.ct.find(m.thumbCtSelector);m.hiddenField=m.ct.find("input:hidden");if(m.hiddenField.size()==0){m.hiddenField=d(document.createElement("input"));m.hiddenField.attr("type","hidden");if(m.hiddenId){m.hiddenField.attr("id",m.hiddenId)}if(m.hiddenName){m.hiddenField.attr("name",m.hiddenName)}m.ct.children(e).prepend(m.hiddenField)}m.uploader=new k({postParams:{uid:window.UID,serviceid:"36"},uploadAnchors:[{width:m.anchorWidth,height:m.anchorHeight,el:m.anchor}],createThumb:j.supportDataURL(),uploadUrl:CRTWCONFIG.MULTI_PIC_UPLOAD_URL,maxFileSize:m.maxFileSize,MAX_SELECT_COUNT:1,privewImgWidth:m.thumbWidth,privewImgHeight:m.thumbHeight,onSelect:function(){m.onFileSelected.apply(m,arguments)},onProgress:function(){m.onUploadProgress.apply(m,arguments)},onSuccess:function(){m.onUploadSuccess.apply(m,arguments)},onError:function(){m.onUploadError.apply(m,arguments)},onThumbOk:function(){m.onThumbLoad.apply(m,arguments)},onDialogOpen:function(){m.uploader.reset()}});m.el=m.anchor.children("object.swfupload,input:file");if(m.value){m.setValue(m.value)}},onFileSelected:function(o,n){this.hasThumb=false;this.ct.removeClass(f);this.ct.find(i).html("");this.setThumb(this.defaultBgImage,{w:110,h:110});this.disable();this.setProgress(0);for(var m=0,l=o.length;m<l;m++){this.uploader.upload(o[m].id)}},onUploadProgress:function(l,m){this.setProgress(m)},onUploadSuccess:function(l,m){this.hasThumb=true;this.setProgress(100);this.ct.removeClass(f);this.ct.find(i).html("");this.setValue(m.data.small,m.data.extraData.small,m.data.big);this.enable();if(typeof(this.uploadOkHandle)=="function"){this.uploadOkHandle(m.data.big)}},onUploadError:function(){this.ct.addClass(f);this.ct.find(i).html(this.uploadFailText);this.setProgress(100);this.setThumb(this.defaultBgImage,{w:110,h:110});this.enable()},onThumbLoad:function(l){if(!this.hasThumb){this.hasThumb=true;this.setThumb(l.priviewData)}},setProgress:function(l){if(!this.progressMask){this.progressMask=d('<div class="swfUpX '+a+'"><div class="swfUpN">0%</div><div style="height:0%" class="swfUpM"></div></div>');this.thumbCt.prepend(this.progressMask)}this.progressMask.children("div.swfUpN").html(l+"%");this.progressMask.children("div.swfUpM").css("height",l+"%");if(l<=0){this.progressMask.removeClass(a)}else{if(l>=100){this.progressMask.addClass(a)}}},setThumb:function(o,n){if(!this.thumb){var m=this.thumbCt.children("img.swfUpI");if(m.size()>0){this.thumb=d(m[0])}else{this.thumb=d(document.createElement("img"));this.thumb.addClass("swfUpI");this.thumbCt.append(this.thumb)}}var q=true;if(o.indexOf("base64")!=-1){q=false;o=(o.indexOf("data:")==-1?("data:"+o):o)}var l=n?(n.w||this.thumbWidth):this.thumbWidth,p=n?(n.h||this.thumbHeight):this.thumbHeight;this.thumb.css({"background-image":"url("+o+")",width:l+"px",height:p+"px"});if(q){this.thumb.attr("src",o);this.thumb.css("background-image","none")}else{this.thumb.attr("src","http://s4.cr.itc.cn/i/s/i.gif");this.thumb.css("background-image","url("+o+")")}},isUpload:function(){return this.uploaded===true},disable:function(){this.el.width(1).height(1);this.anchor.addClass(h)},enable:function(){this.anchor.removeClass(h);this.el.width(this.anchorWidth).height(this.anchorHeight)},setValue:function(n,l,m){this.setThumb(n,l);this.value=n;this.hiddenField.val(m||n);this.uploaded=true},getValue:function(){return this.value}});return g});kola("app.widget.LinkageSelect",["jquery.Core"],function(c){function b(j,h,m,e){var d=m[j.val()];var n=[];for(var g=0,f=d.length;g<f;++g){n.push("<option value='"+d[g].value+"' "+(e==d[g].value?"selected='selected'":"")+">"+d[g].text+"</option>")}h.html(n.join(""));var k=h.data("childls");if(k){k()}}var a={link:function(d){var d=c.extend({dataMap:{},select1DefVal:null,select2DefVal:null},d);c.extend(d,{select1:c(d.select1),select2:c(d.select2)});d.select1.find("option[value='"+d.select1DefVal+"']").attr("selected","selected");d.select1.data("childls",function(){b(d.select1,d.select2,d.dataMap,d.select2DefVal)});var e=d.select1.data("childls");d.select1.bind("change",function(){e()});e()}};return a});kola("app.widget.LuckyDraw",["kola.lang.Class","jquery.Core","newt.Config","newt.swf.sohuFlash","newt.util.Tool"],function(c,e,a,b,d){var f=c.create({swfId:"app-widget-luckydraw",flashVersion:"9",swfUrl:"http://s4.cr.itc.cn/i/5/reward-edit-6.swf",autoReset:false,_init:function(g){},init:function(g){e.extend(this,g||{});if(this.width){this.width+="px"}if(this.height){this.height+="px"}this.ct=e(this.container);this.render(this.ct)},render:function(g){if(g.size()>0){this.swf=new b(this.swfUrl,this.swfId,this.width||"100%",this.height||"100%",this.flashVersion);this.swf.addParam("allowScriptAccess","always");this.swf.addParam("allowFullscreen","false");this.swf.addParam("wmode","transparent");this.swf.addParam("flashvars","isJsReady=window.appLuckyDraw.isLuckyDrawReady&callJsRequest=window.appLuckyDraw.onDraw&callJsOver=window.appLuckyDraw.afterDraw&imgurl="+this.bgImageUrl);this.swf.write(g[0])}},beforeAction:function(){},afterAction:function(){},onFailure:function(){},onDraw:function(){if(!window.isLogin){kola("newt.ca.ca",function(){CA.q("lottery_nologin_draw")});d.iNoLogin();return}var g=this;if(g.inDraw!==true&&g.beforeAction.call(g.scope||g)!==false){g.inDraw=true;e.ajax({type:"post",url:g.action,dataType:"json",success:function(h){try{if(h.status==a.AJAX_STATUS.SUCCESS){g.onAction(h.data)}else{g.info(h.statusText);g.onFailure(h)}}catch(i){g.info()}},error:function(){g.info()},complete:function(){g.inDraw=false}})}},onAction:function(g){this.result=g;var h=this.getSwfObj();if(h.setResult){h.setResult(g.code)}},afterDraw:function(){var g=this;g.afterAction.call(g.scope||g,g.result);if(g.autoReset){g.resetSwf()}},resetSwf:function(){var g=this.getSwfObj();if(g.setInit){g.setInit()}},getSwfObj:function(){return document[this.swfId]||window[this.swfId]},info:function(g){kola("newt.dialog.Notice",function(){tw.notice.alert(g||"服务器繁忙，请稍后再试！")})},isLuckyDrawReady:function(){return false}});window.appLuckyDraw=new f();window.appLuckyDraw.isLuckyDrawReady=function(){return true};return window.appLuckyDraw});kola("app.widget.MultiPicEditor",["newt.composer.MultiPicEditor"],function(b){var a=function(h,g){var f=$(g.anchor);if(f.size()==0){return}var e=(typeof g.defaultText!="undefined"?g.defaultText:"分享图片");if(!window.isLogin){f.click(function(){kola("newt.util.Tool",function(i){i.iNoLogin()})});return}var d=$(h.eDom).closest("div.tarea");var c=new b({anchor:f,dragAnchor:g.dragAnchor||document.body,postParams:{uid:window.UID,serviceid:"32"},uploadUrl:CRTWCONFIG.MULTI_PIC_UPLOAD_URL,fileFilter:g.fileFilter||"jpg, jpeg, png, gif, bmp, JPG, JPEG, GIF, BMP",maxFileSize:g.maxFileSize||10*1024*1024,MAX_SELECT_COUNT:g.maxPicNum||12,onOpen:function(){kola("newt.tipbox.Bubble",function(i){i.close("newMultiPicBubble")});if(h.getVal()==""){h.setVal(e);d.removeClass("tarea_min")}h.setCursorEnd();if(g.onOpen){g.onOpen.call(g.scope||window)}},onAddPic:function(j){var i=h.getVal();var k=i&&i!=e;if(i==""){h.setVal(e);d.removeClass("tarea_min")}h.setCursorEnd();if(g.onAddPic){g.onAddPic.call(g.scope||window)}},onDelPic:function(j){var i=h.getVal();var l=i&&i!=e;var k=j.getValue()!="";if(!l&&!k){h.setVal("")}h.setCursorEnd();if(g.onDelPic){g.onDelPic.call(g.scope||window)}},onClose:function(m,j){var l=h.getVal();var i=l&&l!=e;var n=m.getPicViews().length;var k=(j&&!i)||(!j&&n>0)||(!j&&n==0&&!i);if(k){h.setVal("")}h.setCursorEnd();if(g.onClose){g.onClose.call(g.scope||window)}},onAnchorClick:function(){$.cr.event.send("pic_click",{});if(g.onAnchorClick){g.onAnchorClick.call(g.scope||window)}},onImageUpload:function(){if(g.onImageUpload){g.onImageUpload.call(g.scope||window)}}});if(g.closeConfirm===false){c.container.find('[data-meta="close-icon"]').unbind().click(function(){c.close(false)})}return c};return{getEditor:a}});kola("app.widget.NoLoginIntercepter",["jquery.Core","newt.Config"],function(b,a){var c=function(f){if(!window.isLogin){kola("newt.util.Tool",function(e){e.iNoLogin()});f.preventDefault();f.stopImmediatePropagation();return false}return true};var d=function(g){if(window.isLogin){return}g=g||{};var f=g.tags||"a,button";var e=[];b.each(f.split(","),function(j,h){e.push(h+'[data-nologin-intercept="true"]')});b(a.SCROLL_ElEMENT).delegate(e.join(","),"mousedown",function(h){return c(h)})};return{init:d}});kola("app.widget.PageView",["jquery.Core","kola.lang.Class","bricks.clay.paging.PagingModel","mvc.view.TemplateEngine"],function(f,d,b,g){var a="noVis",h="btn_dis",i="dis",e="on";var c=d.create({autoLoad:false,defaultPage:1,pagebarSelector:"p.page",pageSize:20,_init:function(j){var k=this;f.extend(k,j);k.el=f(k.target);k.body=k.el.find(k.bodySelector);k.pagebar=k.el.find(k.pagebarSelector);k.pager=new b({baseParams:k.baseParams,pageSize:k.pageSize,total:k.total,action:k.action,listeners:{beforechange:function(){k.beforeChange()},change:function(){k.onChange()},changefailed:function(){k.onChangeFailed()},requestcomplete:function(){k.onRequestComplete()}}});k.pagebar.delegate("a","click",function(){k.onPageClick(f(this))});if(!k.loadingEl){k.loadingEl=f("#t-lay div.sysLoading")}if(k.autoLoad){k.pager.doLoad({pageNo:k.defaultPage})}},onPageClick:function(k){if(k.hasClass(h)||k.hasClass(i)||k.hasClass(e)){return}var l=k.data("page"),j=this.pager;if(l=="prev"){j.movePrevious()}else{if(l=="next"){j.moveNext()}else{if(l=="first"){j.moveFirst()}else{if(l=="last"){j.moveLast()}else{if(l=="refresh"){j.refresh()}else{if(l=="first"){j.moveTo(l)}}}}}}},beforeChange:function(){this.showLoading()},onChange:function(j){var k=this;if(k.bodyTpl){g.getTemplate({name:k.bodyTpl,complete:function(l){k.body.html(l.render({data:j}))}})}else{if(j.result.body){k.body.html(j.result.body)}else{k.body.html(k.renderBody(j))}}if(k.pagebarTpl){g.getTemplate({name:k.pagebarTpl,complete:function(l){k.pagebar.html(l.render({data:j}))}})}else{if(j.result.pagebar){k.pagebar.html(j.result.pagebar)}else{k.pagebar.html(k.renderPagebar(j))}}},renderBody:function(j){return""},renderPagebar:function(j){return""},onChangeFailed:function(){kola("newt.dialog.Notice",function(){tw.notice.showErrTip("操作失败")})},onRequestComplete:function(){this.hideLoading()},showLoading:function(){this.loadingEl.removeClass(a)},hideLoading:function(){this.loadingEl.addClass(a)}});return c});kola("app.widget.RecommendUsersWindow",["jquery.Core","newt.window.Window","newt.service.Follows"],function(e,c,b){var a=function(){return['<div class="mwBd">','<div class="ttl">','<h6>关注 <b class="nm" style="font-weight:bold;padding:0 5px"><a href="javascript:void(0);" style="color:#666;text-decoration:none;">TA</a></b> 的人还关注了：</h6>','<div class="usrLi">',"</div>","</div>","</div>",'<div class="mwFt">','<label class="cbox">','<input data-ca="jingxuan_recommend_closeweek" type="checkbox" gid="57102803" gname="7天内不再出现" ucount="0">7天内不再出现',"</label>",'<a href="javascript:void(0);" data-ca="jingxuan_recommend_followall" class="btn"><b>关注全部</b></a>',"</div>"]};var d=function(){var f=this;this.win=tw.window.build("recommendUsers",a,null,{prefixHtml:c.prototype.winNoFootBtnPrefix(),suffixHtml:c.prototype.winNoFootBtnSuffix()});var k=e(this.win.getElement());var j=k.find(".mwCt a.close");var i=k.find("div.mwHd");var g=k.find("div.mwBd");var h=k.find("div.mwFt");k.addClass("mwAdd");j.attr("data-ca","jingxuan_recommend_close");i.empty();i.append('<div class="hint hintOk"><div class="hintT"><i class="i"></i><em>关注成功</em></div></div>');h.find(".cbox input[type='checkbox']").click(function(){if(e(this).attr("checked")=="checked"){var l=new Date();l.setDate(l.getDate()+7);e.cr.cookie.set("jingxuan_recommend_closeweek",true,l)}else{e.cr.cookie.set("jingxuan_recommend_closeweek",false)}});h.find("a.btn").click(function(){var l=[];g.find(".usrLi .usr3").each(function(){var m=e(this).find(".fucs a.fuc");if(!m.hasClass("fuc_dis")){l.push(m.attr("uid"))}});f.follow(l);f.win.destroy();return false});j.click(function(){f.win.destroy();return false});e.cr.event.bind("tw_follow_user",function(m,l){f.changeUserStatus(l.uid,true)})};d.prototype.changeUserStatus=function(g,i){var f=this;var h=e(f.win).find("mwBd");e(f.win.getElement()).find(".usrLi a.fuc").each(function(){if(e(this).attr("uid")==g){if(i){e(this).addClass("fuc_dis");e(this).find("b").text("已关注")}else{e(this).removeClass("fuc_dis");e(this).find("b").text("关注")}return}})};d.prototype.show=function(f){e(this.win.getElement()).find("h6 b.nm>a").text(f);this.win.show()};d.prototype.render=function(l){var h=this;var n=e(this.win.getElement());var f=n.find("div.usrLi");f.empty();for(var j=0;j<6;j++){if(j>=l.length){break}var g=l[j];var k="";if(g.isVip===true||g.isVip==="true"){k='<a href="#"><i title="认证用户" class="p pVer"><i class="png"></i></i></a>'}var m=e('<div title="'+g.nickName+'" class="usr3"><p class="avt avt32"><a href="'+g.url+'"><i class="img" style="background-image:url('+g.icon+')"></i></a></p><b class="nm"><a href="'+g.url+'" target="_self">'+g.nickName+"</a>"+k+'</b><p class="fucs"><a title="+关注" data-ca="jingxuan_recommend_clickfollow" href="javascript:void(0);" uid="'+g.uid+'" class="fuc fucAdd"><i class="add"><q class="k1"></q><q class="k2"></q></i><b>关注</b></a></p><q class="relat" title="'+g.description+'">'+g.description+"</q></div>");e(m).find(".fucs a.fuc").click(function(){if(e(this).hasClass("fuc_dis")){return false}h.follow([e(this).attr("uid")]);return false});f.append(m)}};d.prototype.follow=function(g){var f=this;b.follow({params:{uids:g},success:function(h){},fail:function(h){kola("newt.dialog.Notice",function(){tw.notice.alert("关注失败，请重试")})}})};return d});kola("app.widget.ReplyAtWindow",["jquery.Core","newt.dialog.Notice","newt.reply.VCode","newt.ui.window.dialog.SimpleSendMsg"],function(d,c,a,e){var b={reply:function(h,g){var f=this;f.show({url:"/twAction/insertReply",param:{at:h,msgid:h},title:"评论微博",description:g,charLimit:"300",content:"",actionType:"reply"})},forward:function(h,g){var f=this;f.show({url:"/twAction/reTwitter",param:{at:h},title:"转发微博",allowInputEmpty:true,description:g,charLimit:"300",content:"",actionType:"forward"})},show:function(f){e.show({title:f.title,charLimit:f.charLimit,hasEmote:f.hasEmote,allowInputEmpty:f.allowInputEmpty,defaultTxt:f.content,onRender:function(h){var g=h.find("div.post");if(!g.data("verifyCode")){a.init(g,{onBlur:function(){g.data("crSimpleEdit").sync()}})}else{a.refresh(g)}},onEditChange:function(g){return a.isPass(g.find("div.post"))},poster:function(i,h){f.param=f.param||{};d.extend(f.param,{msg:d.cr.encodeUTF(i)});f.param=a.getValue(h.find("div.post"),f.param);var j=[];for(var g in f.param){if(f.param.hasOwnProperty(g)){j.push(g+"="+f.param[g])}}d.ajax({url:f.url,data:j.join("&")+"&type="+(window.FROM_TYPE||""),dataType:"json",type:"post",success:function(k){if(k&&k.status==0){tw.notice.showTip("发布成功")}else{if(k&&k.status==-8){kola("newt.realnameblock.Dialog",function(l){l.show()})}else{a.refresh(h.find("div.post"));tw.notice.alert(k.statusText)}}},error:function(){a.refresh(h.find("div.post"));tw.notice.alert("服务器爆炸！请稍后再发！")}})}})}};return b});kola("app.widget.SendMailWindow",["app.widget.TwWindow","newt.service.MailService"],function(b,a){return{show:function(c){c=c||{};var d=c.friendName||"";if(!c.title){c.title="发私信给 "+d+"："}if(!c.url&&!c.onSubmit){c.onSubmit=function(e){a.sendMail({friendName:d,content:e.msg,success:function(){tw.notice.showTip("发送成功")},error:function(g){var h=g.status;var f=self.ERROR_TEXT[h]||self.ERROR_TEXT[-1];tw.notice.alert(f)}})}}b.show(c)}}});kola("app.widget.ShareLinkWindow",["jquery.Core","newt.window.Window","newt.tool.Copy","newt.dialog.Notice"],function(c,j,d){var f,l,a="app-widget-sharelinkwindow",h="复制链接，邀请好友参加活动",e=function(){return['<div class="mwBd">','    <div class="winLink">','        <p class="imptxt">将链接通过MSN、QQ或Email发给好友</p>','        <p><input type="text" class="cmtbx" value=""></p>','        <p class="btnBar"><a class="btn btnM21" href="javascript:void(0);" readonly="readonly"><b>复制链接</b></a></p>',"    </div>","</div>"]};var k=function(m){f=tw.window.build(m||a,e,null,{prefixHtml:j.prototype.winNoFootBtnPrefix(),suffixHtml:j.prototype.winNoFootBtnSuffix()});l=f.elem.find(".mwBd .winLink input");g()};var g=function(){f.elem.find(".mwBd .winLink .btnBar a").click(function(){var m=d.copy2Clipboard(l.val());if(m){tw.notice.alert(m.data)}})};var b=function(m){if(!m){m=window.location.href}l.val(m)};var i=function(m){m=m||{};if(!f){k(m.id)}f.setTitle(m.title||h);b(m.link);f.show()};return{show:i}});kola("app.widget.SlotMachine",["kola.lang.Class","jquery.Core","newt.Config","newt.swf.sohuFlash","app.exp.lottery.WinHelper","newt.util.Tool","newt.ca.ca"],function(Class,$,Config,SohuFlash,WinHelper,tool,CA){var SlotMachine=Class.create({swfId:"app-widget-slotmachine",flashVersion:"9",swfUrl:"http://s4.cr.itc.cn/i/5/SlotMachine.swf",autoReset:false,isRuning:false,_init:function(config){},init:function(config){$.extend(this,config||{});if(this.width){this.width+="px"}if(this.height){this.height+="px"}this.ct=$(this.container);this.render(this.ct)},render:function(ct){if(ct.size()>0){ct.empty();var flashHtml=['<object id="',this.swfId,'"',' type="application/x-shockwave-flash" ','data="',this.swfUrl,'" ','width="',this.width||"100%",'" ','height="',this.height||"100%",'" class="lottery">','<param name="wmode" value="transparent" />','<param name="movie" value="',this.swfUrl,'" />','<param name="quality" value="high" />','<param name="menu" value="false" />','<param name="allowScriptAccess" value="always" />','<param name="flashvars" value="isJsReady=window.appSlotMachine.isSlotMachineReady&callJsRequest=window.appSlotMachine.onDraw&callJsOver=window.appSlotMachine.afterDraw" />',"</object>"].join("");ct.append($(flashHtml))}},beforeAction:function(){},afterAction:function(){},onFailure:function(){},unloginLottery:function(){var me=this;me.afterAction=function(){$.cr.cookie.set("nologin_lottery_time",1,new Date(new Date().getTime()+1000*60*60*24*30));WinHelper.showUnloginLotteryWin()};me.callFlash("setResult",[{code:10}]);me.isRuning=true},onDraw:function(){var me=this;if(me.isRuning===true){return}if(!window.isLogin){CA.q("lottery2_nologin_draw");if(!parseInt($.cr.cookie.get("nologin_lottery_time"))){WinHelper.showUnloginWin({target:me,onClose:me.unloginLottery})}else{WinHelper.showUnloginLotteryWin()}return}CA.q("lottery2_login_draw");if(me.inDraw!==true&&me.beforeAction.call(me.scope||me)!==false){me.inDraw=true;$.ajax({type:"post",url:me.action,dataType:"json",success:function(data){try{if(data.status==Config.AJAX_STATUS.SUCCESS){me.onAction(data.data)}else{me.info(data.statusText);me.onFailure(data)}}catch(e){me.info()}},error:function(){me.info()},complete:function(){me.inDraw=false}})}},onAction:function(result){this.result=result;this.callFlash("reset");this.callFlash("setResult",[result]);this.isRuning=true},afterDraw:function(){this.isRuning=false;var me=this;me.afterAction.call(me.scope||me,me.result);if(me.autoReset){me.callFlash("reset")}},resetSwf:function(){var swf=this.getSwfObj();if(swf.reset){swf.reset()}},getSwfObj:function(){return document[this.swfId]||window[this.swfId]},info:function(msg){kola("newt.dialog.Notice",function(){tw.notice.alert(msg||"服务器繁忙，请稍后再试！")})},callFlash:function(functionName,argumentArray){argumentArray=argumentArray||[];var movieElement=this.getSwfObj();if(movieElement==null){return false}var returnValue,returnString;try{returnString=movieElement.CallFunction('<invoke name="'+functionName+'" returntype="javascript">'+__flash__argumentsToXML(argumentArray,0)+"</invoke>");returnValue=eval(returnString)}catch(ex){throw"Call to "+functionName+" failed"}if(returnValue!=undefined&&typeof returnValue.post==="object"){returnValue=this.unescapeFilePostParams(returnValue)}return returnValue},isSlotMachineReady:function(){return false}});window.appSlotMachine=new SlotMachine();window.appSlotMachine.isSlotMachineReady=function(){return true};return window.appSlotMachine});kola("app.widget.SwfWindow",["jquery.Core"],function($){var self;var SwfWindow=function(settings){self=this;self.settings=settings;self.init()};SwfWindow.prototype={init:function(){self.flashEl=$('<div id="'+self.settings.movieName+'_container" style="position: absolute; z-index: 9999; top: 0px; left: 0px; visibility: visible;">'+self._getFlashHTML()+"</div>");$(".SKY").append(self.flashEl);$(window).resize(function(){$(self.flashEl).attr("width",$(document).width());$(self.flashEl).attr("height",$(window).height());$(self.flashEl).find("object").attr("width",$(document).width());$(self.flashEl).find("object").attr("height",$(window).height())});$("body").keyup(function(e){if(e.keyCode==13){self.callFlash("post")}else{if(e.keyCode==27){self.close()}}})},checkJs:function(){return true},flashCallback:function(funName,args){var fun=self.settings.callback[funName];fun.call(this,args)},callFlash:function(funName,args){if(args==undefined){args=[]}try{var swf=document.getElementById(self.settings.movieName);var returnString=swf.CallFunction('<invoke name="'+funName+'" returnType="javascript">'+__flash__argumentsToXML(args,0)+"</invoke>");if(returnString!=undefined){returnValue=eval(returnString)}}catch(ex){throw"Call to "+funName+" failed"}},_getFlashHTML:function(){return['<object id="',self.settings.movieName,'" type="application/x-shockwave-flash" data="',self.settings.flash_url,"?",Math.random(),'" width="',$(document).width(),'" height="',$(window).height(),'" >','<param name="wmode" value="transparent" />','<param name="movie" value="',this.settings.flash_url,"?",Math.random(),'" />','<param name="quality" value="high" />','<param name="menu" value="false" />','<param name="allowScriptAccess" value="always" />','<param name="flashvars" value="'+this.settings.flashvars+'" />',"</object>"].join("")},post:function(postwords){var options={type:"add_tw",content:postwords,success:function(json){},error:function(){}};tw.build(options);self.close();if(self.settings.eventUrl!=undefined){window.location.href=self.settings.eventUrl}},close:function(){self.flashEl.remove()},callCa:function(name){kola("newt.ca.ca",function(ca){ca.q(name);ca.log(name,"click",{page:location.href})})}};return SwfWindow});kola("app.widget.Timer",["jquery.Core","kola.lang.Class","app.util.Timer"],function(d,b,a){var c=b.create({useDay:false,useSecond:true,delay:0,_init:function(e){d.extend(this,e||{});this.ct=d(this.container);this.timeEl=this.ct.find("i > b");new a({start:this.startTime,serverTime:(this.serverTime||new Date().getTime())-this.delay,millisec:this.useSecond?1000:60000,handler:this.refreshTime,scope:this})},refreshTime:function(h){if(h.curTime>=this.startTime){if(this.endFn){this.endFn.call(this.scope||this)}return}var f=h.timeInfo.day,e=h.timeInfo.hour<10?"0"+h.timeInfo.hour:h.timeInfo.hour,i=h.timeInfo.minute<10?"0"+h.timeInfo.minute:h.timeInfo.minute,g=h.timeInfo.second<10?"0"+h.timeInfo.second:h.timeInfo.second;if(this.useDay&&this.useSecond){d(this.timeEl[0]).html(f);d(this.timeEl[1]).html(e);d(this.timeEl[2]).html(i);d(this.timeEl[3]).html(g)}else{if(this.useDay&&!this.useSecond){d(this.timeEl[0]).html(f);d(this.timeEl[1]).html(e);d(this.timeEl[2]).html(i)}else{if(!this.useDay&&this.useSecond){d(this.timeEl[0]).html(e);d(this.timeEl[1]).html(i);d(this.timeEl[2]).html(g)}else{if(!this.useDay&&!this.useSecond){d(this.timeEl[0]).html(e);d(this.timeEl[1]).html(i)}}}}if(this.handler){this.handler.call(this.scope||this,h)}}});return c});kola("app.widget.Topic",["jquery.Core","kola.lang.Class","newt.Config","newt.composer.Composer","newt.timeline.Container","bricks.clay.paging.PagingModel"],function(h,c,e,k,l,d){var g="noDis",j="noVis",b="btn_loading",a="btn_dis",m="dis",i="on";var f=c.create({useComposer:true,timelineContainer:"#twitter_container",pageSize:10,_init:function(n){h.extend(this,n||{});this.ct=h(this.container);if(this.useComposer){if(!this.composerContainer){this.composerContainer=this.ct.find('[data-topic-composer="true"]');if(!this.topic){this.topic=this.composerContainer.data("topic-hot")}}if(this.composerContainer&&this.composerContainer.size()>0){this.composer=new k(this.composerContainer,{addMsgUrl:this.composerAction,topic:this.topic})}}this.timeline=new l({push_target:this.timelineContainer,container:this.timelineContainer});this.initPaging();this.initRefresh();this.loadingEl=h("#t-lay div.sysLoading")},initPaging:function(){var n=this;n.totalEl=n.totalSelector?n.ct.find(n.totalSelector):n.ct.find('[data-topic-total="true"]');n.pagingEl=n.pagingSelector?n.ct.find(n.pagingSelector):n.ct.find('[data-topic-paging="true"]');n.paging=new d({baseParams:n.baseParams,pageSize:n.pageSize,action:n.action,total:n.totalEl.html(),listeners:{beforechange:function(){return n.beforeChange.apply(n,arguments)},change:function(){n.onChange.apply(n,arguments)},changefailed:function(){n.onChangeFailed.apply(n,arguments)},requestcomplete:function(){n.onRequestComplete.apply(n,arguments)}}});n.pagingEl.delegate("a","click",function(){n.onPageClick(h(this))})},beforeChange:function(){if(this.isLoading){return false}this.isLoading=true;this.refreshEl.addClass(b);this.showLoading()},onChange:function(o){var n=this.timeline.container;n.html(o.result.content);this.totalEl.html(o.total);this.pagingEl.html(o.result.pagebar);h(e.SCROLL_DOM).scrollTo(this.ct,400,{axis:"y",offset:-40,onAfter:function(){kola("newt.imgloader.ImgLoader",function(){tw.imgloader.scan(n)})}})},onChangeFailed:function(){kola("newt.dialog.Notice",function(){tw.notice.showErrTip("操作失败")})},onRequestComplete:function(){this.isLoading=false;this.refreshEl.removeClass(b);this.hideLoading()},initRefresh:function(){var n=this;n.refreshEl=n.refreshSelector?n.ct.find(n.refreshSelector):n.ct.find('[data-topic-refresh="true"]');n.refreshEl.click(function(){n.refresh()})},refresh:function(){var n=this;this.paging.refresh(n.refreshToPage)},onPageClick:function(n){if(n.hasClass(m)||n.hasClass(a)||n.hasClass(i)){return}var o=n.data("page");if(o=="prev"||n.hasClass("pgPr")){this.paging.movePrevious()}else{if(o=="next"||n.hasClass("pgNx")){this.paging.moveNext()}else{this.paging.moveTo(o||n.html())}}},showLoading:function(){this.loadingEl.removeClass(j)},hideLoading:function(){if(!this.loadingEl.hasClass(j)){this.loadingEl.addClass(j)}}});return f});kola("app.widget.TwHidden",["jquery.Core","newt.dialog.Notice"],function(c){var b=function(d,e,h){var d=c(d);var g=d.parents("div[id$='_con']");var f=g.attr("id").slice("0","-4");c.ajax({url:e,type:"POST",dataType:"json",data:c.extend({msgId:f},h),success:function(i){if(i.status==0){tw.notice.showTip("操作成功");g.fadeOut(400)}else{tw.notice.alert(i.statusText)}},error:function(){tw.notice.showErrTip("操作失败")}})};var a=function(d,e,f){e=e||"";f=c.extend({},f||{});tw.notice.confirm({msg:"你确定要隐藏该条微博?",subHandle:function(){b(d,e,f)}})};return{hide:a}});kola("app.widget.TwWindow",["jquery.Core","newt.Config","newt.util.StrUtil","newt.window.Window","app.widget.MultiPicEditor","newt.dialog.Notice"],function(x,f,H,i,D){var q=function(){return['<div class="mwBd">','<div class="repost">','<div class="repostC noDis">',"<em></em>",'<p class="ugc"></p>',"</div>",'<div class="post">','<div class="tarea blur"><div class="atFake"></div><textarea></textarea></div>','<p class="postSub">','<span class="opt"><b class="postMax"><i class="editstatus">还可输入140字</i></b></span>','<a class="btn crjs_yes" href="javascript:void(0);"><b>发 表</b></a>','<a class="btn btn_min crjs_no noDis" href="javascript:void(0);"><b>取 消</b></a>',"</p>",'<ul class="postAtt">','<li><a href="javascript:void(0);" class="fuc crJs_emote"><i class="i iS iAtt i37"></i><b>表情</b></a><span id="at_who"></span></li>','<li class="crJs_ig">','<a data-ca="tw_composer_img" class="fuc" href="javascript:void(0);">','<span class="swfuploadbutton"></span><i class="i iS iAtt i36"></i><b>图片</b>',"</a>","</li>","</ul>","</div>","</div>","</div>"]};var b=function(){if(!window.isLogin){kola("newt.util.Tool",function(K){K.iNoLogin()});return false}return true};var g="noDis",j="btn_loading";var C,G="app-widget-twwindow",w="发微博",a,z,F,r,m,e,c,o,k,p,J;var B;var n=function(){C=tw.window.build(G,q,null,{prefixHtml:i.prototype.winNoFootBtnPrefix(),suffixHtml:i.prototype.winNoFootBtnSuffix()});var K=x(C.getElement());r=K.find("div.post");m=K.find("textarea");e=K.find("a.crjs_yes");c=K.find("div.repostC");o=K.find("a.crJs_emote").parent();k=K.find("li.crJs_ig");p=K.find("b.postMax").parent();J=K.find("a.crjs_no");a=r.crSimpleEdit({state:true,editDom:m,max:(typeof B.maxLength=="undefined"?300:B.maxLength),intxt:B.emptyText||"",cut:false,ctrlEnterHandle:function(){e.trigger("mouseup")},syncHandle:function(L){if(L.getVal()&&!L.getLimitStatus()){F.setEnable()}else{F.setDisable()}}}).getCrControl("crSimpleEdit");F=e.crButton({status:"enable",loadingClass:j,submitHandle:E}).getCrControl("crButton");kola("newt.composer.Attip",function(){new tw.AtTip(r)});C.getControl().onClose(v);J.click(t)};var h=false;var s=function(){if(!h){h=true;kola("newt.composer.emote.Emote",function(){tw.emote.initEmoteBtn(r,a)})}};var y=false;var l=function(){if(!y){y=true;z=D.getEditor(a,{closeConfirm:false,anchor:k.children("a"),maxPicNum:B.maxPicNum,defaultText:B.defaultText})}};var E=function(){if(!b()){return}if(B.hasPic===true&&z.getStatus()==z.STATUS_UPLOADING){tw.notice.showErrTip3("图片上传中..");F.removeLoading();F.setEnable();return}var L=a.getVal();if(L){if(B.getMsg){L=B.getMsg.call(B.scope||window,L)}var K=x.extend({msg:L,pics:z?z.getValue():""},B.baseParams||{});if(B.onSubmit){B.onSubmit.apply(B.scope||window,[K].concat(B.args||[]))}else{d({url:B.url,params:B.getParams?B.getParams(K):K,handler:B.handler,scope:B.scope})}}};var d=function(K){if(K.url){x.ajax({url:K.url,type:"POST",dataType:"json",data:H.toUTF8Params(K.params),success:function(L){u(L,K.handler,K.scope)},error:function(L){I()}})}else{tw.build({type:"add_tw",content:K.params.msg,pics:K.params.pics,success:function(L){u(L,K.handler,K.scope)},error:function(){I()}})}};var u=function(M,L,K){F.removeLoading();if(M.status==f.AJAX_STATUS.SUCCESS){a.setVal("");if(z){z.close(false)}tw.notice.showTip("操作成功");if(L){L.call(K||window,M)}}else{if(M.status==417){kola("newt.realnameblock.Dialog",function(N){N.show()})}else{tw.notice.alert(M.statusText)}}};var I=function(){F.removeLoading();tw.notice.showErrTip("操作失败")};var v=function(){a.setVal("");if(z){z.close(false)}if(B.cls){x(C.getElement()).removeClass(B.cls)}if(B.onClose){B.onClose.apply(B.scope||window,B.args||[])}B=null};var t=function(){if(B.onCancel){B.onCancel.apply(B.scope||window,B.args||[])}C.close()};var A=function(K){B=x.extend({},K||{});if(!C){n()}C.setTitle(B.title||w);if(B.cls){x(C.getElement()).addClass(B.cls)}if(B.subject){if(B.subjectTitle){c.children("em").removeClass(g).html(B.subjectTitle)}else{c.children("em").addClass(g).html("")}c.children("p.ugc").html(B.subject);c.removeClass(g)}else{c.addClass(g);c.children("p.ugc").html("")}if(B.hasEmote!==false){if(!h){s()}o.removeClass(g)}else{o.addClass(g)}if(B.hasPic===true){if(!y){l()}k.removeClass(g)}else{k.addClass(g)}if(B.maxLength===-1){p.addClass(g)}else{p.removeClass(g)}if(typeof(B.maxLength)!="undefined"){a.ops.max=B.maxLength}if(B.submitText){e.find("b").html(B.submitText)}if(B.hasCancel===true){J.removeClass(g);if(B.cancelText){J.find("b").html(B.cancelText)}}else{J.addClass(g)}if(B.emptyText){a.ops.intxt=B.emptyText}if(B.value){a.setVal(B.value)}else{if(B.emptyText){a.setVal(B.emptyText)}else{a.setVal("")}}F.removeLoading();C.show();if(B.focusIn!==false){a.setFocus();a.setCursorEnd()}else{a.editBox.addClass("blur")}};return{show:A}});