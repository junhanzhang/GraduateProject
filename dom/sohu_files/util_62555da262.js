kola("newt.util.FormValidator",["jquery.Core","util.formvalidator.Core","mvc.Event"],function(f,g,a){function b(k,j){var i=k.parents("div.frm:first").removeClass("frm_ok").addClass("frm_err");var h=i.find("p.frmTip");h.find("b:first").html(j)}function e(k){var i=k.parents("div.frm:first").removeClass("frm_err frm_ok");var h=i.find("p.frmTip");h.find("b:first").html("");var j=k.val();if(j&&j.length>0){i.addClass("frm_ok")}}function c(k,j){var i=k.parents("div.frm:first").removeClass("frm_ok frm_err");var h=i.find("p.frmTip");h.find("b:first").html(j?j:"")}function d(h){}g.onFieldValidated=function(l){var m=f(l.formValidator.getFormDom());var h=m.find(":input[name='"+l.name+"']");var j=l.results;for(var k in j){var i=j[k];if(i.pass==false){b(h,i.errorTip);return}else{e(h)}}};g.onBeforeFieldValidate=function(h){c(f(h.formValidator.getFormDom()).find(":input[name='"+h.name+"']"),"正在检查输入...")};g.addRule({name:"nickname_useable",test:function(i,h){kola("newt.service.User",function(j){j.has({params:{nickName:i},success:function(k){if(k.status==0){h(true)}else{h(false,k.statusText)}},fail:function(){h(false,"服务器出错")}})})}});return g});kola("newt.util.Loading",["jquery.Core"],function(d){var c=0;var a=null;d(function(){a=d("#cloud_top_loading");if(a.size()<=0){d("#t-lay div.Cloud").append('<div data-ca="newt_common_loading" id="cloud_top_loading" class="sysLoading noVis"><p class="png"></p><p class="c">加载中...</p></div>');a=d("#cloud_top_loading")}});var b={load:function(){d(function(){if(++c==1){a.removeClass("noVis")}})},finish:function(){d(function(){if(--c<=0){a.addClass("noVis")}})}};return b});kola("newt.util.Plus2",["jquery.Core","sohu.ctrl.Tips","newt.util.Browser","newt.service.StatisticService","newt.cr.crEvent","newt.dialog.Notice"],function(f,g,h,b,c,e){function a(k,t,r,j,q,o){var n,p,l,s,m=[];for(n=0,p=q.length;n<p;n++){l=q[n];if(!o.hasOwnProperty(l)){throw"Plus2: except param:"+l}}for(l in o){if(o.hasOwnProperty(l)){s=o[l];if(typeof s!="object"&&typeof s!="function"){m.push(l+"="+s)}}}f.ajax({url:r,type:j,dataType:o.dataType||"json",data:m.join("&"),success:function(i){if(!i||(i.status&&i.status!=0)){if(o.error instanceof Function){try{o.error.call(o.scope,i)}catch(u){outError("Plus2."+k+"#error",u)}}return}if(typeof(o.success)=="function"){try{o.success.call(o.scope,i)}catch(u){outError("Plus2."+k+"#success",u)}}if(t&&i.data){c.send(t,i.data)}},error:function(i){if(typeof o.error=="function"){try{o.error.call(o.scope,i)}catch(u){outError("Plus2."+k+"#error",u)}}}})}var d={forward:function(j){if(!j||!j.msgid){return}j.at=j.msgid;j.msg=(j.content?f.cr.encodeUTF(j.content):"");var n="transf_weibo_success";var m="post";var l="forward";var i="/twAction/reTwitter";var k=["at"];a(l,n,i,m,k,j)}};return function(i){i=i||{};f.extend(i,{target:f(i.target)});var j=false;d.forward({msgid:i.msgId,error:function(n){var k=parseInt(n.status);var m=n.statusText;switch(k){case 401:kola("newt.util.Tool",function(o){o.iNoLogin()});break;case 417:if(!j){var l="newt.ui.window.dialog.realname.ValidIDCardModel";kola(l,function(o){j=true;o.show({style:"plain",closeHandle:function(){var p=n.closest("div.mw");j=false;if(p.length>0){p.getCrControl("crModalDialog").close()}}})})}break;default:tw.notice.alert("操作失败，请稍后再试！")}},success:function(k){g.showBubbleAt(i.target,-50,{content:"+2",bubbleClass:"combo combo3"})},content:f.cr.decode("+2"),type:(window.FROM_TYPE||"")})}});kola("newt.util.Validator",["util.validator.Core"],function(a){return a});